---
title: "correlation_iod"
author: "Ryan Peterson"
date: "2025-09-14"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r library}
suppressMessages( library(hierNet)) #yes
suppressMessages( library(glmnet)) #test ridge regression for coefs
suppressMessages( library(RAMP)) #maybe
suppressMessages( library(MASS)) #for lm.ridge

suppressMessages( library(foreach)) #parallelization setup
suppressMessages( library(parallel))
suppressMessages( library(doParallel))

suppressMessages( library( lubridate)) #you know why
suppressMessages( library( colorspace)) #for some color alternatives
suppressMessages( library( fields)) #for set.panel() and others 
suppressMessages( library(ggpubr)) #nice tables for dfs (uses ggplot)

suppressMessages( library( caret)) #for confusion matrix

suppressMessages( library( tictoc)) #some timing

#time series ploting
#TODO: figure out which is necessary
suppressMessages(library(plotly))
suppressMessages(library(TSstudio))
suppressMessages(library(xts))

```

```{r data_load}
#and functions
# Data Set-Up
setwd("~/CO_AUS/Aus_CO-main/Interactions")

load( "Data/ne_data.rda")
load( "Data/se_data.rda")
load( "Data/bounded_data.rda")
load( "Data/data_matrix.rda")
load( "Data/lag_list.rda")
load( "Data/data_quantile.rda")

#functions:
#source("group_functions.R") #grouping/clustering
source("group_functionsNew.R") #new groupings
source("refit_functions.R") #coef/refit functions


setwd("~/CO_AUS/Aus_CO-main/Interactions_New")
load( "IOD_lag.rda")
```


# Time-Series Work


## ACF & CCF

```{r ts_dataprep}
NEaus_ts <- ts(bounded_resp_df$NE_Aus_anomaly_co, 
               start = as.Date(min(bounded_resp_df$time)), frequency = 52)
SEaus_ts <- ts(bounded_resp_df$SE_Aus_anomaly_co, 
               start = as.Date(min(bounded_resp_df$time)), frequency = 52)

nino_ts <- ts(bounded_pred_df$nino.anomaly, 
              start = as.Date(min(bounded_pred_df$time)), frequency = 52)
dmi_ts <- ts(bounded_pred_df$dmi.anomaly, 
             start = as.Date(min(bounded_pred_df$time)), frequency = 52)
tsa_ts <- ts(bounded_pred_df$tsa.anomaly, 
             start = as.Date(min(bounded_pred_df$time)), frequency = 52)
aao_ts <- ts(bounded_pred_df$aao.anomaly, 
             start = as.Date(min(bounded_pred_df$time)), frequency = 52)

olrNE_ts <- ts(bounded_olr_df$NE_anom, 
              start = as.Date(min(bounded_olr_df$Date)), frequency = 52)
olrSE_ts  <- ts(bounded_olr_df$SE_anom, 
              start = as.Date(min(bounded_olr_df$Date)), frequency = 52)

wtio_ts <- ts(bounded_pred2_df$wtio.anomaly, 
              start = as.Date(min(bounded_pred_df$time)), frequency = 52)
etio_ts <- ts(bounded_pred2_df$etio.anomaly, 
              start = as.Date(min(bounded_pred_df$time)), frequency = 52)
```


```{r acf}

acf(NEaus_ts, type = "correlation", 
    lag = 52, main = "NE Aus")

acf(SEaus_ts, type = "correlation", 
    lag = 52, main = "SE Aus")

acf(nino_ts, type = "correlation", 
    lag = 52, main = "Nino")

acf(dmi_ts, type = "correlation", 
    lag = 52, main = "DMI")

acf(tsa_ts, type = "correlation", 
    lag = 52, main = "TSA")

acf(aao_ts, type = "correlation", 
    lag = 52, main = "AAO")

acf(olrNE_ts, type = "correlation", 
    lag = 52, main = "OLR - NE Aus")

acf(olrSE_ts, type = "correlation", 
    lag = 52, main = "OLR - SE Aus")

acf(wtio_ts, type = "correlation", 
    lag = 52, main = "WTIO")

acf(etio_ts, type = "correlation", 
    lag = 52, main = "ETIO")


#detrend 
detr_NE <- lm(NEaus_ts ~ time(NEaus_ts))
detr_SE <- lm(SEaus_ts ~ time(SEaus_ts))

resid_NE <- resid(detr_NE)
resid_SE <- resid(detr_SE)

```

```{r ccf}
#OLR NE Aus
ccf(as.numeric(olrNE_ts), as.numeric(nino_ts), type = "correlation", 
    lag = 52, main = " OLR:NE Aus & Nino")

ccf(as.numeric(olrNE_ts), as.numeric(dmi_ts), type = "correlation", 
    lag = 52, main = " OLR:NE Aus & DMI")

ccf(as.numeric(olrNE_ts), as.numeric(wtio_ts), type = "correlation", 
    lag = 52, main = " OLR:NE Aus & WTIO")

ccf(as.numeric(olrNE_ts), as.numeric(etio_ts), type = "correlation", 
    lag = 52, main = " OLR:NE Aus & ETIO")

ccf(as.numeric(olrNE_ts), as.numeric(aao_ts), type = "correlation", 
    lag = 52, main = " OLR:NE Aus & SAM")

#OLR SE Aus
ccf(as.numeric(olrSE_ts), as.numeric(nino_ts), type = "correlation", 
    lag = 52, main = " OLR:SE Aus & Nino")

ccf(as.numeric(olrSE_ts), as.numeric(dmi_ts), type = "correlation", 
    lag = 52, main = " OLR:SE Aus & DMI")

ccf(as.numeric(olrSE_ts), as.numeric(wtio_ts), type = "correlation", 
    lag = 52, main = " OLR:SE Aus & WTIO")

ccf(as.numeric(olrSE_ts), as.numeric(etio_ts), type = "correlation", 
    lag = 52, main = " OLR:SE Aus & ETIO")

ccf(as.numeric(olrSE_ts), as.numeric(aao_ts), type = "correlation", 
    lag = 52, main = " OLR:SE Aus & SAM")

#WTIO 
ccf(as.numeric(wtio_ts), as.numeric(nino_ts), type = "correlation", 
    lag = 52, main = "WTIO & Nino", ylim = c(-1,1))

ccf(as.numeric(wtio_ts), as.numeric(aao_ts), type = "correlation", 
    lag = 52, main = "WTIO & SAM")

ccf(as.numeric(wtio_ts), as.numeric(NEaus_ts), type = "correlation", 
    lag = 52, main = "WTIO & NE Aus")

ccf(as.numeric(wtio_ts), as.numeric(SEaus_ts), type = "correlation", 
    lag = 52, main = "WTIO & SE Aus")

#ETIO
ccf(as.numeric(etio_ts), as.numeric(nino_ts), type = "correlation", 
    lag = 52, main = "ETIO & Nino", ylim = c(-1,1))

ccf(as.numeric(etio_ts), as.numeric(aao_ts), type = "correlation", 
    lag = 52, main = "ETIO & SAM")

ccf(as.numeric(NEaus_ts), as.numeric(etio_ts), type = "correlation", 
    lag = 52, main = "NE Aus & ETIO")

ccf(as.numeric(resid_SE), as.numeric(etio_ts), type = "correlation", 
    lag = 52, main = "SE Aus & ETIO")

ccf(as.numeric(dmi_ts), as.numeric(resid_SE), type = "correlation", 
    lag = 52, main = "SE Aus & DMI")

#TSA
ccf(as.numeric(aao_ts), as.numeric(tsa_ts), type = "correlation", 
    lag = 52, main = "SAM & TSA")

```


```{r}
ccf(as.numeric(olrNE_ts), as.numeric(nino_ts), type = "correlation", 
    lag = 52, main = " OLR:NE Aus & Nino", xlim = c(0,52))

ccf(as.numeric(olrSE_ts), as.numeric(etio_ts), type = "correlation", 
    lag = 52, main = " OLR:SE Aus & ETIO", xlim = c(0,52))


```



## Updated EDA TS Figures
(time series (predictor) figures for final paper)

```{r }
#TODO: combine dataframes/sets to be one single predictor df
pred_anoms <- bounded_pred_df[,-c(6,7)]
pred_anoms$NEolr.anomaly <- bounded_olr_df$NE_anom
pred_anoms$SEolr.anomaly <- bounded_olr_df$SE_anom
pred_anoms$week <- bounded_pred_df$week

#TODO: adjust these colors as need
top.color <- "coral1"
bottom.color <- "skyblue1"

names(pred_anoms) <- c("time", 
                            "NINO", "DMI", "TSA", "SAM", "NE OLR", "SE OLR", "week")

y.lab.vals <- c("Anomaly (\u00B0C)",
                "Anomaly (\u00B0C)",
                "Anomaly (\u00B0C)",
                "Anomaly",
                "Anomaly",
                "Anomaly")
```


```{r}
predictors <- pred_anoms

pred_nams <- names(predictors)

for (i in 3:length(predictors)-1){
  predictors[,i] <- (predictors[,i] - mean(predictors[,i]))/ sd(predictors[,i]) #standardize
}

first.date <- min(predictors$time)
last.date <- max(predictors$time)

time <- predictors$time
time.range <- c(first.date, last.date)
x.ticks <- seq(year(time.range[1]), year(time.range[2]), by = 1) #can also be done with lubridate floor
x.ticks.new <- c(x.ticks, x.ticks[21] + 1)

x.ticks <- ymd(paste0(x.ticks, "01", "01"))
#c(x_ticks, last.date) #get last date

#extend to 2021 (or mid 2020)
x.ticks.new <- ymd(paste0(x.ticks.new, "01", "01"))

```

```{r fig_predTS}


#get full predictor data range
pred.max <- max(round(range(predictors[,2:7])))
pred.range <- c(-pred.max, pred.max)

setwd("~/CO_AUS/Aus_CO-main/Interactions_New/Figures")


#PC1 vs DMI
png(filename = "preds_tes.png", width = 2500, height = 3000, res = 300)

par(mfrow = c(6, 1))
par(mar = c(0,2,0,0))
par(oma = c(1.5,2,0,0))
par(mgp = c(2.75,1,0))
for (i in 2:7){
  this.pred <- (predictors[,i])
  temp.time <- as.Date(predictors$time)
  #temp.time <- gsub("-", "", temp.time)
  
  y.tick.max <- max(round(range(this.pred)))
  # y.tick.max <- 4
  y.tick.max.lab <- y.tick.max / 2
  y.ticks <- seq(-y.tick.max, y.tick.max, by = 1)
  y.tick.labs <- c(-y.tick.max.lab, 0, y.tick.max.lab)
  
  plot(temp.time, this.pred, type = "l", col = "black", lwd = 2,
       xaxt = "n", xlab = "",
       yaxt = "n", ylab = y.lab.vals[i-1], col.lab = "black",
       xlim = c(as.Date(time.range[1]) + months(7), as.Date(time.range[2]) - months(7)),
       ylim = pred.range, bty = "n", cex.lab = 1.25,  xpd = NA)
  
      if (i == 7){
        text(x = x.ticks[-length(x.ticks)] + months(6),
         y = range(y.ticks)[1]-0.7,
         labels = year(x.ticks[-length(x.ticks)]),
         cex = 1.3, col = "black", xpd = NA)
      }
  
    
     if (i == 2){ abline(v = x.ticks[1:(length(x.ticks))],
                      lty = 2, col = "grey", lwd = 2, xpd = NA) }
  
      axis(side = 2, at = y.tick.labs, labels = y.tick.labs, col = NA, 
      col.ticks = "black", col.axis = "black")
  
      abline(h = 0, lty = 1, col = "grey", lwd = 1)
  
      over <- this.pred >= 0
      this.pred.over <- this.pred
      this.pred.over[!over] <- 0
      this.pred.under <- this.pred
      this.pred.under[over] <- 0
  
      envelopePlot(x1 = temp.time,
               y1 = this.pred.over,
               x2 = temp.time,
               y2 = rep(0, length(time)),
               col = alpha(top.color, 0.7),
               lineCol = NA)
      envelopePlot(x1 = temp.time,
               y1 = this.pred.under,
               x2 = temp.time,
               y2 = rep(0, length(time)),
               col = alpha(bottom.color, 0.7),
               lineCol = NA)
      
        
  td <- y.tick.labs[3]
  #td <- 2    
  legend(x = c(ymd("1999-05-01"), ymd("2001-10-01")),
         y = c(1.5*td, 2.75*td),
         # legend = toupper(pred.names[i]),
         legend = pred_nams[i],
         box.col = "white", bg = "white",
         # adj = c(0., 0.6),
         xpd = NA, text.col = "grey40", cex = 1.75)
  
}
dev.off()
```


```{r repeat_wtio_etio}
#compare dmi, wtio, etio
#TODO: combine dataframes/sets to be one single predictor df
predanoms_new <- bounded_pred_df[,c(1,3)]
predanoms_new$wtio.anomaly <- bounded_pred2_df$wtio.anomaly
predanoms_new$etio.anomaly <- bounded_pred2_df$etio.anomaly
predanoms_new$week <- bounded_pred_df$week

#TODO: adjust these colors as need
top.color <- "coral1"
bottom.color <- "skyblue1"

names(predanoms_new) <- c("time", 
                            "DMI", "WTIO", "ETIO", "week")

y.lab.vals <- c("Anomaly (\u00B0C)",
                "Anomaly (\u00B0C)",
                "Anomaly (\u00B0C)")

predictors <- predanoms_new

pred_nams <- names(predictors)

for (i in 3:length(predictors)-1){
  predictors[,i] <- (predictors[,i] - mean(predictors[,i]))/ sd(predictors[,i]) #standardize
}

first.date <- min(predictors$time)
last.date <- max(predictors$time)

time <- predictors$time
time.range <- c(first.date, last.date)
x.ticks <- seq(year(time.range[1]), year(time.range[2]), by = 1) #can also be done with lubridate floor
x.ticks.new <- c(x.ticks, x.ticks[21] + 1)

x.ticks <- ymd(paste0(x.ticks, "01", "01"))
#c(x_ticks, last.date) #get last date

#extend to 2021 (or mid 2020)
x.ticks.new <- ymd(paste0(x.ticks.new, "01", "01"))

```

```{r}

#get full predictor data range
pred.max <- max(round(range(predictors[,2:4])))
pred.range <- c(-pred.max, pred.max)

setwd("~/CO_AUS/Aus_CO-main/Interactions_New/Figures")


#PC1 vs DMI
png(filename = "IOD_ts.png", width = 2500, height = 1750, res = 300)

par(mfrow = c(3, 1))
par(mar = c(0,2,0,0))
par(oma = c(1.5,2,0,0))
par(mgp = c(2.75,1,0))
for (i in 2:4){
  this.pred <- (predictors[,i])
  temp.time <- as.Date(predictors$time)
  #temp.time <- gsub("-", "", temp.time)
  
  y.tick.max <- max(round(range(this.pred)))
  # y.tick.max <- 4
  y.tick.max.lab <- y.tick.max / 2
  y.ticks <- seq(-y.tick.max, y.tick.max, by = 1)
  y.tick.labs <- c(-y.tick.max.lab, 0, y.tick.max.lab)
  
  plot(temp.time, this.pred, type = "l", col = "black", lwd = 2,
       xaxt = "n", xlab = "",
       yaxt = "n", ylab = y.lab.vals[i-1], col.lab = "black",
       xlim = c(as.Date(time.range[1]) + months(7), as.Date(time.range[2]) - months(7)),
       ylim = pred.range, bty = "n", cex.lab = 1.25,  xpd = NA)
  
      if (i == 4){
        text(x = x.ticks[-length(x.ticks)] + months(6),
         y = range(y.ticks)[1]-1.5,
         labels = year(x.ticks[-length(x.ticks)]),
         cex = 1.3, col = "black", xpd = NA)
      }
  
    
     if (i == 2){ abline(v = x.ticks[1:(length(x.ticks))],
                      lty = 2, col = "grey", lwd = 2, xpd = NA) }
  
      axis(side = 2, at = y.tick.labs, labels = y.tick.labs, col = NA, 
      col.ticks = "black", col.axis = "black")
  
      abline(h = 0, lty = 1, col = "grey", lwd = 1)
  
      over <- this.pred >= 0
      this.pred.over <- this.pred
      this.pred.over[!over] <- 0
      this.pred.under <- this.pred
      this.pred.under[over] <- 0
  
      envelopePlot(x1 = temp.time,
               y1 = this.pred.over,
               x2 = temp.time,
               y2 = rep(0, length(time)),
               col = alpha(top.color, 0.7),
               lineCol = NA)
      envelopePlot(x1 = temp.time,
               y1 = this.pred.under,
               x2 = temp.time,
               y2 = rep(0, length(time)),
               col = alpha(bottom.color, 0.7),
               lineCol = NA)
      
        
  #td <- y.tick.labs[3]
  td <- 1.75    
  legend(x = c(ymd("1999-07-01"), ymd("2001-12-01")),
         y = c(1.5*td, 2.75*td),
         # legend = toupper(pred.names[i]),
         legend = pred_nams[i],
         box.col = "white", bg = "white",
         # adj = c(0., 0.6),
         xpd = NA, text.col = "grey40", cex = 1.75)
  
}
dev.off()
```



Repeat correlation work from earlier work

# Correlation Work

Comparison between climate modes and CO anomalies

```{r correlation_functions}

#specific to our problem (we can generalize later)
pred_cor <- function(resp, preds){
   
  cor_list <- list()
  for (j in 1:3) {
    temp_df <- as.data.frame(cbind(resp[[j]], preds[[j]]))
  
    nino_cor <- cor(temp_df, method = "pearson")[2:53]
    wtio_cor <- cor(temp_df, method = "pearson")[54:105]
    etio_cor <- cor(temp_df, method = "pearson")[106:157]
    tsa_cor <- cor(temp_df, method = "pearson")[158:209]
    aao_cor <- cor(temp_df, method = "pearson")[210:261]
    olr_cor <- cor(temp_df, method = "pearson")[262:313]
    
    cor_df <- data.frame(nino_cor, wtio_cor, etio_cor, tsa_cor, aao_cor, olr_cor)
    
    cor_list[[paste0("Group_", j)]] <- cor_df
  }
  
  return(cor_list)
  
}


predbase_cor <- function(resp, preds){
   
  cor_list <- list()
  for (j in 1:3) {
    temp_df <- as.data.frame(cbind(resp[[j]], preds[[j]]))
  
    nino_cor <- cor(temp_df, method = "pearson")[2:53]
    dmi_cor <- cor(temp_df, method = "pearson")[54:105]
    tsa_cor <- cor(temp_df, method = "pearson")[106:157]
    aao_cor <- cor(temp_df, method = "pearson")[158:209]
    olr_cor <- cor(temp_df, method = "pearson")[210:261]
    
    cor_df <- data.frame(nino_cor, dmi_cor, tsa_cor, aao_cor, olr_cor)
    
    cor_list[[paste0("Group_", j)]] <- cor_df
  }
  
  return(cor_list)
  
}

```


```{r correlation}
#full response correlation
NEcor_list <- pred_cor(NEresp_new, NEpreds_new)
SEcor_list <- pred_cor(SEresp_new, SEpreds_new)

NEcor_base <- predbase_cor(NEresp, NEpreds)
SEcor_base <- predbase_cor(SEresp, SEpreds)

#partial response correlation
NEcor_list_part <- pred_cor(NEresp_newpart, NEpreds_newpart)
SEcor_list_part <- pred_cor(SEresp_newpart, SEpreds_newpart)

NEcor_base_part <- predbase_cor(NEresp_part, NEpreds_part)
SEcor_base_part <- predbase_cor(SEresp_part, SEpreds_part)

#TODO: finalize the figures for this correlation

```

```{r test_plots}
plot(1:52, NEcor_list[[1]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 1 and WTIO")

plot(1:52, NEcor_list[[2]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 2 and WTIO")

plot(1:52, NEcor_list[[3]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 3 and WTIO")



plot(1:52, SEcor_list[[1]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 1 and WTIO")

plot(1:52, SEcor_list[[2]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 2 and WTIO")

plot(1:52, SEcor_list[[3]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 3 and WTIO")


```

```{r}
plot(1:52, NEcor_list[[1]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 1 and ETIO")

plot(1:52, NEcor_list[[2]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 2 and ETIO")

plot(1:52, NEcor_list[[3]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 3 and ETIO")

plot(1:52, SEcor_list[[1]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 1 and ETIO")

plot(1:52, SEcor_list[[2]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 2 and ETIO")

plot(1:52, SEcor_list[[3]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 3 and ETIO")

```

```{r test_figs}
plot(1:52, SEcor_base[[2]]$dmi_cor, col = "darkorchid3", lwd = 1.5, lty = 1,
     type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag")
lines(1:52, -SEcor_list[[2]]$etio_cor, col = "tomato4", lwd = 1.5, lty = 1)
lines(1:52, -SEcor_list_part[[2]]$etio_cor, col = "tomato4", lwd = 1.5, lty = 2)
lines(1:52, SEcor_base_part[[2]]$dmi_cor, col = "darkorchid3", lwd = 1.5, lty = 2)
abline(h = 0, lty = 2)
title("SE Aus Group 2 and IOD")


plot(1:52, SEcor_base[[2]]$dmi_cor, col = "darkorchid3", lwd = 1.5, lty = 1,
     type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag")
lines(1:52, SEcor_list[[2]]$wtio_cor, col = "firebrick2", lwd = 1.5, lty = 1)
lines(1:52, SEcor_list_part[[2]]$wtio_cor, col = "firebrick2", lwd = 1.5, lty = 2)
lines(1:52, SEcor_base_part[[2]]$dmi_cor, col = "darkorchid3", lwd = 1.5, lty = 2)
abline(h = 0, lty = 2)
title("SE Aus Group 2 and IOD")
```



```{r iod_cor}
#TODO: finalize and output these figures
setwd("~/CO_AUS/Aus_CO-main/Interactions_New/Figures")

#overlay DMI, WTIO, and ETIO
png(filename = "NEgroup1_iod.png", width = 2000, height = 1500, res = 300)
par(mar = c(5, 5, 4, 3))
plot(1:52, NEcor_list[[1]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "tomato4", lwd = 1.5, lty = 2)
lines(1:52, NEcor_list[[1]]$etio_cor, col = "cyan4", lwd = 1.5, lty = 2)
lines(1:52,  NEcor_base[[1]]$dmi_cor, col = "darkorchid3", lwd = 1.5, lty = 1)
abline(h = 0, lty = 2)
title("IOD (NE Aus Group 1)", adj = 0)
legend("topright", inset = c(0.01, 0.01),
       legend = c("DMI", "WTIO",  "ETIO"),
       lty = c(1,2,2),
              col = c( "darkorchid3", 
                "tomato4",
                "cyan4"),
       lwd = c(1.5, 1.5, 1.5))
dev.off()


#overlay DMI, WTIO, and ETIO
png(filename = "NEgroup2_iod.png", width = 2000, height = 1500, res = 300)
par(mar = c(5, 5, 4, 3))
plot(1:52, NEcor_list[[2]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "tomato4", lwd = 1.5, lty = 2)
lines(1:52, NEcor_list[[2]]$etio_cor, col = "cyan4", lwd = 1.5, lty = 2)
lines(1:52,  NEcor_base[[2]]$dmi_cor, col = "darkorchid3", lwd = 1.5, lty = 1)
abline(h = 0, lty = 2)
title("IOD (NE Aus Group 2)", adj = 0)
legend("topright", inset = c(0.01, 0.01),
       legend = c("DMI", "WTIO",  "ETIO"),
       lty = c(1,2,2),
              col = c( "darkorchid3", 
                "tomato4",
                "cyan4"),
       lwd = c(1.5, 1.5, 1.5))
dev.off()


png(filename = "NEgroup3_iod.png", width = 2000, height = 1500, res = 300)
par(mar = c(5, 5, 4, 3))
plot(1:52, NEcor_list[[3]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "tomato4", lwd = 1.5, lty = 2)
lines(1:52, NEcor_list[[3]]$etio_cor, col = "cyan4", lwd = 1.5, lty = 2)
lines(1:52,  NEcor_base[[3]]$dmi_cor, col = "darkorchid3", lwd = 1.5, lty = 1)
abline(h = 0, lty = 2)
title("IOD (NE Aus Group 3)", adj = 0)
legend("topright", inset = c(0.01, 0.01),
       legend = c("DMI", "WTIO",  "ETIO"),
       lty = c(1,2,2),
              col = c( "darkorchid3", 
                "tomato4",
                "cyan4"),
       lwd = c(1.5, 1.5, 1.5))
dev.off()


png(filename = "SEgroup1_iod.png", width = 2000, height = 1500, res = 300)
par(mar = c(5, 5, 4, 3))
plot(1:52, SEcor_list[[1]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "tomato4", lwd = 1.5, lty = 2)
lines(1:52, SEcor_list[[1]]$etio_cor, col = "cyan4", lwd = 1.5, lty = 2)
lines(1:52,  SEcor_base[[1]]$dmi_cor, col = "darkorchid3", lwd = 1.5, lty = 1)
abline(h = 0, lty = 2)
title("IOD (SE Aus Group 1)", adj = 0)
legend("topright", inset = c(0.01, 0.01),
       legend = c("DMI", "WTIO",  "ETIO"),
       lty = c(1,2,2),
              col = c( "darkorchid3", 
                "tomato4",
                "cyan4"),
       lwd = c(1.5, 1.5, 1.5))
dev.off()


png(filename = "SEgroup2_iod.png", width = 2000, height = 1500, res = 300)
par(mar = c(5, 5, 4, 3))
plot(1:52, SEcor_list[[2]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "tomato4", lwd = 1.5, lty = 2)
lines(1:52, SEcor_list[[2]]$etio_cor, col = "cyan4", lwd = 1.5, lty = 2)
lines(1:52,  SEcor_base[[2]]$dmi_cor, col = "darkorchid3", lwd = 1.5, lty = 1)
abline(h = 0, lty = 2)
title("IOD (SE Aus Group 2)", adj = 0)
legend("topright", inset = c(0.01, 0.01),
       legend = c("DMI", "WTIO",  "ETIO"),
       lty = c(1,2,2),
              col = c( "darkorchid3", 
                "tomato4",
                "cyan4"),
       lwd = c(1.5, 1.5, 1.5))
dev.off()


png(filename = "SEgroup3_iod.png", width = 2000, height = 1500, res = 300)
par(mar = c(5, 5, 4, 3))
plot(1:52, SEcor_list[[3]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "tomato4", lwd = 1.5, lty = 2)
lines(1:52, SEcor_list[[3]]$etio_cor, col = "cyan4", lwd = 1.5, lty = 2)
lines(1:52,  SEcor_base[[3]]$dmi_cor, col = "darkorchid3", lwd = 1.5, lty = 1)
abline(h = 0, lty = 2)
title("IOD (SE Aus Group 3)", adj = 0)
legend("topright", inset = c(0.01, 0.01),
       legend = c("DMI", "WTIO",  "ETIO"),
       lty = c(1,2,2),
              col = c( "darkorchid3", 
                "tomato4",
                "cyan4"),
       lwd = c(1.5, 1.5, 1.5))
dev.off()

```




