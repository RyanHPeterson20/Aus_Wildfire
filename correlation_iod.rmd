---
title: "correlation_iod"
author: "Ryan Peterson"
date: "2025-09-14"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r library}
suppressMessages( library(hierNet)) #yes
suppressMessages( library(glmnet)) #test ridge regression for coefs
suppressMessages( library(RAMP)) #maybe
suppressMessages( library(MASS)) #for lm.ridge

suppressMessages( library(foreach)) #parallelization setup
suppressMessages( library(parallel))
suppressMessages( library(doParallel))

suppressMessages( library( lubridate)) #you know why
suppressMessages( library( colorspace)) #for some color alternatives
suppressMessages( library( fields)) #for set.panel() and others 
suppressMessages( library(ggpubr)) #nice tables for dfs (uses ggplot)

suppressMessages( library( caret)) #for confusion matrix

suppressMessages( library( tictoc)) #some timing
```

```{r data_load}
#and functions
# Data Set-Up
setwd("~/CO_AUS/Aus_CO-main/Interactions")

load( "Data/ne_data.rda")
load( "Data/se_data.rda")
load( "Data/bounded_data.rda")
load( "Data/data_matrix.rda")
load( "Data/lag_list.rda")
load( "Data/data_quantile.rda")

#functions:
#source("group_functions.R") #grouping/clustering
source("group_functionsNew.R") #new groupings
source("refit_functions.R") #coef/refit functions


setwd("~/CO_AUS/Aus_CO-main/Interactions_New")
load( "IOD_lag.rda")
```


Repeat correlation work from earlier work


# Correlation Work

Comparison between climate modes and CO anomalies

```{r correlation_functions}

#specific to our problem (we can generalize later)
pred_cor <- function(resp, preds){
   
  cor_list <- list()
  for (j in 1:3) {
    temp_df <- as.data.frame(cbind(resp[[j]], preds[[j]]))
  
    nino_cor <- cor(temp_df, method = "pearson")[2:53]
    wtio_cor <- cor(temp_df, method = "pearson")[54:105]
    etio_cor <- cor(temp_df, method = "pearson")[106:157]
    tsa_cor <- cor(temp_df, method = "pearson")[158:209]
    aao_cor <- cor(temp_df, method = "pearson")[210:261]
    olr_cor <- cor(temp_df, method = "pearson")[262:313]
    
    cor_df <- data.frame(nino_cor, wtio_cor, etio_cor, tsa_cor, aao_cor, olr_cor)
    
    cor_list[[paste0("Group_", j)]] <- cor_df
  }
  
  return(cor_list)
  
}

```


```{r correlation}
#full response correlation
NEcor_list <- pred_cor(NEresp, NEpreds)
SEcor_list <- pred_cor(SEresp, SEpreds)

#partial response correlation
NEcor_list_part <- pred_cor(NEresp_part, NEpreds_part)
SEcor_list_part <- pred_cor(SEresp_part, SEpreds_part)

#TODO: finalize the figures for this correlation

```

```{r test_plots}
plot(1:52, NEcor_list[[1]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 1 and WTIO")

plot(1:52, NEcor_list[[2]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 2 and WTIO")

plot(1:52, NEcor_list[[3]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 3 and WTIO")



plot(1:52, SEcor_list[[1]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 1 and WTIO")

plot(1:52, SEcor_list[[2]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 2 and WTIO")

plot(1:52, SEcor_list[[3]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 3 and WTIO")


```

```{r}
plot(1:52, NEcor_list[[1]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 1 and ETIO")

plot(1:52, NEcor_list[[2]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 2 and ETIO")

plot(1:52, NEcor_list[[3]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("NE Aus Group 3 and ETIO")

plot(1:52, SEcor_list[[1]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 1 and ETIO")

plot(1:52, SEcor_list[[2]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 2 and ETIO")

plot(1:52, SEcor_list[[3]]$etio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
title("SE Aus Group 3 and ETIO")

```

```{r}
#TODO: overlay DMI, WTIO, and ETIO
plot(1:52, SEcor_list[[2]]$wtio_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
lines(1:52, SEcor_list[[2]]$etio_cor, col = "tomato4", lwd = 1.5, lty = 2)
abline(h = 0, lty = 2)
title("SE Aus Group 2 and IOD")


```

## ACF (Cross-Correlation)





# Get Update Time-Series Plots


