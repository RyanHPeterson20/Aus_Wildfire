---
title: "IOD_sst_prep"
author: "Ryan Peterson"
date: "2025-08-22"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r library}
#.nc files
suppressMessages(library(ncdf4))
suppressMessages(library(terra))

# date/data mgmt
suppressMessages(library(lubridate))
suppressMessages(library(abind))

#visualization and interpolation
suppressMessages(library(fields))
suppressMessages(library(colorspace))
suppressMessages(library(RColorBrewer))
suppressMessages(library(scales)) #for adjusting opacity
```

Data Prep file for the following reanalysis products:

1. GODAS (NCEP Global Ocean Data Assimilation System from 1980 to 2019)
  a. Resolution:
2. ORA-S5 (ECMWF Ocean Reanalysis System 5 from 1979 to 2018)
  a. Resolution
3. OISST v2 (NOAA Optimum Interpolation SST version 2 from 1982 to 2019)
  a. Resolution
4. SODA3.3.1 (Simple Ocean Data Assimilation version 3.3.1 from 1980 to 2015)
  a. Resolution


Goal: be able to produce flexible (wrt spatial grid and time) sst arrays for each data product

Note: we are moving all the associated EOF prep files to here then moving them elsewhere.

# Set-up

```{r ranges}
#indian ocean region
wide_maxLon <- 120
wide_minLon <- 30
wide_maxLat <- 20
wide_minLat <- -20

#pIOD (40, -5) X (100, 5)
pIOD_maxLon <- 100
pIOD_minLon <- 40 
pIOD_maxLat <- 5
pIOD_minLat <- -5

```

```{r dmi_range}
#DMI west/WTIO (50, -10) X (70, 10) 
wDMI_maxLon <- 70
wDMI_minLon <- 50
wDMI_maxLat <- 10
wDMI_minLat <- -10

#DMI east/SETIO (90, -10) X (110, 0)
eDMI_maxLon <- 110
eDMI_minLon <- 90
eDMI_maxLat <- 0
eDMI_minLat <- -10
```

```{r grid_points}
#setup grid points for 1x1 degree resolution.
#lon.wide <- seq(wide_minLon+0.5, wide_maxLon-0.5, by = 1)
#lat.wide <- seq(wide_minLat+0.5, wide_maxLat-0.5, by = 1)

lon.wide <- seq(wide_minLon, wide_maxLon, by = 1)
lat.wide <- seq(wide_minLat, wide_maxLat, by = 1)

#grid list from 
grid.list <- list(x = lon.wide,
                  y = lat.wide)


#TODO: rm() region boundaries after all the points and ranges are setup
```


# GODAS

```{r GODAS_import}
setwd("~/CO_AUS/Aus_CO-main")

#GODAS data only (yearly .nc 1982-2015)
#1982
nc.GODAS.1982 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1982.nc")

#1983
nc.GODAS.1983 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1983.nc")

#1984
nc.GODAS.1984 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1984.nc")

#1985
nc.GODAS.1985 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1985.nc")

#1986
nc.GODAS.1986 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1986.nc")

#1987
nc.GODAS.1987 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1987.nc")

#1988
nc.GODAS.1988 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1988.nc")

#1989
nc.GODAS.1989 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1989.nc")

#1990
nc.GODAS.1990 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1990.nc")

#1991
nc.GODAS.1991 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1991.nc")

#1992
nc.GODAS.1992 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1992.nc")

#1993
nc.GODAS.1993 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1993.nc")

#1994
nc.GODAS.1994 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1994.nc")

#1995
nc.GODAS.1995 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1995.nc")

#1996
nc.GODAS.1996 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1996.nc")

#1997
nc.GODAS.1997 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1997.nc")

#1998
nc.GODAS.1998 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1998.nc")

#1999
nc.GODAS.1999 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1999.nc")

#2000
nc.GODAS.2000 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2000.nc")

#2001
nc.GODAS.2001 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2001.nc")

#2002
nc.GODAS.2002 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2002.nc")

#2003
nc.GODAS.2003 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2003.nc")

#2004
nc.GODAS.2004 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2004.nc")

#2005
nc.GODAS.2005 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2005.nc")

#2006
nc.GODAS.2006 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2006.nc")

#2007
nc.GODAS.2007 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2007.nc")

#2008
nc.GODAS.2008 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2008.nc")

#2009
nc.GODAS.2009 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2009.nc")

#2010
nc.GODAS.2010 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2010.nc")

#2011
nc.GODAS.2011 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2011.nc")

#2012
nc.GODAS.2012 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2012.nc")

#2013
nc.GODAS.2013 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2013.nc")

#2014
nc.GODAS.2014 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2014.nc")

#2015
nc.GODAS.2015 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2015.nc")

```

```{r additional_GODAS_import}
#include back to 1980
#1980
nc.GODAS.1980 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1980.nc")

#1981
nc.GODAS.1981 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1981.nc")

#include up to 2019
#2016
nc.GODAS.2016 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2016.nc")

#2017
nc.GODAS.2017 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2017.nc")

#2018
nc.GODAS.2018 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2018.nc")

#2019
nc.GODAS.2019 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2019.nc")
```


## GODAS Functions

```{r prep_functions}
#sorting/extraction of godas .nc data
godas_prep <- function(nc.data){
  
  #extract lon.lat
  lon.grid.temp <- nc.data[["dim"]][["lon"]][["vals"]]
  lat.grid.temp <- nc.data[["dim"]][["lat"]][["vals"]]
  
  #reorder lon for 
  lon.grid.temp[lon.grid.temp >= 180] <- lon.grid.temp[lon.grid.temp >= 180] - 360
  lon.order.temp <- order(lon.grid.temp)
  
  lon.grid.temp <- lon.grid.temp[lon.order.temp]
  
  #reorder lat
  lat.order.temp <- order(lat.grid.temp, decreasing = TRUE)
  lat.grid.temp <- lat.grid.temp[lat.order.temp]
  
  #times for months
  times.temp <- ncvar_get(nc.data, "time") # days since 1800-01-01 00:00:0.0
  times.temp <- as_datetime("1800-01-01T00:00:00") + days(times.temp)
  
  #temps, as array (lon, lat, level, time)
  #TODO adjust from K to c (K - 273.15)
  sst.temp <- ncvar_get(nc.data, "pottmp")
  sst.temp <- sst.temp[lon.order.temp, lat.order.temp, 1, ] #level: depth 5m
  
  #adjust to C from K (c = K - 273.15)
  sst.temp <- sst.temp - 273.15
  
  #return lon, lat, time, sst
  return(list(
    lon = lon.grid.temp,
    lat = lat.grid.temp,
    time = times.temp,
    sst = sst.temp))
}


```

## GODAS Data Setup

```{r data_cleaning}
#data cleaning 
godas_list <- list(nc.GODAS.1982, nc.GODAS.1983, nc.GODAS.1984, nc.GODAS.1985, nc.GODAS.1986, 
                   nc.GODAS.1987, nc.GODAS.1988, nc.GODAS.1989, nc.GODAS.1990, nc.GODAS.1991,
                   nc.GODAS.1992, nc.GODAS.1993, nc.GODAS.1994, nc.GODAS.1995, nc.GODAS.1996,
                   nc.GODAS.1997, nc.GODAS.1998, nc.GODAS.1999, nc.GODAS.2000, nc.GODAS.2001,
                   nc.GODAS.2002, nc.GODAS.2003, nc.GODAS.2004, nc.GODAS.2005, nc.GODAS.2006,
                   nc.GODAS.2007, nc.GODAS.2008, nc.GODAS.2009, nc.GODAS.2010, nc.GODAS.2011,
                   nc.GODAS.2012, nc.GODAS.2013, nc.GODAS.2014, nc.GODAS.2015)

#get lon, lat, sst, and times
sst.GODAS.new <- NULL
for (i in 1:length(godas_list)) {
  nc.temp <- godas_list[[i]] 
  
  temp.nc.godas <- godas_prep(nc.temp)
  temp.lon <- temp.nc.godas$lon
  temp.lat <- temp.nc.godas$lat
  temp.sst <- temp.nc.godas$sst
  
  #get reduce range (indian ocean region)
  new.lon <- temp.lon[temp.lon <= wide_maxLon & temp.lon >= wide_minLon]
  lon.range <- range(which(temp.lon <= wide_maxLon & temp.lon >= wide_minLon))
  new.lat <- temp.lat[temp.lat <= wide_maxLat & temp.lat >= wide_minLat]
  lat.range <- range(which(temp.lat <= wide_maxLat & temp.lat >= wide_minLat))
  
  new.sst <- temp.sst[lon.range[1]:lon.range[2], lat.range[1]:lat.range[2], ]
  
  #interpolate to 1x1 grid
  sst.godas.interp <- NULL
  for (j in 1:dim(new.sst)[3]) {
    obj.godas <- list(x = new.lon, y = rev(new.lat), z = new.sst[,,j])
  
    interp.out <-  interp.surface.grid(obj.godas, grid.list)
    
    sst.godas.interp <- abind(sst.godas.interp, interp.out$z[ ,ncol(interp.out$z):1 ], along = 3)
  }
  sst.GODAS.new <- abind(sst.GODAS.new, sst.godas.interp, along = 3)
}

rm(nc.GODAS.1982, nc.GODAS.1983, nc.GODAS.1984, nc.GODAS.1985, nc.GODAS.1986, 
                   nc.GODAS.1987, nc.GODAS.1988, nc.GODAS.1989, nc.GODAS.1990, nc.GODAS.1991,
                   nc.GODAS.1992, nc.GODAS.1993, nc.GODAS.1994, nc.GODAS.1995, nc.GODAS.1996,
                   nc.GODAS.1997, nc.GODAS.1998, nc.GODAS.1999, nc.GODAS.2000, nc.GODAS.2001,
                   nc.GODAS.2002, nc.GODAS.2003, nc.GODAS.2004, nc.GODAS.2005, nc.GODAS.2006,
                   nc.GODAS.2007, nc.GODAS.2008, nc.GODAS.2009, nc.GODAS.2010, nc.GODAS.2011,
                   nc.GODAS.2012, nc.GODAS.2013, nc.GODAS.2014, nc.GODAS.2015)


dim(sst.GODAS.new)



```

### GODAS w/o Interpolation

```{r godas_raw}
#data cleaning 
godas_list <- list(nc.GODAS.1982, nc.GODAS.1983, nc.GODAS.1984, nc.GODAS.1985, nc.GODAS.1986, 
                   nc.GODAS.1987, nc.GODAS.1988, nc.GODAS.1989, nc.GODAS.1990, nc.GODAS.1991,
                   nc.GODAS.1992, nc.GODAS.1993, nc.GODAS.1994, nc.GODAS.1995, nc.GODAS.1996,
                   nc.GODAS.1997, nc.GODAS.1998, nc.GODAS.1999, nc.GODAS.2000, nc.GODAS.2001,
                   nc.GODAS.2002, nc.GODAS.2003, nc.GODAS.2004, nc.GODAS.2005, nc.GODAS.2006,
                   nc.GODAS.2007, nc.GODAS.2008, nc.GODAS.2009, nc.GODAS.2010, nc.GODAS.2011,
                   nc.GODAS.2012, nc.GODAS.2013, nc.GODAS.2014, nc.GODAS.2015)  #, nc.GODAS.2016,
                   #nc.GODAS.2017, nc.GODAS.2018, nc.GODAS.2019)

#get lon, lat, sst, and times
sst.GODAS.new2 <- NULL
for (i in 1:length(godas_list)) {
  nc.temp <- godas_list[[i]] 
  
  temp.nc.godas <- godas_prep(nc.temp)
  temp.lon <- temp.nc.godas$lon
  temp.lat <- temp.nc.godas$lat
  temp.sst <- temp.nc.godas$sst
  
  #get reduce range (indian ocean region)
  new.lon <- temp.lon[temp.lon <= wide_maxLon & temp.lon >= wide_minLon]
  lon.range <- range(which(temp.lon <= wide_maxLon & temp.lon >= wide_minLon))
  new.lat <- temp.lat[temp.lat <= wide_maxLat & temp.lat >= wide_minLat]
  lat.range <- range(which(temp.lat <= wide_maxLat & temp.lat >= wide_minLat))
  
  #assign
  sst.temp <- temp.sst[lon.range[1]:lon.range[2], lat.range[1]:lat.range[2], ]
  
  sst.GODAS.new2 <- abind(sst.GODAS.new2, sst.temp, along = 3)
}

GODAS.lon <- new.lon
GODAS.lat <- new.lat

rm(nc.GODAS.1982, nc.GODAS.1983, nc.GODAS.1984, nc.GODAS.1985, nc.GODAS.1986, 
                   nc.GODAS.1987, nc.GODAS.1988, nc.GODAS.1989, nc.GODAS.1990, nc.GODAS.1991,
                   nc.GODAS.1992, nc.GODAS.1993, nc.GODAS.1994, nc.GODAS.1995, nc.GODAS.1996,
                   nc.GODAS.1997, nc.GODAS.1998, nc.GODAS.1999, nc.GODAS.2000, nc.GODAS.2001,
                   nc.GODAS.2002, nc.GODAS.2003, nc.GODAS.2004, nc.GODAS.2005, nc.GODAS.2006,
                   nc.GODAS.2007, nc.GODAS.2008, nc.GODAS.2009, nc.GODAS.2010, nc.GODAS.2011,
                   nc.GODAS.2012, nc.GODAS.2013, nc.GODAS.2014, nc.GODAS.2015)

dim(sst.GODAS.new2)

```

```{r save_godas}
setwd("~/CO_AUS/Aus_CO-main/pIOD")
save(sst.GODAS.new, sst.GODAS.new2, GODAS.lon, GODAS.lat,  file = "sstGODAS.rda")
```


# ORA-S5

```{r oras_import}
#import some of the associated data
setwd("~/CO_AUS/Aus_CO-main")

#ORAS5
##1982
#sept 1982
nc.ORAS.1982s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198209_CONS_v0.1.nc")
#oct 1982
nc.ORAS.1982o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198210_CONS_v0.1.nc")
#nov 1982
nc.ORAS.1982n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198211_CONS_v0.1.nc")

##1983
#sept 1983
nc.ORAS.1983s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198309_CONS_v0.1.nc")
#oct 1983
nc.ORAS.1983o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198310_CONS_v0.1.nc")
#nov 1983
nc.ORAS.1983n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198311_CONS_v0.1.nc")

##1984
#sept 1984
nc.ORAS.1984s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198409_CONS_v0.1.nc")
#oct 1984
nc.ORAS.1984o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198410_CONS_v0.1.nc")
#nov 1984
nc.ORAS.1984n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198411_CONS_v0.1.nc")

##1985
#sept 1985
nc.ORAS.1985s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198509_CONS_v0.1.nc")
#oct 1985
nc.ORAS.1985o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198510_CONS_v0.1.nc")
#nov 1985
nc.ORAS.1985n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198511_CONS_v0.1.nc")

##1986
#sept 1986
nc.ORAS.1986s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198609_CONS_v0.1.nc")
#oct 1986
nc.ORAS.1986o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198610_CONS_v0.1.nc")
#nov 1986
nc.ORAS.1986n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198611_CONS_v0.1.nc")

##1987
#sept 1987
nc.ORAS.1987s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198709_CONS_v0.1.nc")
#oct 1987
nc.ORAS.1987o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198710_CONS_v0.1.nc")
#nov 1987
nc.ORAS.1987n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198711_CONS_v0.1.nc")

##1988
#sept 1988
nc.ORAS.1988s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198809_CONS_v0.1.nc")
#oct 1988
nc.ORAS.1988o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198810_CONS_v0.1.nc")
#nov 1988
nc.ORAS.1988n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198811_CONS_v0.1.nc")

##1989
#sept 1989
nc.ORAS.1989s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198909_CONS_v0.1.nc")
#oct 1989
nc.ORAS.1989o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198910_CONS_v0.1.nc")
#nov 1989
nc.ORAS.1989n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198911_CONS_v0.1.nc")

##1990
#sept 1990
nc.ORAS.1990s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199009_CONS_v0.1.nc")
#oct 1990
nc.ORAS.1990o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199010_CONS_v0.1.nc")
#nov 1990
nc.ORAS.1990n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199011_CONS_v0.1.nc")

##1991
#sept 1991
nc.ORAS.1991s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199109_CONS_v0.1.nc")
#oct 1991
nc.ORAS.1991o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199110_CONS_v0.1.nc")
#nov 1991
nc.ORAS.1991n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199111_CONS_v0.1.nc")

##1992
#sept 1992
nc.ORAS.1992s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199209_CONS_v0.1.nc")
#oct 1992
nc.ORAS.1992o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199210_CONS_v0.1.nc")
#nov 1992
nc.ORAS.1992n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199211_CONS_v0.1.nc")

##1993
#sept 1993
nc.ORAS.1993s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199309_CONS_v0.1.nc")
#oct 1993
nc.ORAS.1993o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199310_CONS_v0.1.nc")
#nov 1993
nc.ORAS.1993n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199311_CONS_v0.1.nc")

##1994
#sept 1994
nc.ORAS.1994s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199409_CONS_v0.1.nc")
#oct 1994
nc.ORAS.1994o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199410_CONS_v0.1.nc")
#nov 1994
nc.ORAS.1994n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199411_CONS_v0.1.nc")

##1995
#sept 1995
nc.ORAS.1995s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199509_CONS_v0.1.nc")
#oct 1995
nc.ORAS.1995o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199510_CONS_v0.1.nc")
#nov 1995
nc.ORAS.1995n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199511_CONS_v0.1.nc")

##1996
#sept 1996
nc.ORAS.1996s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199609_CONS_v0.1.nc")
#oct 1996
nc.ORAS.1996o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199610_CONS_v0.1.nc")
#nov 1996
nc.ORAS.1996n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199611_CONS_v0.1.nc")

##1997
#sept 1997
nc.ORAS.1997s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199709_CONS_v0.1.nc")
#oct 1997
nc.ORAS.1997o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199710_CONS_v0.1.nc")
#nov 1997
nc.ORAS.1997n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199711_CONS_v0.1.nc")

##1998
#sept 1998
nc.ORAS.1998s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199809_CONS_v0.1.nc")
#oct 1998
nc.ORAS.1998o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199810_CONS_v0.1.nc")
#nov 1998
nc.ORAS.1998n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199811_CONS_v0.1.nc")

##1999
#sept 1999
nc.ORAS.1999s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199909_CONS_v0.1.nc")
#oct 1999
nc.ORAS.1999o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199910_CONS_v0.1.nc")
#nov 1999
nc.ORAS.1999n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199911_CONS_v0.1.nc")

##2000
#sept 2000
nc.ORAS.2000s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200009_CONS_v0.1.nc")
#oct 2000
nc.ORAS.2000o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200010_CONS_v0.1.nc")
#nov 2000
nc.ORAS.2000n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200011_CONS_v0.1.nc")

##2001
#sept 2001
nc.ORAS.2001s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200109_CONS_v0.1.nc")
#oct 2001
nc.ORAS.2001o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200110_CONS_v0.1.nc")
#nov 2001
nc.ORAS.2001n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200111_CONS_v0.1.nc")

##2002
#sept 2002
nc.ORAS.2002s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200209_CONS_v0.1.nc")
#oct 2002
nc.ORAS.2002o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200210_CONS_v0.1.nc")
#nov 2002
nc.ORAS.2002n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200211_CONS_v0.1.nc")

##2003
#sept 2003
nc.ORAS.2003s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200309_CONS_v0.1.nc")
#oct 2003
nc.ORAS.2003o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200310_CONS_v0.1.nc")
#nov 2003
nc.ORAS.2003n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200311_CONS_v0.1.nc")

##2004
#sept 2004
nc.ORAS.2004s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200409_CONS_v0.1.nc")
#oct 2004
nc.ORAS.2004o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200410_CONS_v0.1.nc")
#nov 2004
nc.ORAS.2004n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200411_CONS_v0.1.nc")

##2005
#sept 2005
nc.ORAS.2005s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200509_CONS_v0.1.nc")
#oct 2005
nc.ORAS.2005o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200510_CONS_v0.1.nc")
#nov 2005
nc.ORAS.2005n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200511_CONS_v0.1.nc")

##2006
#sept 2006
nc.ORAS.2006s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200609_CONS_v0.1.nc")
#oct 2006
nc.ORAS.2006o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200610_CONS_v0.1.nc")
#nov 2006
nc.ORAS.2006n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200611_CONS_v0.1.nc")

##2007
#sept 2007
nc.ORAS.2007s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200709_CONS_v0.1.nc")
#oct 2007
nc.ORAS.2007o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200710_CONS_v0.1.nc")
#nov 2007
nc.ORAS.2007n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200711_CONS_v0.1.nc")

##2008
#sept 2008
nc.ORAS.2008s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200809_CONS_v0.1.nc")
#oct 2008
nc.ORAS.2008o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200810_CONS_v0.1.nc")
#nov 2008
nc.ORAS.2008n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200811_CONS_v0.1.nc")

##2009
#sept 2009
nc.ORAS.2009s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200909_CONS_v0.1.nc")
#oct 2009
nc.ORAS.2009o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200910_CONS_v0.1.nc")
#nov 2009
nc.ORAS.2009n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200911_CONS_v0.1.nc")

##2010
#sept 2010
nc.ORAS.2010s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201009_CONS_v0.1.nc")
#oct 2010
nc.ORAS.2010o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201010_CONS_v0.1.nc")
#nov 2010
nc.ORAS.2010n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201011_CONS_v0.1.nc")

##2011
#sept 2011
nc.ORAS.2011s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201109_CONS_v0.1.nc")
#oct 2011
nc.ORAS.2011o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201110_CONS_v0.1.nc")
#nov 2011
nc.ORAS.2011n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201111_CONS_v0.1.nc")

##2012
#sept 2012
nc.ORAS.2012s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201209_CONS_v0.1.nc")
#oct 2012
nc.ORAS.2012o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201210_CONS_v0.1.nc")
#nov 2012
nc.ORAS.2012n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201211_CONS_v0.1.nc")

##2013
#sept 2013
nc.ORAS.2013s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201309_CONS_v0.1.nc")
#oct 2013
nc.ORAS.2013o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201310_CONS_v0.1.nc")
#nov 2013
nc.ORAS.2013n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201311_CONS_v0.1.nc")

##2014
#sept 2014
nc.ORAS.2014s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201409_CONS_v0.1.nc")
#oct 2014
nc.ORAS.2014o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201410_CONS_v0.1.nc")
#nov 2014
nc.ORAS.2014n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201411_CONS_v0.1.nc")

##2015
#sept 2015
nc.ORAS.2015s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201509_OPER_v0.1.nc")
#oct 2015
nc.ORAS.2015o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201510_OPER_v0.1.nc")
#nov 2015
nc.ORAS.2015n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201511_OPER_v0.1.nc")

#TODO: add in years 2016-2019

```

```{r expanded_oras_import}
#include all months between 1982-2015
setwd("~/CO_AUS/Aus_CO-main")

#ORAS5

##1982
#jan 1982
nc.ORAS.1982jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198201_CONS_v0.1.nc")
#feb 1982
nc.ORAS.1982feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198202_CONS_v0.1.nc")
#mar 1982
nc.ORAS.1982mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198203_CONS_v0.1.nc")
#apr 1982
nc.ORAS.1982apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198204_CONS_v0.1.nc")
#may 1982
nc.ORAS.1982may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198205_CONS_v0.1.nc")
#june 1982
nc.ORAS.1982jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198206_CONS_v0.1.nc")
#july 1982
nc.ORAS.1982jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198207_CONS_v0.1.nc")
#august 1982
nc.ORAS.1982aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198208_CONS_v0.1.nc")
#december 1982
nc.ORAS.1982dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198212_CONS_v0.1.nc")

nc.ORAS.1982ex <- list(nc.ORAS.1982jan, nc.ORAS.1982feb, nc.ORAS.1982mar, nc.ORAS.1982apr, nc.ORAS.1982may, nc.ORAS.1982jun, 
                       nc.ORAS.1982jul, nc.ORAS.1982aug, nc.ORAS.1982s, nc.ORAS.1982o, nc.ORAS.1982n, nc.ORAS.1982dec)

rm(nc.ORAS.1982jan, nc.ORAS.1982feb, nc.ORAS.1982mar, nc.ORAS.1982apr, nc.ORAS.1982may, nc.ORAS.1982jun, 
                       nc.ORAS.1982jul, nc.ORAS.1982aug, nc.ORAS.1982dec)



##1983
#jan 1983
nc.ORAS.1983jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198301_CONS_v0.1.nc")
#feb 1983
nc.ORAS.1983feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198302_CONS_v0.1.nc")
#mar 1983
nc.ORAS.1983mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198303_CONS_v0.1.nc")
#apr 1983
nc.ORAS.1983apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198304_CONS_v0.1.nc")
#may 1983
nc.ORAS.1983may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198305_CONS_v0.1.nc")
#jun 1983
nc.ORAS.1983jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198306_CONS_v0.1.nc")
#jul 1983
nc.ORAS.1983jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198307_CONS_v0.1.nc")
#aug 1983
nc.ORAS.1983aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198308_CONS_v0.1.nc")
#dec 1983
nc.ORAS.1983dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198312_CONS_v0.1.nc")

nc.ORAS.1983ex <- list(nc.ORAS.1983jan, nc.ORAS.1983feb, nc.ORAS.1983mar, nc.ORAS.1983apr, nc.ORAS.1983may, nc.ORAS.1983jun, 
                       nc.ORAS.1983jul, nc.ORAS.1983aug, nc.ORAS.1983s, nc.ORAS.1983o, nc.ORAS.1983n, nc.ORAS.1983dec)

rm(nc.ORAS.1983jan, nc.ORAS.1983feb, nc.ORAS.1983mar, nc.ORAS.1983apr, nc.ORAS.1983may, nc.ORAS.1983jun, 
                       nc.ORAS.1983jul, nc.ORAS.1983aug, nc.ORAS.1983dec)


##1984
#jan 1984
nc.ORAS.1984jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198401_CONS_v0.1.nc")
#feb 1984
nc.ORAS.1984feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198402_CONS_v0.1.nc")
#mar 1984
nc.ORAS.1984mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198403_CONS_v0.1.nc")
#apr 1984
nc.ORAS.1984apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198404_CONS_v0.1.nc")
#may 1984
nc.ORAS.1984may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198405_CONS_v0.1.nc")
#jun 1984
nc.ORAS.1984jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198406_CONS_v0.1.nc")
#jul 1984
nc.ORAS.1984jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198407_CONS_v0.1.nc")
#aug 1984
nc.ORAS.1984aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198408_CONS_v0.1.nc")
#dec 1984
nc.ORAS.1984dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198412_CONS_v0.1.nc")

nc.ORAS.1984ex <- list(nc.ORAS.1984jan, nc.ORAS.1984feb, nc.ORAS.1984mar, 
                       nc.ORAS.1984apr, nc.ORAS.1984may, nc.ORAS.1984jun, 
                       nc.ORAS.1984jul, nc.ORAS.1984aug, nc.ORAS.1984s, 
                       nc.ORAS.1984o,   nc.ORAS.1984n,   nc.ORAS.1984dec)

rm(nc.ORAS.1984jan, nc.ORAS.1984feb, nc.ORAS.1984mar, 
   nc.ORAS.1984apr, nc.ORAS.1984may, nc.ORAS.1984jun, 
   nc.ORAS.1984jul, nc.ORAS.1984aug, nc.ORAS.1984dec)



##1985
#jan 
nc.ORAS.1985jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198501_CONS_v0.1.nc")
#feb
nc.ORAS.1985feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198502_CONS_v0.1.nc")
#mar
nc.ORAS.1985mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198503_CONS_v0.1.nc")
#apr 
nc.ORAS.1985apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198504_CONS_v0.1.nc")
#may 
nc.ORAS.1985may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198505_CONS_v0.1.nc")
#jun
nc.ORAS.1985jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198506_CONS_v0.1.nc")
#jul
nc.ORAS.1985jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198507_CONS_v0.1.nc")
#aug 
nc.ORAS.1985aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198508_CONS_v0.1.nc")
#dec 
nc.ORAS.1985dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198512_CONS_v0.1.nc")

nc.ORAS.1985ex <- list(nc.ORAS.1985jan, nc.ORAS.1985feb, nc.ORAS.1985mar, 
                       nc.ORAS.1985apr, nc.ORAS.1985may, nc.ORAS.1985jun, 
                       nc.ORAS.1985jul, nc.ORAS.1985aug, nc.ORAS.1985s, 
                       nc.ORAS.1985o,   nc.ORAS.1985n,   nc.ORAS.1985dec)

rm(nc.ORAS.1985jan, nc.ORAS.1985feb, nc.ORAS.1985mar, 
   nc.ORAS.1985apr, nc.ORAS.1985may, nc.ORAS.1985jun, 
   nc.ORAS.1985jul, nc.ORAS.1985aug, nc.ORAS.1985dec)


##1986
#jan 
nc.ORAS.1986jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198601_CONS_v0.1.nc")
#feb
nc.ORAS.1986feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198602_CONS_v0.1.nc")
#mar
nc.ORAS.1986mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198603_CONS_v0.1.nc")
#apr 
nc.ORAS.1986apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198604_CONS_v0.1.nc")
#may 
nc.ORAS.1986may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198605_CONS_v0.1.nc")
#jun
nc.ORAS.1986jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198606_CONS_v0.1.nc")
#jul
nc.ORAS.1986jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198607_CONS_v0.1.nc")
#aug 
nc.ORAS.1986aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198608_CONS_v0.1.nc")
#dec 
nc.ORAS.1986dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198612_CONS_v0.1.nc")

nc.ORAS.1986ex <- list(nc.ORAS.1986jan, nc.ORAS.1986feb, nc.ORAS.1986mar, 
                       nc.ORAS.1986apr, nc.ORAS.1986may, nc.ORAS.1986jun, 
                       nc.ORAS.1986jul, nc.ORAS.1986aug, nc.ORAS.1986s, 
                       nc.ORAS.1986o,   nc.ORAS.1986n,   nc.ORAS.1986dec)

rm(nc.ORAS.1986jan, nc.ORAS.1986feb, nc.ORAS.1986mar, 
   nc.ORAS.1986apr, nc.ORAS.1986may, nc.ORAS.1986jun, 
   nc.ORAS.1986jul, nc.ORAS.1986aug, nc.ORAS.1986dec)



##1987
#jan 
nc.ORAS.1987jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198701_CONS_v0.1.nc")
#feb
nc.ORAS.1987feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198702_CONS_v0.1.nc")
#mar
nc.ORAS.1987mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198703_CONS_v0.1.nc")
#apr 
nc.ORAS.1987apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198704_CONS_v0.1.nc")
#may 
nc.ORAS.1987may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198705_CONS_v0.1.nc")
#jun
nc.ORAS.1987jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198706_CONS_v0.1.nc")
#jul
nc.ORAS.1987jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198707_CONS_v0.1.nc")
#aug 
nc.ORAS.1987aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198708_CONS_v0.1.nc")
#dec 
nc.ORAS.1987dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198712_CONS_v0.1.nc")

nc.ORAS.1987ex <- list(nc.ORAS.1987jan, nc.ORAS.1987feb, nc.ORAS.1987mar, 
                       nc.ORAS.1987apr, nc.ORAS.1987may, nc.ORAS.1987jun, 
                       nc.ORAS.1987jul, nc.ORAS.1987aug, nc.ORAS.1987s, 
                       nc.ORAS.1987o,   nc.ORAS.1987n,   nc.ORAS.1987dec)

rm(nc.ORAS.1987jan, nc.ORAS.1987feb, nc.ORAS.1987mar, 
   nc.ORAS.1987apr, nc.ORAS.1987may, nc.ORAS.1987jun, 
   nc.ORAS.1987jul, nc.ORAS.1987aug, nc.ORAS.1987dec)



##1988
#jan 
nc.ORAS.1988jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198801_CONS_v0.1.nc")
#feb
nc.ORAS.1988feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198802_CONS_v0.1.nc")
#mar
nc.ORAS.1988mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198803_CONS_v0.1.nc")
#apr 
nc.ORAS.1988apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198804_CONS_v0.1.nc")
#may 
nc.ORAS.1988may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198805_CONS_v0.1.nc")
#jun
nc.ORAS.1988jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198806_CONS_v0.1.nc")
#jul
nc.ORAS.1988jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198807_CONS_v0.1.nc")
#aug 
nc.ORAS.1988aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198808_CONS_v0.1.nc")
#dec 
nc.ORAS.1988dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198812_CONS_v0.1.nc")

nc.ORAS.1988ex <- list(nc.ORAS.1988jan, nc.ORAS.1988feb, nc.ORAS.1988mar, 
                       nc.ORAS.1988apr, nc.ORAS.1988may, nc.ORAS.1988jun, 
                       nc.ORAS.1988jul, nc.ORAS.1988aug, nc.ORAS.1988s, 
                       nc.ORAS.1988o,   nc.ORAS.1988n,   nc.ORAS.1988dec)

rm(nc.ORAS.1988jan, nc.ORAS.1988feb, nc.ORAS.1988mar, 
   nc.ORAS.1988apr, nc.ORAS.1988may, nc.ORAS.1988jun, 
   nc.ORAS.1988jul, nc.ORAS.1988aug, nc.ORAS.1988dec)



##1989
#jan 
nc.ORAS.1989jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198901_CONS_v0.1.nc")
#feb
nc.ORAS.1989feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198902_CONS_v0.1.nc")
#mar
nc.ORAS.1989mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198903_CONS_v0.1.nc")
#apr 
nc.ORAS.1989apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198904_CONS_v0.1.nc")
#may 
nc.ORAS.1989may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198905_CONS_v0.1.nc")
#jun
nc.ORAS.1989jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198906_CONS_v0.1.nc")
#jul
nc.ORAS.1989jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198907_CONS_v0.1.nc")
#aug 
nc.ORAS.1989aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198908_CONS_v0.1.nc")
#dec 
nc.ORAS.1989dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198912_CONS_v0.1.nc")

nc.ORAS.1989ex <- list(nc.ORAS.1989jan, nc.ORAS.1989feb, nc.ORAS.1989mar, 
                       nc.ORAS.1989apr, nc.ORAS.1989may, nc.ORAS.1989jun, 
                       nc.ORAS.1989jul, nc.ORAS.1989aug, nc.ORAS.1989s, 
                       nc.ORAS.1989o,   nc.ORAS.1989n,   nc.ORAS.1989dec)

rm(nc.ORAS.1989jan, nc.ORAS.1989feb, nc.ORAS.1989mar, 
   nc.ORAS.1989apr, nc.ORAS.1989may, nc.ORAS.1989jun, 
   nc.ORAS.1989jul, nc.ORAS.1989aug, nc.ORAS.1989dec)


##1990
#jan 
nc.ORAS.1990jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199001_CONS_v0.1.nc")
#feb
nc.ORAS.1990feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199002_CONS_v0.1.nc")
#mar
nc.ORAS.1990mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199003_CONS_v0.1.nc")
#apr 
nc.ORAS.1990apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199004_CONS_v0.1.nc")
#may 
nc.ORAS.1990may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199005_CONS_v0.1.nc")
#jun
nc.ORAS.1990jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199006_CONS_v0.1.nc")
#jul
nc.ORAS.1990jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199007_CONS_v0.1.nc")
#aug 
nc.ORAS.1990aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199008_CONS_v0.1.nc")
#dec
nc.ORAS.1990dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199012_CONS_v0.1.nc")

nc.ORAS.1990ex <- list(nc.ORAS.1990jan, nc.ORAS.1990feb, nc.ORAS.1990mar, 
                       nc.ORAS.1990apr, nc.ORAS.1990may, nc.ORAS.1990jun, 
                       nc.ORAS.1990jul, nc.ORAS.1990aug, nc.ORAS.1990s, 
                       nc.ORAS.1990o,   nc.ORAS.1990n,   nc.ORAS.1990dec)

rm(nc.ORAS.1990jan, nc.ORAS.1990feb, nc.ORAS.1990mar, 
   nc.ORAS.1990apr, nc.ORAS.1990may, nc.ORAS.1990jun, 
   nc.ORAS.1990jul, nc.ORAS.1990aug, nc.ORAS.1990dec)


##1991
#jan 
nc.ORAS.1991jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199101_CONS_v0.1.nc")
#feb
nc.ORAS.1991feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199102_CONS_v0.1.nc")
#mar
nc.ORAS.1991mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199103_CONS_v0.1.nc")
#apr 
nc.ORAS.1991apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199104_CONS_v0.1.nc")
#may 
nc.ORAS.1991may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199105_CONS_v0.1.nc")
#jun
nc.ORAS.1991jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199106_CONS_v0.1.nc")
#jul
nc.ORAS.1991jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199107_CONS_v0.1.nc")
#aug 
nc.ORAS.1991aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199108_CONS_v0.1.nc")
#dec
nc.ORAS.1991dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199112_CONS_v0.1.nc")

nc.ORAS.1991ex <- list(nc.ORAS.1991jan, nc.ORAS.1991feb, nc.ORAS.1991mar, 
                       nc.ORAS.1991apr, nc.ORAS.1991may, nc.ORAS.1991jun, 
                       nc.ORAS.1991jul, nc.ORAS.1991aug, nc.ORAS.1991s, 
                       nc.ORAS.1991o,   nc.ORAS.1991n,   nc.ORAS.1991dec)

rm(nc.ORAS.1991jan, nc.ORAS.1991feb, nc.ORAS.1991mar, 
   nc.ORAS.1991apr, nc.ORAS.1991may, nc.ORAS.1991jun, 
   nc.ORAS.1991jul, nc.ORAS.1991aug, nc.ORAS.1991dec)


##1992
#jan 
nc.ORAS.1992jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199201_CONS_v0.1.nc")
#feb
nc.ORAS.1992feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199202_CONS_v0.1.nc")
#mar
nc.ORAS.1992mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199203_CONS_v0.1.nc")
#apr 
nc.ORAS.1992apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199204_CONS_v0.1.nc")
#may 
nc.ORAS.1992may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199205_CONS_v0.1.nc")
#jun
nc.ORAS.1992jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199206_CONS_v0.1.nc")
#jul
nc.ORAS.1992jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199207_CONS_v0.1.nc")
#aug 
nc.ORAS.1992aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199208_CONS_v0.1.nc")
#dec
nc.ORAS.1992dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199212_CONS_v0.1.nc")

nc.ORAS.1992ex <- list(nc.ORAS.1992jan, nc.ORAS.1992feb, nc.ORAS.1992mar, 
                       nc.ORAS.1992apr, nc.ORAS.1992may, nc.ORAS.1992jun, 
                       nc.ORAS.1992jul, nc.ORAS.1992aug, nc.ORAS.1992s, 
                       nc.ORAS.1992o,   nc.ORAS.1992n,   nc.ORAS.1992dec)

                    rm(nc.ORAS.1992jan, nc.ORAS.1992feb, nc.ORAS.1992mar, 
                       nc.ORAS.1992apr, nc.ORAS.1992may, nc.ORAS.1992jun, 
                       nc.ORAS.1992jul, nc.ORAS.1992aug, nc.ORAS.1992dec)



##1993
#jan 
nc.ORAS.1993jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199301_CONS_v0.1.nc")
#feb
nc.ORAS.1993feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199302_CONS_v0.1.nc")
#mar
nc.ORAS.1993mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199303_CONS_v0.1.nc")
#apr 
nc.ORAS.1993apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199304_CONS_v0.1.nc")
#may 
nc.ORAS.1993may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199305_CONS_v0.1.nc")
#jun
nc.ORAS.1993jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199306_CONS_v0.1.nc")
#jul
nc.ORAS.1993jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199307_CONS_v0.1.nc")
#aug 
nc.ORAS.1993aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199308_CONS_v0.1.nc")
#dec
nc.ORAS.1993dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199312_CONS_v0.1.nc")

nc.ORAS.1993ex <- list(nc.ORAS.1993jan, nc.ORAS.1993feb, nc.ORAS.1993mar, 
                       nc.ORAS.1993apr, nc.ORAS.1993may, nc.ORAS.1993jun, 
                       nc.ORAS.1993jul, nc.ORAS.1993aug, nc.ORAS.1993s, 
                       nc.ORAS.1993o,   nc.ORAS.1993n,   nc.ORAS.1993dec)

                    rm(nc.ORAS.1993jan, nc.ORAS.1993feb, nc.ORAS.1993mar, 
                       nc.ORAS.1993apr, nc.ORAS.1993may, nc.ORAS.1993jun, 
                       nc.ORAS.1993jul, nc.ORAS.1993aug, nc.ORAS.1993dec)
                    
                  
##1994
#jan 
nc.ORAS.1994jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199401_CONS_v0.1.nc")
#feb
nc.ORAS.1994feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199402_CONS_v0.1.nc")
#mar
nc.ORAS.1994mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199403_CONS_v0.1.nc")
#apr 
nc.ORAS.1994apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199404_CONS_v0.1.nc")
#may 
nc.ORAS.1994may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199405_CONS_v0.1.nc")
#jun
nc.ORAS.1994jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199406_CONS_v0.1.nc")
#jul
nc.ORAS.1994jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199407_CONS_v0.1.nc")
#aug 
nc.ORAS.1994aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199408_CONS_v0.1.nc")
#dec
nc.ORAS.1994dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199412_CONS_v0.1.nc")

nc.ORAS.1994ex <- list(nc.ORAS.1994jan, nc.ORAS.1994feb, nc.ORAS.1994mar, 
                       nc.ORAS.1994apr, nc.ORAS.1994may, nc.ORAS.1994jun, 
                       nc.ORAS.1994jul, nc.ORAS.1994aug, nc.ORAS.1994s, 
                       nc.ORAS.1994o,   nc.ORAS.1994n,   nc.ORAS.1994dec)

                    rm(nc.ORAS.1994jan, nc.ORAS.1994feb, nc.ORAS.1994mar, 
                       nc.ORAS.1994apr, nc.ORAS.1994may, nc.ORAS.1994jun, 
                       nc.ORAS.1994jul, nc.ORAS.1994aug, nc.ORAS.1994dec)

                    
##1995
#jan 
nc.ORAS.1995jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199501_CONS_v0.1.nc")
#feb
nc.ORAS.1995feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199502_CONS_v0.1.nc")
#mar
nc.ORAS.1995mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199503_CONS_v0.1.nc")
#apr 
nc.ORAS.1995apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199504_CONS_v0.1.nc")
#may 
nc.ORAS.1995may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199505_CONS_v0.1.nc")
#jun
nc.ORAS.1995jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199506_CONS_v0.1.nc")
#jul
nc.ORAS.1995jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199507_CONS_v0.1.nc")
#aug 
nc.ORAS.1995aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199508_CONS_v0.1.nc")
#dec
nc.ORAS.1995dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199512_CONS_v0.1.nc")

nc.ORAS.1995ex <- list(nc.ORAS.1995jan, nc.ORAS.1995feb, nc.ORAS.1995mar, 
                       nc.ORAS.1995apr, nc.ORAS.1995may, nc.ORAS.1995jun, 
                       nc.ORAS.1995jul, nc.ORAS.1995aug, nc.ORAS.1995s, 
                       nc.ORAS.1995o,   nc.ORAS.1995n,   nc.ORAS.1995dec)

                    rm(nc.ORAS.1995jan, nc.ORAS.1995feb, nc.ORAS.1995mar, 
                       nc.ORAS.1995apr, nc.ORAS.1995may, nc.ORAS.1995jun, 
                       nc.ORAS.1995jul, nc.ORAS.1995aug, nc.ORAS.1995dec)
                    
##1996
#jan 
nc.ORAS.1996jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199601_CONS_v0.1.nc")
#feb
nc.ORAS.1996feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199602_CONS_v0.1.nc")
#mar
nc.ORAS.1996mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199603_CONS_v0.1.nc")
#apr 
nc.ORAS.1996apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199604_CONS_v0.1.nc")
#may 
nc.ORAS.1996may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199605_CONS_v0.1.nc")
#jun
nc.ORAS.1996jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199606_CONS_v0.1.nc")
#jul
nc.ORAS.1996jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199607_CONS_v0.1.nc")
#aug 
nc.ORAS.1996aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199608_CONS_v0.1.nc")
#dec
nc.ORAS.1996dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199612_CONS_v0.1.nc")

nc.ORAS.1996ex <- list(nc.ORAS.1996jan, nc.ORAS.1996feb, nc.ORAS.1996mar, 
                       nc.ORAS.1996apr, nc.ORAS.1996may, nc.ORAS.1996jun, 
                       nc.ORAS.1996jul, nc.ORAS.1996aug, nc.ORAS.1996s, 
                       nc.ORAS.1996o,   nc.ORAS.1996n,   nc.ORAS.1996dec)

                    rm(nc.ORAS.1996jan, nc.ORAS.1996feb, nc.ORAS.1996mar, 
                       nc.ORAS.1996apr, nc.ORAS.1996may, nc.ORAS.1996jun, 
                       nc.ORAS.1996jul, nc.ORAS.1996aug, nc.ORAS.1996dec)      

##1997
#jan 
nc.ORAS.1997jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199701_CONS_v0.1.nc")
#feb
nc.ORAS.1997feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199702_CONS_v0.1.nc")
#mar
nc.ORAS.1997mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199703_CONS_v0.1.nc")
#apr 
nc.ORAS.1997apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199704_CONS_v0.1.nc")
#may 
nc.ORAS.1997may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199705_CONS_v0.1.nc")
#jun
nc.ORAS.1997jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199706_CONS_v0.1.nc")
#jul
nc.ORAS.1997jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199707_CONS_v0.1.nc")
#aug 
nc.ORAS.1997aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199708_CONS_v0.1.nc")
#dec
nc.ORAS.1997dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199712_CONS_v0.1.nc")

nc.ORAS.1997ex <- list(nc.ORAS.1997jan, nc.ORAS.1997feb, nc.ORAS.1997mar, 
                       nc.ORAS.1997apr, nc.ORAS.1997may, nc.ORAS.1997jun, 
                       nc.ORAS.1997jul, nc.ORAS.1997aug, nc.ORAS.1997s, 
                       nc.ORAS.1997o,   nc.ORAS.1997n,   nc.ORAS.1997dec)

                    rm(nc.ORAS.1997jan, nc.ORAS.1997feb, nc.ORAS.1997mar, 
                       nc.ORAS.1997apr, nc.ORAS.1997may, nc.ORAS.1997jun, 
                       nc.ORAS.1997jul, nc.ORAS.1997aug, nc.ORAS.1997dec) 
                    
#
##1998
#jan 
nc.ORAS.1998jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199801_CONS_v0.1.nc")
#feb
nc.ORAS.1998feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199802_CONS_v0.1.nc")
#mar
nc.ORAS.1998mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199803_CONS_v0.1.nc")
#apr 
nc.ORAS.1998apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199804_CONS_v0.1.nc")
#may 
nc.ORAS.1998may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199805_CONS_v0.1.nc")
#jun
nc.ORAS.1998jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199806_CONS_v0.1.nc")
#jul
nc.ORAS.1998jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199807_CONS_v0.1.nc")
#aug 
nc.ORAS.1998aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199808_CONS_v0.1.nc")
#dec
nc.ORAS.1998dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199812_CONS_v0.1.nc")

nc.ORAS.1998ex <- list(nc.ORAS.1998jan, nc.ORAS.1998feb, nc.ORAS.1998mar, 
                       nc.ORAS.1998apr, nc.ORAS.1998may, nc.ORAS.1998jun, 
                       nc.ORAS.1998jul, nc.ORAS.1998aug, nc.ORAS.1998s, 
                       nc.ORAS.1998o,   nc.ORAS.1998n,   nc.ORAS.1998dec)

                    rm(nc.ORAS.1998jan, nc.ORAS.1998feb, nc.ORAS.1998mar, 
                       nc.ORAS.1998apr, nc.ORAS.1998may, nc.ORAS.1998jun, 
                       nc.ORAS.1998jul, nc.ORAS.1998aug, nc.ORAS.1998dec)
 
##1999
#jan 
nc.ORAS.1999jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199901_CONS_v0.1.nc")
#feb
nc.ORAS.1999feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199902_CONS_v0.1.nc")
#mar
nc.ORAS.1999mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199903_CONS_v0.1.nc")
#apr 
nc.ORAS.1999apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199904_CONS_v0.1.nc")
#may 
nc.ORAS.1999may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199905_CONS_v0.1.nc")
#jun
nc.ORAS.1999jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199906_CONS_v0.1.nc")
#jul
nc.ORAS.1999jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199907_CONS_v0.1.nc")
#aug 
nc.ORAS.1999aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199908_CONS_v0.1.nc")
#dec
nc.ORAS.1999dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199912_CONS_v0.1.nc")

nc.ORAS.1999ex <- list(nc.ORAS.1999jan, nc.ORAS.1999feb, nc.ORAS.1999mar, 
                       nc.ORAS.1999apr, nc.ORAS.1999may, nc.ORAS.1999jun, 
                       nc.ORAS.1999jul, nc.ORAS.1999aug, nc.ORAS.1999s, 
                       nc.ORAS.1999o,   nc.ORAS.1999n,   nc.ORAS.1999dec)

                    rm(nc.ORAS.1999jan, nc.ORAS.1999feb, nc.ORAS.1999mar, 
                       nc.ORAS.1999apr, nc.ORAS.1999may, nc.ORAS.1999jun, 
                       nc.ORAS.1999jul, nc.ORAS.1999aug, nc.ORAS.1999dec) 
                    
##2000
#jan 
nc.ORAS.2000jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200001_CONS_v0.1.nc")
#feb
nc.ORAS.2000feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200002_CONS_v0.1.nc")
#mar
nc.ORAS.2000mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200003_CONS_v0.1.nc")
#apr 
nc.ORAS.2000apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200004_CONS_v0.1.nc")
#may 
nc.ORAS.2000may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200005_CONS_v0.1.nc")
#jun
nc.ORAS.2000jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200006_CONS_v0.1.nc")
#jul
nc.ORAS.2000jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200007_CONS_v0.1.nc")
#aug 
nc.ORAS.2000aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200008_CONS_v0.1.nc")
#dec
nc.ORAS.2000dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200012_CONS_v0.1.nc")

nc.ORAS.2000ex <- list(nc.ORAS.2000jan, nc.ORAS.2000feb, nc.ORAS.2000mar, 
                       nc.ORAS.2000apr, nc.ORAS.2000may, nc.ORAS.2000jun, 
                       nc.ORAS.2000jul, nc.ORAS.2000aug, nc.ORAS.2000s, 
                       nc.ORAS.2000o,   nc.ORAS.2000n,   nc.ORAS.2000dec)

                    rm(nc.ORAS.2000jan, nc.ORAS.2000feb, nc.ORAS.2000mar, 
                       nc.ORAS.2000apr, nc.ORAS.2000may, nc.ORAS.2000jun, 
                       nc.ORAS.2000jul, nc.ORAS.2000aug, nc.ORAS.2000dec)                     

                    
##2001
#jan 
nc.ORAS.2001jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200101_CONS_v0.1.nc")
#feb
nc.ORAS.2001feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200102_CONS_v0.1.nc")
#mar
nc.ORAS.2001mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200103_CONS_v0.1.nc")
#apr 
nc.ORAS.2001apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200104_CONS_v0.1.nc")
#may 
nc.ORAS.2001may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200105_CONS_v0.1.nc")
#jun
nc.ORAS.2001jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200106_CONS_v0.1.nc")
#jul
nc.ORAS.2001jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200107_CONS_v0.1.nc")
#aug 
nc.ORAS.2001aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200108_CONS_v0.1.nc")
#dec
nc.ORAS.2001dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200112_CONS_v0.1.nc")

nc.ORAS.2001ex <- list(nc.ORAS.2001jan, nc.ORAS.2001feb, nc.ORAS.2001mar, 
                       nc.ORAS.2001apr, nc.ORAS.2001may, nc.ORAS.2001jun, 
                       nc.ORAS.2001jul, nc.ORAS.2001aug, nc.ORAS.2001s, 
                       nc.ORAS.2001o,   nc.ORAS.2001n,   nc.ORAS.2001dec)

                    rm(nc.ORAS.2001jan, nc.ORAS.2001feb, nc.ORAS.2001mar, 
                       nc.ORAS.2001apr, nc.ORAS.2001may, nc.ORAS.2001jun, 
                       nc.ORAS.2001jul, nc.ORAS.2001aug, nc.ORAS.2001dec)                      
                    
##2002
#jan 
nc.ORAS.2002jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200201_CONS_v0.1.nc")
#feb
nc.ORAS.2002feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200202_CONS_v0.1.nc")
#mar
nc.ORAS.2002mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200203_CONS_v0.1.nc")
#apr 
nc.ORAS.2002apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200204_CONS_v0.1.nc")
#may 
nc.ORAS.2002may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200205_CONS_v0.1.nc")
#jun
nc.ORAS.2002jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200206_CONS_v0.1.nc")
#jul
nc.ORAS.2002jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200207_CONS_v0.1.nc")
#aug 
nc.ORAS.2002aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200208_CONS_v0.1.nc")
#dec
nc.ORAS.2002dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200212_CONS_v0.1.nc")

nc.ORAS.2002ex <- list(nc.ORAS.2002jan, nc.ORAS.2002feb, nc.ORAS.2002mar, 
                       nc.ORAS.2002apr, nc.ORAS.2002may, nc.ORAS.2002jun, 
                       nc.ORAS.2002jul, nc.ORAS.2002aug, nc.ORAS.2002s, 
                       nc.ORAS.2002o,   nc.ORAS.2002n,   nc.ORAS.2002dec)

                    rm(nc.ORAS.2002jan, nc.ORAS.2002feb, nc.ORAS.2002mar, 
                       nc.ORAS.2002apr, nc.ORAS.2002may, nc.ORAS.2002jun, 
                       nc.ORAS.2002jul, nc.ORAS.2002aug, nc.ORAS.2002dec)                      
                                 
##2003
#jan 
nc.ORAS.2003jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200301_CONS_v0.1.nc")
#feb
nc.ORAS.2003feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200302_CONS_v0.1.nc")
#mar
nc.ORAS.2003mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200303_CONS_v0.1.nc")
#apr 
nc.ORAS.2003apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200304_CONS_v0.1.nc")
#may 
nc.ORAS.2003may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200305_CONS_v0.1.nc")
#jun
nc.ORAS.2003jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200306_CONS_v0.1.nc")
#jul
nc.ORAS.2003jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200307_CONS_v0.1.nc")
#aug 
nc.ORAS.2003aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200308_CONS_v0.1.nc")
#dec
nc.ORAS.2003dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200312_CONS_v0.1.nc")

nc.ORAS.2003ex <- list(nc.ORAS.2003jan, nc.ORAS.2003feb, nc.ORAS.2003mar, 
                       nc.ORAS.2003apr, nc.ORAS.2003may, nc.ORAS.2003jun, 
                       nc.ORAS.2003jul, nc.ORAS.2003aug, nc.ORAS.2003s, 
                       nc.ORAS.2003o,   nc.ORAS.2003n,   nc.ORAS.2003dec)

                    rm(nc.ORAS.2003jan, nc.ORAS.2003feb, nc.ORAS.2003mar, 
                       nc.ORAS.2003apr, nc.ORAS.2003may, nc.ORAS.2003jun, 
                       nc.ORAS.2003jul, nc.ORAS.2003aug, nc.ORAS.2003dec)                      
 
                    
##2004
#jan 
nc.ORAS.2004jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200401_CONS_v0.1.nc")
#feb
nc.ORAS.2004feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200402_CONS_v0.1.nc")
#mar
nc.ORAS.2004mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200403_CONS_v0.1.nc")
#apr 
nc.ORAS.2004apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200404_CONS_v0.1.nc")
#may 
nc.ORAS.2004may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200405_CONS_v0.1.nc")
#jun
nc.ORAS.2004jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200406_CONS_v0.1.nc")
#jul
nc.ORAS.2004jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200407_CONS_v0.1.nc")
#aug 
nc.ORAS.2004aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200408_CONS_v0.1.nc")
#dec
nc.ORAS.2004dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200412_CONS_v0.1.nc")

nc.ORAS.2004ex <- list(nc.ORAS.2004jan, nc.ORAS.2004feb, nc.ORAS.2004mar, 
                       nc.ORAS.2004apr, nc.ORAS.2004may, nc.ORAS.2004jun, 
                       nc.ORAS.2004jul, nc.ORAS.2004aug, nc.ORAS.2004s, 
                       nc.ORAS.2004o,   nc.ORAS.2004n,   nc.ORAS.2004dec)

                    rm(nc.ORAS.2004jan, nc.ORAS.2004feb, nc.ORAS.2004mar, 
                       nc.ORAS.2004apr, nc.ORAS.2004may, nc.ORAS.2004jun, 
                       nc.ORAS.2004jul, nc.ORAS.2004aug, nc.ORAS.2004dec)                      
                     
##2005
#jan 
nc.ORAS.2005jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200501_CONS_v0.1.nc")
#feb
nc.ORAS.2005feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200502_CONS_v0.1.nc")
#mar
nc.ORAS.2005mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200503_CONS_v0.1.nc")
#apr 
nc.ORAS.2005apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200504_CONS_v0.1.nc")
#may 
nc.ORAS.2005may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200505_CONS_v0.1.nc")
#jun
nc.ORAS.2005jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200506_CONS_v0.1.nc")
#jul
nc.ORAS.2005jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200507_CONS_v0.1.nc")
#aug 
nc.ORAS.2005aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200508_CONS_v0.1.nc")
#dec
nc.ORAS.2005dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200512_CONS_v0.1.nc")

nc.ORAS.2005ex <- list(nc.ORAS.2005jan, nc.ORAS.2005feb, nc.ORAS.2005mar, 
                       nc.ORAS.2005apr, nc.ORAS.2005may, nc.ORAS.2005jun, 
                       nc.ORAS.2005jul, nc.ORAS.2005aug, nc.ORAS.2005s, 
                       nc.ORAS.2005o,   nc.ORAS.2005n,   nc.ORAS.2005dec)

                    rm(nc.ORAS.2005jan, nc.ORAS.2005feb, nc.ORAS.2005mar, 
                       nc.ORAS.2005apr, nc.ORAS.2005may, nc.ORAS.2005jun, 
                       nc.ORAS.2005jul, nc.ORAS.2005aug, nc.ORAS.2005dec)                    
                    
##2006
#jan 
nc.ORAS.2006jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200601_CONS_v0.1.nc")
#feb
nc.ORAS.2006feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200602_CONS_v0.1.nc")
#mar
nc.ORAS.2006mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200603_CONS_v0.1.nc")
#apr 
nc.ORAS.2006apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200604_CONS_v0.1.nc")
#may 
nc.ORAS.2006may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200605_CONS_v0.1.nc")
#jun
nc.ORAS.2006jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200606_CONS_v0.1.nc")
#jul
nc.ORAS.2006jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200607_CONS_v0.1.nc")
#aug 
nc.ORAS.2006aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200608_CONS_v0.1.nc")
#dec
nc.ORAS.2006dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200612_CONS_v0.1.nc")

nc.ORAS.2006ex <- list(nc.ORAS.2006jan, nc.ORAS.2006feb, nc.ORAS.2006mar, 
                       nc.ORAS.2006apr, nc.ORAS.2006may, nc.ORAS.2006jun, 
                       nc.ORAS.2006jul, nc.ORAS.2006aug, nc.ORAS.2006s, 
                       nc.ORAS.2006o,   nc.ORAS.2006n,   nc.ORAS.2006dec)

                    rm(nc.ORAS.2006jan, nc.ORAS.2006feb, nc.ORAS.2006mar, 
                       nc.ORAS.2006apr, nc.ORAS.2006may, nc.ORAS.2006jun, 
                       nc.ORAS.2006jul, nc.ORAS.2006aug, nc.ORAS.2006dec)                    
                    
##2007
#jan 
nc.ORAS.2007jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200701_CONS_v0.1.nc")
#feb
nc.ORAS.2007feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200702_CONS_v0.1.nc")
#mar
nc.ORAS.2007mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200703_CONS_v0.1.nc")
#apr 
nc.ORAS.2007apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200704_CONS_v0.1.nc")
#may 
nc.ORAS.2007may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200705_CONS_v0.1.nc")
#jun
nc.ORAS.2007jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200706_CONS_v0.1.nc")
#jul
nc.ORAS.2007jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200707_CONS_v0.1.nc")
#aug 
nc.ORAS.2007aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200708_CONS_v0.1.nc")
#dec
nc.ORAS.2007dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200712_CONS_v0.1.nc")

nc.ORAS.2007ex <- list(nc.ORAS.2007jan, nc.ORAS.2007feb, nc.ORAS.2007mar, 
                       nc.ORAS.2007apr, nc.ORAS.2007may, nc.ORAS.2007jun, 
                       nc.ORAS.2007jul, nc.ORAS.2007aug, nc.ORAS.2007s, 
                       nc.ORAS.2007o,   nc.ORAS.2007n,   nc.ORAS.2007dec)

                    rm(nc.ORAS.2007jan, nc.ORAS.2007feb, nc.ORAS.2007mar, 
                       nc.ORAS.2007apr, nc.ORAS.2007may, nc.ORAS.2007jun, 
                       nc.ORAS.2007jul, nc.ORAS.2007aug, nc.ORAS.2007dec)
                    
##2008
#jan 
nc.ORAS.2008jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200801_CONS_v0.1.nc")
#feb
nc.ORAS.2008feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200802_CONS_v0.1.nc")
#mar
nc.ORAS.2008mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200803_CONS_v0.1.nc")
#apr 
nc.ORAS.2008apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200804_CONS_v0.1.nc")
#may 
nc.ORAS.2008may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200805_CONS_v0.1.nc")
#jun
nc.ORAS.2008jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200806_CONS_v0.1.nc")
#jul
nc.ORAS.2008jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200807_CONS_v0.1.nc")
#aug 
nc.ORAS.2008aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200808_CONS_v0.1.nc")
#dec
nc.ORAS.2008dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200812_CONS_v0.1.nc")

nc.ORAS.2008ex <- list(nc.ORAS.2008jan, nc.ORAS.2008feb, nc.ORAS.2008mar, 
                       nc.ORAS.2008apr, nc.ORAS.2008may, nc.ORAS.2008jun, 
                       nc.ORAS.2008jul, nc.ORAS.2008aug, nc.ORAS.2008s, 
                       nc.ORAS.2008o,   nc.ORAS.2008n,   nc.ORAS.2008dec)

                    rm(nc.ORAS.2008jan, nc.ORAS.2008feb, nc.ORAS.2008mar, 
                       nc.ORAS.2008apr, nc.ORAS.2008may, nc.ORAS.2008jun, 
                       nc.ORAS.2008jul, nc.ORAS.2008aug, nc.ORAS.2008dec)                    
    
                    
##2009
#jan 
nc.ORAS.2009jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200901_CONS_v0.1.nc")
#feb
nc.ORAS.2009feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200902_CONS_v0.1.nc")
#mar
nc.ORAS.2009mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200903_CONS_v0.1.nc")
#apr 
nc.ORAS.2009apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200904_CONS_v0.1.nc")
#may 
nc.ORAS.2009may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200905_CONS_v0.1.nc")
#jun
nc.ORAS.2009jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200906_CONS_v0.1.nc")
#jul
nc.ORAS.2009jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200907_CONS_v0.1.nc")
#aug 
nc.ORAS.2009aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200908_CONS_v0.1.nc")
#dec
nc.ORAS.2009dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200912_CONS_v0.1.nc")

nc.ORAS.2009ex <- list(nc.ORAS.2009jan, nc.ORAS.2009feb, nc.ORAS.2009mar, 
                       nc.ORAS.2009apr, nc.ORAS.2009may, nc.ORAS.2009jun, 
                       nc.ORAS.2009jul, nc.ORAS.2009aug, nc.ORAS.2009s, 
                       nc.ORAS.2009o,   nc.ORAS.2009n,   nc.ORAS.2009dec)

                    rm(nc.ORAS.2009jan, nc.ORAS.2009feb, nc.ORAS.2009mar, 
                       nc.ORAS.2009apr, nc.ORAS.2009may, nc.ORAS.2009jun, 
                       nc.ORAS.2009jul, nc.ORAS.2009aug, nc.ORAS.2009dec)                       
                    
##2010
#jan 
nc.ORAS.2010jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201001_CONS_v0.1.nc")
#feb
nc.ORAS.2010feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201002_CONS_v0.1.nc")
#mar
nc.ORAS.2010mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201003_CONS_v0.1.nc")
#apr 
nc.ORAS.2010apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201004_CONS_v0.1.nc")
#may 
nc.ORAS.2010may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201005_CONS_v0.1.nc")
#jun
nc.ORAS.2010jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201006_CONS_v0.1.nc")
#jul
nc.ORAS.2010jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201007_CONS_v0.1.nc")
#aug 
nc.ORAS.2010aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201008_CONS_v0.1.nc")
#dec
nc.ORAS.2010dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201012_CONS_v0.1.nc")

nc.ORAS.2010ex <- list(nc.ORAS.2010jan, nc.ORAS.2010feb, nc.ORAS.2010mar, 
                       nc.ORAS.2010apr, nc.ORAS.2010may, nc.ORAS.2010jun, 
                       nc.ORAS.2010jul, nc.ORAS.2010aug, nc.ORAS.2010s, 
                       nc.ORAS.2010o,   nc.ORAS.2010n,   nc.ORAS.2010dec)

                    rm(nc.ORAS.2010jan, nc.ORAS.2010feb, nc.ORAS.2010mar, 
                       nc.ORAS.2010apr, nc.ORAS.2010may, nc.ORAS.2010jun, 
                       nc.ORAS.2010jul, nc.ORAS.2010aug, nc.ORAS.2010dec) 
                    
##2011
#jan 
nc.ORAS.2011jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201101_CONS_v0.1.nc")
#feb
nc.ORAS.2011feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201102_CONS_v0.1.nc")
#mar
nc.ORAS.2011mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201103_CONS_v0.1.nc")
#apr 
nc.ORAS.2011apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201104_CONS_v0.1.nc")
#may 
nc.ORAS.2011may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201105_CONS_v0.1.nc")
#jun
nc.ORAS.2011jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201106_CONS_v0.1.nc")
#jul
nc.ORAS.2011jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201107_CONS_v0.1.nc")
#aug 
nc.ORAS.2011aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201108_CONS_v0.1.nc")
#dec
nc.ORAS.2011dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201112_CONS_v0.1.nc")

nc.ORAS.2011ex <- list(nc.ORAS.2011jan, nc.ORAS.2011feb, nc.ORAS.2011mar, 
                       nc.ORAS.2011apr, nc.ORAS.2011may, nc.ORAS.2011jun, 
                       nc.ORAS.2011jul, nc.ORAS.2011aug, nc.ORAS.2011s, 
                       nc.ORAS.2011o,   nc.ORAS.2011n,   nc.ORAS.2011dec)

                    rm(nc.ORAS.2011jan, nc.ORAS.2011feb, nc.ORAS.2011mar, 
                       nc.ORAS.2011apr, nc.ORAS.2011may, nc.ORAS.2011jun, 
                       nc.ORAS.2011jul, nc.ORAS.2011aug, nc.ORAS.2011dec) 

##2012
#jan 
nc.ORAS.2012jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201201_CONS_v0.1.nc")
#feb
nc.ORAS.2012feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201202_CONS_v0.1.nc")
#mar
nc.ORAS.2012mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201203_CONS_v0.1.nc")
#apr 
nc.ORAS.2012apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201204_CONS_v0.1.nc")
#may 
nc.ORAS.2012may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201205_CONS_v0.1.nc")
#jun
nc.ORAS.2012jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201206_CONS_v0.1.nc")
#jul
nc.ORAS.2012jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201207_CONS_v0.1.nc")
#aug 
nc.ORAS.2012aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201208_CONS_v0.1.nc")
#dec
nc.ORAS.2012dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201212_CONS_v0.1.nc")

nc.ORAS.2012ex <- list(nc.ORAS.2012jan, nc.ORAS.2012feb, nc.ORAS.2012mar, 
                       nc.ORAS.2012apr, nc.ORAS.2012may, nc.ORAS.2012jun, 
                       nc.ORAS.2012jul, nc.ORAS.2012aug, nc.ORAS.2012s, 
                       nc.ORAS.2012o,   nc.ORAS.2012n,   nc.ORAS.2012dec)

                    rm(nc.ORAS.2012jan, nc.ORAS.2012feb, nc.ORAS.2012mar, 
                       nc.ORAS.2012apr, nc.ORAS.2012may, nc.ORAS.2012jun, 
                       nc.ORAS.2012jul, nc.ORAS.2012aug, nc.ORAS.2012dec)                                                                  
                    
##2013
#jan 
nc.ORAS.2013jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201301_CONS_v0.1.nc")
#feb
nc.ORAS.2013feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201302_CONS_v0.1.nc")
#mar
nc.ORAS.2013mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201303_CONS_v0.1.nc")
#apr 
nc.ORAS.2013apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201304_CONS_v0.1.nc")
#may 
nc.ORAS.2013may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201305_CONS_v0.1.nc")
#jun
nc.ORAS.2013jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201306_CONS_v0.1.nc")
#jul
nc.ORAS.2013jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201307_CONS_v0.1.nc")
#aug 
nc.ORAS.2013aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201308_CONS_v0.1.nc")
#dec
nc.ORAS.2013dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201312_CONS_v0.1.nc")

nc.ORAS.2013ex <- list(nc.ORAS.2013jan, nc.ORAS.2013feb, nc.ORAS.2013mar, 
                       nc.ORAS.2013apr, nc.ORAS.2013may, nc.ORAS.2013jun, 
                       nc.ORAS.2013jul, nc.ORAS.2013aug, nc.ORAS.2013s, 
                       nc.ORAS.2013o,   nc.ORAS.2013n,   nc.ORAS.2013dec)

                    rm(nc.ORAS.2013jan, nc.ORAS.2013feb, nc.ORAS.2013mar, 
                       nc.ORAS.2013apr, nc.ORAS.2013may, nc.ORAS.2013jun, 
                       nc.ORAS.2013jul, nc.ORAS.2013aug, nc.ORAS.2013dec)                    
                    
##2014
#jan 
nc.ORAS.2014jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201401_CONS_v0.1.nc")
#feb
nc.ORAS.2014feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201402_CONS_v0.1.nc")
#mar
nc.ORAS.2014mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201403_CONS_v0.1.nc")
#apr 
nc.ORAS.2014apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201404_CONS_v0.1.nc")
#may 
nc.ORAS.2014may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201405_CONS_v0.1.nc")
#jun
nc.ORAS.2014jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201406_CONS_v0.1.nc")
#jul
nc.ORAS.2014jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201407_CONS_v0.1.nc")
#aug 
nc.ORAS.2014aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201408_CONS_v0.1.nc")
#dec
nc.ORAS.2014dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201412_CONS_v0.1.nc")

nc.ORAS.2014ex <- list(nc.ORAS.2014jan, nc.ORAS.2014feb, nc.ORAS.2014mar, 
                       nc.ORAS.2014apr, nc.ORAS.2014may, nc.ORAS.2014jun, 
                       nc.ORAS.2014jul, nc.ORAS.2014aug, nc.ORAS.2014s, 
                       nc.ORAS.2014o,   nc.ORAS.2014n,   nc.ORAS.2014dec)

                    rm(nc.ORAS.2014jan, nc.ORAS.2014feb, nc.ORAS.2014mar, 
                       nc.ORAS.2014apr, nc.ORAS.2014may, nc.ORAS.2014jun, 
                       nc.ORAS.2014jul, nc.ORAS.2014aug, nc.ORAS.2014dec)                     

##2015
#jan 
nc.ORAS.2015jan <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201501_OPER_v0.1.nc")
#feb
nc.ORAS.2015feb <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201502_OPER_v0.1.nc")
#mar
nc.ORAS.2015mar <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201503_OPER_v0.1.nc")
#apr 
nc.ORAS.2015apr <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201504_OPER_v0.1.nc")
#may 
nc.ORAS.2015may <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201505_OPER_v0.1.nc")
#jun
nc.ORAS.2015jun <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201506_OPER_v0.1.nc")
#jul
nc.ORAS.2015jul <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201507_OPER_v0.1.nc")
#aug 
nc.ORAS.2015aug <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201508_OPER_v0.1.nc")
#dec
nc.ORAS.2015dec <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201512_OPER_v0.1.nc")

nc.ORAS.2015ex <- list(nc.ORAS.2015jan, nc.ORAS.2015feb, nc.ORAS.2015mar, 
                       nc.ORAS.2015apr, nc.ORAS.2015may, nc.ORAS.2015jun, 
                       nc.ORAS.2015jul, nc.ORAS.2015aug, nc.ORAS.2015s, 
                       nc.ORAS.2015o,   nc.ORAS.2015n,   nc.ORAS.2015dec)

                    rm(nc.ORAS.2015jan, nc.ORAS.2015feb, nc.ORAS.2015mar, 
                       nc.ORAS.2015apr, nc.ORAS.2015may, nc.ORAS.2015jun, 
                       nc.ORAS.2015jul, nc.ORAS.2015aug, nc.ORAS.2015dec)                        
                                        
```

```{r organize_orasdata}
oras.full <- c(nc.ORAS.1982ex, nc.ORAS.1983ex, nc.ORAS.1984ex, nc.ORAS.1985ex, nc.ORAS.1986ex, nc.ORAS.1987ex, nc.ORAS.1988ex,
               nc.ORAS.1989ex, nc.ORAS.1990ex, nc.ORAS.1991ex, nc.ORAS.1992ex, nc.ORAS.1993ex, nc.ORAS.1994ex, nc.ORAS.1995ex, 
               nc.ORAS.1996ex, nc.ORAS.1997ex, nc.ORAS.1998ex, nc.ORAS.1999ex, nc.ORAS.2000ex, nc.ORAS.2001ex, nc.ORAS.2002ex,
               nc.ORAS.2003ex, nc.ORAS.2004ex, nc.ORAS.2005ex, nc.ORAS.2006ex, nc.ORAS.2007ex, nc.ORAS.2008ex, nc.ORAS.2009ex,
               nc.ORAS.2010ex, nc.ORAS.2011ex, nc.ORAS.2012ex, nc.ORAS.2013ex, nc.ORAS.2014ex, nc.ORAS.2015ex)
```


## ORA-S5 Functions

```{r oras_functions}
array_setup <- function(nc.data, wide.lon, wide.lat){

  #lon/lat matrices [nx, ny] ([lon, lat])
  get.lat <- ncvar_get(nc.data, "nav_lat")
  get.lon <- ncvar_get(nc.data, "nav_lon")
  
  #get sst data
  sst.oras <- ncvar_get(nc.data, "sosstsst")
  
  iod.mask <- get.lat >= wide.lat[1] & get.lat <= wide.lat[2] &
          get.lon >= wide.lon[1] & get.lon <= wide.lon[2]
  
  lat.in <- get.lat[iod.mask]
  lon.in <- get.lon[iod.mask]
  sst.oras.in <- sst.oras[iod.mask]
  
  return(list(lon = lon.in,
              lat = lat.in,
              sst = sst.oras.in))
}


reformat_interpolate <- function(lon.in, lat.in, sst.oras.in, 
                                 grid.list){
  #TODO: adjust raw numbers if needed
  #reformat 
  n <- length(lon.in) /363
  
  seq.list <- split(1:59169, ceiling(seq_along(1:59169) / 363))
  
  #take chunk of 363 reorder, and remove duplicate data manually
  new.order <- c(191:363, 3:190)
  
  #TODO: setup additional matrix just for the sst data
  sst.mat <- matrix(NA, ncol = 3)
  colnames(sst.mat) < c("lon", "lat", "sst")
  for (i in 1:n) {
    lon.temp <- lon.in[seq.list[[i]]]
    lat.temp <- lat.in[seq.list[[i]]]
    sst.temp <- sst.oras.in[seq.list[[i]]]
    
    #temporary matrix setup
    temp.mat <- cbind(lon = lon.temp[new.order], 
                      lat = lat.temp[new.order], 
                      sst = sst.temp[new.order])
    
    sst.mat <- rbind(sst.mat, temp.mat)
  }
  
  sst.df <- as.data.frame(sst.mat[-1,])
  
  get.x <- unique(sst.df$lon)
  get.y <- unique(sst.df$lat)
  
  sst.oras.matrix <- matrix(sst.df$sst, nrow = 361)
  
  #interpolate

  obj.oras <- list(x = get.x, y = get.y, z = sst.oras.matrix)
  
  out.interp <- interp.surface.grid(obj.oras, grid.list) #not currently working (duplicated data)

  return(out.interp$z)
}



reformat_oras <- function(lon.in, lat.in, sst.oras.in){
  
  #TODO: adjust raw numbers if needed
  #reformat 
  n <- length(lon.in) /363
  
  seq.list <- split(1:59169, ceiling(seq_along(1:59169) / 363))
  
  #take chunk of 363 reorder, and remove duplicate data manually
  new.order <- c(191:363, 3:190)
  
  #TODO: setup additional matrix just for the sst data
  sst.mat <- matrix(NA, ncol = 3)
  colnames(sst.mat) < c("lon", "lat", "sst")
  for (i in 1:n) {
    lon.temp <- lon.in[seq.list[[i]]]
    lat.temp <- lat.in[seq.list[[i]]]
    sst.temp <- sst.oras.in[seq.list[[i]]]
    
    #temporary matrix setup
    temp.mat <- cbind(lon = lon.temp[new.order], 
                      lat = lat.temp[new.order], 
                      sst = sst.temp[new.order])
    
    sst.mat <- rbind(sst.mat, temp.mat)
  }
  
  sst.df <- as.data.frame(sst.mat[-1,])
  
  sst.oras.matrix <- matrix(sst.df$sst, nrow = 361)
  
  get.x <- unique(sst.df$lon)
  get.y <- unique(sst.df$lat)
  

  return(list(lon = get.x,
              lat = get.y, 
              sst = sst.oras.matrix))
}

```

## ORA-S5 Data Setup

```{r data_clean}

#wide, reduced boundary (Indian Ocean) setup
wide.lon <- c(wide_minLon, wide_maxLon)
wide.lat <- c(wide_minLat, wide_maxLat)

oras_list <- list(nc.ORAS.1982s, nc.ORAS.1982o, nc.ORAS.1982n,
                  nc.ORAS.1983s, nc.ORAS.1983o, nc.ORAS.1983n,
                  nc.ORAS.1984s, nc.ORAS.1984o, nc.ORAS.1984n,
                  nc.ORAS.1985s, nc.ORAS.1985o, nc.ORAS.1985n,
                  nc.ORAS.1986s, nc.ORAS.1986o, nc.ORAS.1986n,
                  nc.ORAS.1987s, nc.ORAS.1987o, nc.ORAS.1987n,
                  nc.ORAS.1988s, nc.ORAS.1988o, nc.ORAS.1988n,
                  nc.ORAS.1989s, nc.ORAS.1989o, nc.ORAS.1989n,
                  nc.ORAS.1990s, nc.ORAS.1990o, nc.ORAS.1990n,
                  nc.ORAS.1991s, nc.ORAS.1991o, nc.ORAS.1991n,
                  nc.ORAS.1992s, nc.ORAS.1992o, nc.ORAS.1992n,
                  nc.ORAS.1993s, nc.ORAS.1993o, nc.ORAS.1993n,
                  nc.ORAS.1994s, nc.ORAS.1994o, nc.ORAS.1994n,
                  nc.ORAS.1995s, nc.ORAS.1995o, nc.ORAS.1995n,
                  nc.ORAS.1996s, nc.ORAS.1996o, nc.ORAS.1996n,
                  nc.ORAS.1997s, nc.ORAS.1997o, nc.ORAS.1997n,
                  nc.ORAS.1998s, nc.ORAS.1998o, nc.ORAS.1998n,
                  nc.ORAS.1999s, nc.ORAS.1999o, nc.ORAS.1999n,
                  nc.ORAS.2000s, nc.ORAS.2000o, nc.ORAS.2000n,
                  nc.ORAS.2001s, nc.ORAS.2001o, nc.ORAS.2001n,
                  nc.ORAS.2002s, nc.ORAS.2002o, nc.ORAS.2002n,
                  nc.ORAS.2003s, nc.ORAS.2003o, nc.ORAS.2003n,
                  nc.ORAS.2004s, nc.ORAS.2004o, nc.ORAS.2004n,
                  nc.ORAS.2005s, nc.ORAS.2005o, nc.ORAS.2005n,
                  nc.ORAS.2006s, nc.ORAS.2006o, nc.ORAS.2006n,
                  nc.ORAS.2007s, nc.ORAS.2007o, nc.ORAS.2007n,
                  nc.ORAS.2008s, nc.ORAS.2008o, nc.ORAS.2008n,
                  nc.ORAS.2009s, nc.ORAS.2009o, nc.ORAS.2009n,
                  nc.ORAS.2010s, nc.ORAS.2010o, nc.ORAS.2010n,
                  nc.ORAS.2011s, nc.ORAS.2011o, nc.ORAS.2011n,
                  nc.ORAS.2012s, nc.ORAS.2012o, nc.ORAS.2012n,
                  nc.ORAS.2013s, nc.ORAS.2013o, nc.ORAS.2013n,
                  nc.ORAS.2014s, nc.ORAS.2014o, nc.ORAS.2014n,
                  nc.ORAS.2015s, nc.ORAS.2015o, nc.ORAS.2015n)
                  
#sst array setup
sst.ORAS.new <- NULL
for (j in 1:length(oras_list)) {
  temp.nc <- oras_list[[j]]
  
  out.temp <- array_setup(temp.nc, wide.lon, wide.lat)
  
  temp.sst <- reformat_interpolate(out.temp$lon, out.temp$lat, 
                     out.temp$sst, grid.list)
  
  
  sst.ORAS.new <- abind(sst.ORAS.new, temp.sst, along = 3)
}



rm(nc.ORAS.1982s, nc.ORAS.1982o, nc.ORAS.1982n,
    nc.ORAS.1983s, nc.ORAS.1983o, nc.ORAS.1983n,
    nc.ORAS.1984s, nc.ORAS.1984o, nc.ORAS.1984n,
    nc.ORAS.1985s, nc.ORAS.1985o, nc.ORAS.1985n,
    nc.ORAS.1986s, nc.ORAS.1986o, nc.ORAS.1986n,
    nc.ORAS.1987s, nc.ORAS.1987o, nc.ORAS.1987n,
    nc.ORAS.1988s, nc.ORAS.1988o, nc.ORAS.1988n,
    nc.ORAS.1989s, nc.ORAS.1989o, nc.ORAS.1989n,
    nc.ORAS.1990s, nc.ORAS.1990o, nc.ORAS.1990n,
    nc.ORAS.1991s, nc.ORAS.1991o, nc.ORAS.1991n,
    nc.ORAS.1992s, nc.ORAS.1992o, nc.ORAS.1992n,
    nc.ORAS.1993s, nc.ORAS.1993o, nc.ORAS.1993n,
    nc.ORAS.1994s, nc.ORAS.1994o, nc.ORAS.1994n,
    nc.ORAS.1995s, nc.ORAS.1995o, nc.ORAS.1995n,
    nc.ORAS.1996s, nc.ORAS.1996o, nc.ORAS.1996n,
    nc.ORAS.1997s, nc.ORAS.1997o, nc.ORAS.1997n,
    nc.ORAS.1998s, nc.ORAS.1998o, nc.ORAS.1998n,
    nc.ORAS.1999s, nc.ORAS.1999o, nc.ORAS.1999n,
    nc.ORAS.2000s, nc.ORAS.2000o, nc.ORAS.2000n,
    nc.ORAS.2001s, nc.ORAS.2001o, nc.ORAS.2001n,
    nc.ORAS.2002s, nc.ORAS.2002o, nc.ORAS.2002n,
    nc.ORAS.2003s, nc.ORAS.2003o, nc.ORAS.2003n,
    nc.ORAS.2004s, nc.ORAS.2004o, nc.ORAS.2004n,
    nc.ORAS.2005s, nc.ORAS.2005o, nc.ORAS.2005n,
    nc.ORAS.2006s, nc.ORAS.2006o, nc.ORAS.2006n,
    nc.ORAS.2007s, nc.ORAS.2007o, nc.ORAS.2007n,
    nc.ORAS.2008s, nc.ORAS.2008o, nc.ORAS.2008n,
    nc.ORAS.2009s, nc.ORAS.2009o, nc.ORAS.2009n,
    nc.ORAS.2010s, nc.ORAS.2010o, nc.ORAS.2010n,
    nc.ORAS.2011s, nc.ORAS.2011o, nc.ORAS.2011n,
    nc.ORAS.2012s, nc.ORAS.2012o, nc.ORAS.2012n,
    nc.ORAS.2013s, nc.ORAS.2013o, nc.ORAS.2013n,
    nc.ORAS.2014s, nc.ORAS.2014o, nc.ORAS.2014n,
    nc.ORAS.2015s, nc.ORAS.2015o, nc.ORAS.2015n)

dim(sst.ORAS.new) #[lon, lat, son_months]



```

### ORA-S5 w/o Interpolation
 
```{r raw_oras}

#wide, reduced boundary (Indian Ocean) setup
wide.lon <- c(wide_minLon, wide_maxLon)
wide.lat <- c(wide_minLat, wide_maxLat)



oras_list <- list(nc.ORAS.1982s, nc.ORAS.1982o, nc.ORAS.1982n,
                  nc.ORAS.1983s, nc.ORAS.1983o, nc.ORAS.1983n,
                  nc.ORAS.1984s, nc.ORAS.1984o, nc.ORAS.1984n,
                  nc.ORAS.1985s, nc.ORAS.1985o, nc.ORAS.1985n,
                  nc.ORAS.1986s, nc.ORAS.1986o, nc.ORAS.1986n,
                  nc.ORAS.1987s, nc.ORAS.1987o, nc.ORAS.1987n,
                  nc.ORAS.1988s, nc.ORAS.1988o, nc.ORAS.1988n,
                  nc.ORAS.1989s, nc.ORAS.1989o, nc.ORAS.1989n,
                  nc.ORAS.1990s, nc.ORAS.1990o, nc.ORAS.1990n,
                  nc.ORAS.1991s, nc.ORAS.1991o, nc.ORAS.1991n,
                  nc.ORAS.1992s, nc.ORAS.1992o, nc.ORAS.1992n,
                  nc.ORAS.1993s, nc.ORAS.1993o, nc.ORAS.1993n,
                  nc.ORAS.1994s, nc.ORAS.1994o, nc.ORAS.1994n,
                  nc.ORAS.1995s, nc.ORAS.1995o, nc.ORAS.1995n,
                  nc.ORAS.1996s, nc.ORAS.1996o, nc.ORAS.1996n,
                  nc.ORAS.1997s, nc.ORAS.1997o, nc.ORAS.1997n,
                  nc.ORAS.1998s, nc.ORAS.1998o, nc.ORAS.1998n,
                  nc.ORAS.1999s, nc.ORAS.1999o, nc.ORAS.1999n,
                  nc.ORAS.2000s, nc.ORAS.2000o, nc.ORAS.2000n,
                  nc.ORAS.2001s, nc.ORAS.2001o, nc.ORAS.2001n,
                  nc.ORAS.2002s, nc.ORAS.2002o, nc.ORAS.2002n,
                  nc.ORAS.2003s, nc.ORAS.2003o, nc.ORAS.2003n,
                  nc.ORAS.2004s, nc.ORAS.2004o, nc.ORAS.2004n,
                  nc.ORAS.2005s, nc.ORAS.2005o, nc.ORAS.2005n,
                  nc.ORAS.2006s, nc.ORAS.2006o, nc.ORAS.2006n,
                  nc.ORAS.2007s, nc.ORAS.2007o, nc.ORAS.2007n,
                  nc.ORAS.2008s, nc.ORAS.2008o, nc.ORAS.2008n,
                  nc.ORAS.2009s, nc.ORAS.2009o, nc.ORAS.2009n,
                  nc.ORAS.2010s, nc.ORAS.2010o, nc.ORAS.2010n,
                  nc.ORAS.2011s, nc.ORAS.2011o, nc.ORAS.2011n,
                  nc.ORAS.2012s, nc.ORAS.2012o, nc.ORAS.2012n,
                  nc.ORAS.2013s, nc.ORAS.2013o, nc.ORAS.2013n,
                  nc.ORAS.2014s, nc.ORAS.2014o, nc.ORAS.2014n,
                  nc.ORAS.2015s, nc.ORAS.2015o, nc.ORAS.2015n)

#sst array setup
sst.ORAS.new2 <- NULL
#TODO: get lon, lat (unique) output:

for (j in 1:length(oras_list)) {
  temp.nc <- oras_list[[j]]
  
  out.temp <- array_setup(temp.nc, wide.lon, wide.lat)
  
  temp.sst <- reformat_oras(out.temp$lon, out.temp$lat, 
                     out.temp$sst)
  
  oras.lon <- temp.sst$lon
  oras.lat <- temp.sst$lat
  
  sst.ORAS.new2 <- abind(sst.ORAS.new2, temp.sst$sst, along = 3)
}



rm(nc.ORAS.1982s, nc.ORAS.1982o, nc.ORAS.1982n,
    nc.ORAS.1983s, nc.ORAS.1983o, nc.ORAS.1983n,
    nc.ORAS.1984s, nc.ORAS.1984o, nc.ORAS.1984n,
    nc.ORAS.1985s, nc.ORAS.1985o, nc.ORAS.1985n,
    nc.ORAS.1986s, nc.ORAS.1986o, nc.ORAS.1986n,
    nc.ORAS.1987s, nc.ORAS.1987o, nc.ORAS.1987n,
    nc.ORAS.1988s, nc.ORAS.1988o, nc.ORAS.1988n,
    nc.ORAS.1989s, nc.ORAS.1989o, nc.ORAS.1989n,
    nc.ORAS.1990s, nc.ORAS.1990o, nc.ORAS.1990n,
    nc.ORAS.1991s, nc.ORAS.1991o, nc.ORAS.1991n,
    nc.ORAS.1992s, nc.ORAS.1992o, nc.ORAS.1992n,
    nc.ORAS.1993s, nc.ORAS.1993o, nc.ORAS.1993n,
    nc.ORAS.1994s, nc.ORAS.1994o, nc.ORAS.1994n,
    nc.ORAS.1995s, nc.ORAS.1995o, nc.ORAS.1995n,
    nc.ORAS.1996s, nc.ORAS.1996o, nc.ORAS.1996n,
    nc.ORAS.1997s, nc.ORAS.1997o, nc.ORAS.1997n,
    nc.ORAS.1998s, nc.ORAS.1998o, nc.ORAS.1998n,
    nc.ORAS.1999s, nc.ORAS.1999o, nc.ORAS.1999n,
    nc.ORAS.2000s, nc.ORAS.2000o, nc.ORAS.2000n,
    nc.ORAS.2001s, nc.ORAS.2001o, nc.ORAS.2001n,
    nc.ORAS.2002s, nc.ORAS.2002o, nc.ORAS.2002n,
    nc.ORAS.2003s, nc.ORAS.2003o, nc.ORAS.2003n,
    nc.ORAS.2004s, nc.ORAS.2004o, nc.ORAS.2004n,
    nc.ORAS.2005s, nc.ORAS.2005o, nc.ORAS.2005n,
    nc.ORAS.2006s, nc.ORAS.2006o, nc.ORAS.2006n,
    nc.ORAS.2007s, nc.ORAS.2007o, nc.ORAS.2007n,
    nc.ORAS.2008s, nc.ORAS.2008o, nc.ORAS.2008n,
    nc.ORAS.2009s, nc.ORAS.2009o, nc.ORAS.2009n,
    nc.ORAS.2010s, nc.ORAS.2010o, nc.ORAS.2010n,
    nc.ORAS.2011s, nc.ORAS.2011o, nc.ORAS.2011n,
    nc.ORAS.2012s, nc.ORAS.2012o, nc.ORAS.2012n,
    nc.ORAS.2013s, nc.ORAS.2013o, nc.ORAS.2013n,
    nc.ORAS.2014s, nc.ORAS.2014o, nc.ORAS.2014n,
    nc.ORAS.2015s, nc.ORAS.2015o, nc.ORAS.2015n)

dim(sst.ORAS.new2) #[lon, lat, son_months]
```

### ORA-S5 Extended

```{r raw_ext}
#sst array setup
sst.ORAS.new3 <- NULL
#TODO: get lon, lat (unique) output:

for (j in 1:length(oras.full)) {
  temp.nc <- oras.full[[j]]
  
  out.temp <- array_setup(temp.nc, wide.lon, wide.lat)
  
  temp.sst <- reformat_oras(out.temp$lon, out.temp$lat, 
                     out.temp$sst)
  
  oras.lon <- temp.sst$lon
  oras.lat <- temp.sst$lat
  
  sst.ORAS.new3 <- abind(sst.ORAS.new3, temp.sst$sst, along = 3)
}

dim(sst.ORAS.new3)

```


```{r save_oras}
setwd("~/CO_AUS/Aus_CO-main/pIOD")
save(sst.ORAS.new, sst.ORAS.new2, sst.ORAS.new3, oras.lon, oras.lat, file = "sstORAS.rda")
```

## Get ORA-S5 Land-Sea Mask
(Note: this mask looks very close to those presented in the paper)

```{r oras_lsm}

temp.lsm <- is.na(sst.ORAS.new[,,1])

```


# OISST v2

('default' data product: use as a template for other products, also available with weekly data )


```{r load_data}
setwd("~/CO_AUS/Aus_CO-main")

#begin easy with monthly OISST
nc.OISST.month <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/sst.mnmean.nc")

#OISST land sea mask
nc.OISST.lsm <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/lsmask.nc")
```


## OISST Data Setup

```{r data_cleaning}
#extract lon, lat
lat.grid <- nc.OISST.month[["dim"]][["lat"]][["vals"]]
lon.grid <- nc.OISST.month[["dim"]][["lon"]][["vals"]]

#reorder lon
lon.grid[lon.grid >= 180] <- lon.grid[lon.grid >= 180] - 360
lon.order <- order(lon.grid)

lon.grid <- lon.grid[lon.order]

#reorder lat (maybe?)
lat.order <- order(lat.grid)
lat.grid <- lat.grid[lat.order]

#time data
times <- ncvar_get(nc.OISST.month, "time") # days since 1800-01-01 00:00:0.0
times <- as_datetime("1800-01-01T00:00:00") + days(times)

#sst data, as array (lon, lat, time)
sst.oisst <- ncvar_get(nc.OISST.month, "sst")
sst.oisst <- sst.oisst[lon.order, lat.order, ]

#TODO: get wider Indian Ocean domain so we can interpolate onto the correct one.
#get reduced indian ocean region
lat.range <- range(which(lat.grid <= (wide_maxLat+1) & lat.grid >= (wide_minLat-1)))
lon.range <- range(which(lon.grid <= (wide_maxLon+1) & lon.grid >= (wide_minLon-1)))

lat.values.oisst <- lat.grid[lat.grid <= (wide_maxLat+1) & lat.grid >=  (wide_minLat-1)]
lon.values.oisst <- lon.grid[lon.grid <= (wide_maxLon+1) & lon.grid >= (wide_minLon-1)]

lat.range.base <- range(which(lat.grid <= (wide_maxLat) & lat.grid >= (wide_minLat)))
lon.range.base <- range(which(lon.grid <= (wide_maxLon) & lon.grid >= (wide_minLon)))

lat.values.base <- lat.grid[lat.grid <= (wide_maxLat) & lat.grid >=  (wide_minLat)]
lon.values.base <- lon.grid[lon.grid <= (wide_maxLon) & lon.grid >= (wide_minLon)]



#get OISST SST reduced matrix
sst.OISST.wide <- sst.oisst[lon.range[1]:lon.range[2], lat.range[1]:lat.range[2], 2:409]

dim(sst.OISST.wide)

sst.OISST.base <- sst.oisst[lon.range.base[1]:lon.range.base[2], lat.range.base[1]:lat.range.base[2], 2:409]

dim(sst.OISST.base)


#interpolate onto 1.0 x 1.0 grid
sst.OISST.new <- NULL
for (j in 1:dim(sst.OISST.wide)[3]) {
  base.obj <- list(x = lon.values.oisst, y = lat.values.oisst, z = sst.OISST.wide[,,j])

  
  out.interp <- interp.surface.grid(base.obj, grid.list)
  
  #interp.mat <- out.interp$z[ ,ncol(out.interp$z):1 ]
  
  sst.OISST.new <- abind(sst.OISST.new, out.interp$z, along = 3)
}

dim(sst.OISST.new)

#mask land
sst.OISST.new <- apply(sst.OISST.new, 3, function(X) {
  X[temp.lsm] <- NA
  return(X)
})

dim(sst.OISST.new) <- c(91, 41, 408)


```


```{r alt_lsm}
#lsm for sst.OISST.base 

##Land Sea Mask
#extract lon, lat
lat.grid.lsm <- nc.OISST.lsm[["dim"]][["lat"]][["vals"]]
lon.grid.lsm <- nc.OISST.lsm[["dim"]][["lon"]][["vals"]]

#reorder lon for 
lon.grid.lsm[lon.grid.lsm >= 180] <- lon.grid.lsm[lon.grid.lsm >= 180] - 360
this.order.lsm <- order(lon.grid.lsm)

lon.grid.lsm <- lon.grid.lsm[this.order.lsm]


#setup (or find) a land sea mask.
lsm <- ncvar_get(nc.OISST.lsm, "mask")
lsm <- lsm[this.order.lsm, ]

#TODO update lsm for reduced region
#get lsm for IOD only
lsm_IOD <- lsm[lon.range.base[1]:lon.range.base[2], lat.range.base[1]:lat.range.base[2]] 

lsm.IOD <- lsm_IOD[ ,ncol(lsm_IOD):1]

#setup (land sea mask for OISST data)
lsm.IOD.array <- array(lsm.IOD, dim = dim(sst.OISST.base))

sst.OISST.new2 <- ifelse(lsm.IOD.array == 1, sst.OISST.base, NA)

dim(sst.OISST.new2)

```


```{r save_oisst}

setwd("~/CO_AUS/Aus_CO-main/pIOD")
save(sst.OISST.new, sst.OISST.new2, lat.values.base, lon.values.base, file = "sstOISST.rda")
```


# SODA3.3.1

```{r load_data}
setwd("~/CO_AUS/Aus_CO-main")

##SODA3.3.1
#all monthly data in a single file
nc.SODA.month <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/erdSoda331oceanmday_6a77_2294_0698.nc")

```

## SODA Data Setup

```{r data_cleaning}
#and interpolation

#for monthly
lat.grid.soda <- nc.SODA.month[["dim"]][["latitude"]][["vals"]]
lon.grid.soda <- nc.SODA.month[["dim"]][["longitude"]][["vals"]]

#adjust lon order
lon.grid.soda[lon.grid.soda >= 180] <- lon.grid.soda[lon.grid.soda >= 180] - 360
lon.order.soda <- order(lon.grid.soda)

lon.grid.soda <- lon.grid.soda[lon.order.soda]

#adjust lat order
#TODO: double check this, it might be wrong
#lat.order.soda <- order(lat.grid.soda, decreasing = TRUE)
#lat.grid.soda <- lat.grid.soda[lat.order.soda]

#get times
times.soda <- ncvar_get(nc.SODA.month, "time") #seconds since 1970-01-01T00:00:00Z
times.soda <- as_datetime("1970-01-01T00:00:00") + seconds(times.soda)
  
  
sst.soda <- ncvar_get(nc.SODA.month, "temp")
sst.soda <- sst.soda[lon.order.soda, , ]


#TODO: get bounded data for wider data
#SODA range
lat.values.soda <- lat.grid.soda[lat.grid.soda <= wide_maxLat & lat.grid.soda >= wide_minLat]
lat.range.soda <- range(which(lat.grid.soda <= wide_maxLat & lat.grid.soda >= wide_minLat))

lon.values.soda <- lon.grid.soda[lon.grid.soda <= wide_maxLon & lon.grid.soda >= wide_minLon]
lon.range.soda <- range(which(lon.grid.soda <= wide_maxLon & lon.grid.soda >= wide_minLon))

times.soda[25]
times.soda[432]

#get SODA SST reduced matrix 
sst_soda <- sst.soda[lon.range.soda[1]:lon.range.soda[2], lat.range.soda[1]:lat.range.soda[2], ]
sst.SODA.new2 <- sst_soda[,, 25:432]

dim(sst.SODA.new2) #[nx, ny, nt]

#interpolate onto 1.0 x 1.0 grid
sst.SODA.new <- NULL
for (j in 1:dim(sst.SODA.new2)[3]) {
  base.obj <- list(x = lon.values.soda, y = lat.values.soda, z = sst.SODA.new2[,,j])

  
  out.interp <- interp.surface.grid(base.obj, grid.list)
  
  #interp.mat <- out.interp$z[ ,ncol(out.interp$z):1 ]
  
  sst.SODA.new <- abind(sst.SODA.new, out.interp$z, along = 3)
}

dim(sst.SODA.new)


```


```{r save_soda}

setwd("~/CO_AUS/Aus_CO-main/pIOD")

save(sst.SODA.new, sst.SODA.new2, lon.values.soda, lat.values.soda, file = "sstSODA.rda")
```


# SST Anomalies

(produce sst anomalies here)

## Anomaly Functions

```{r functions}

#son average (seasonal mean for each year)
son.avg <- function(sst, son.only = FALSE){
  ##sst as [lon, lat, time]
  A.new <- aperm(sst, perm = c(3, 2, 1))  # reorder data as [time, lat, lon]
  
  #get dimensions from reordered array
  nx <- dim(A.new)[3]
  ny <- dim(A.new)[2] 
  nt <- dim(A.new)[1]
  
  #get SON mean (get 1 sst per year (as son mean))
  if (son.only) {
    #if only provided with 3 months (son) per year
    nyears <- nt %/% 3
    A.temp <- array(A.new, dim = c(3, nyears, ny, nx))
    A.son <- apply(A.temp[1:3, , , ], c(2,3,4), mean, na.rm = TRUE) #already at correct subset
  }else {
    nyears <- nt %/% 12
    #reshape data array
    A.temp <- array(A.new, dim = c(12, nyears, ny, nx))
    A.son <- apply(A.temp[9:11, , , ], c(2,3,4), mean, na.rm = TRUE) #already at correct subset
  }
  
  return(aperm(A.son, perm = c(3, 2, 1))) #return as [lon, lat, time]
}

##son anomalies
#1. compute SON (seasonal) climatology
#2. seasonal means minus seasonal climatology
son.anom <- function(sst){

  climate.mean <- apply(sst, c(1, 2), mean, na.rm = FALSE)
  son.anom <- sweep(sst, MARGIN = c(1, 2), STATS = climate.mean, FUN = "-")

  return(son.anom)
}


##detrend son anomalies
son.detrend <- function(anom, order = 1){
  #get dimensions
  nx <- dim(anom)[1]
  ny <- dim(anom)[2]
  nt <- dim(anom)[3]
  
  t <- 1:nt
  sst.resid <- anom
  #double for-loop (not efficient, but oh well)
  for (i in 1:nx) {
    for (j in 1:ny) {
      x <- anom[i,j,]
      if (all(!is.na(x))){ 
        fit.lm <- switch(order,
                         '1' = lm(x ~ t),
                         '2' = lm(x ~ t + I(t^2)))
    
      }
      
      }
    sst.resid[i,j,] <- fit.lm$residuals
  }
  return(sst.resid)
}

```


## SON (Seasonal) Anomalies

```{r son_anoms}
#son avg
sst.GODAS.son <- son.avg(sst.GODAS.new)
sst.ORAS.son <- son.avg(sst.ORAS.new, son.only = TRUE)
sst.OISST.son <- son.avg(sst.OISST.new)
sst.SODA.son <- son.avg(sst.SODA.new)

#get son anomalies
sst.GODAS.anom <- son.anom(sst.GODAS.son)
sst.ORAS.anom <- son.anom(sst.ORAS.son)
sst.OISST.anom <- son.anom(sst.OISST.son)
sst.SODA.anom <- son.anom(sst.SODA.son)

#get detrended data
sst.GODAS.anom2 <- son.detrend(sst.GODAS.anom)
sst.ORAS.anom2 <- son.detrend(sst.ORAS.anom)
sst.OISST.anom2 <- son.detrend(sst.OISST.anom)
sst.SODA.anom2 <- son.detrend(sst.SODA.anom)

#dimension check
dim(sst.GODAS.anom2)
dim(sst.ORAS.anom2)
dim(sst.OISST.anom2)
dim(sst.SODA.anom2)

setwd("~/CO_AUS/Aus_CO-main/pIOD")
save(sst.GODAS.anom2, sst.ORAS.anom2,
    sst.OISST.anom2, sst.SODA.anom2, 
    lon.wide, lat.wide, file = "sstAnoms.rda")

```


## SON Multi-Product Averages

```{r}
#temp location for multi prod averages.


```

## Alternative SST Anoms

```{r alt_function}

sst.anoms <- function(A, son.only = FALSE, quadratic = FALSE){
    
  A.new <- aperm(A, perm = c(3, 2, 1))  # reorder data as [time, lat, lon]
  
  #get dimensions from reordered array
  nx <- dim(A.new)[3]
  ny <- dim(A.new)[2] 
  nt <- dim(A.new)[1]
  
  #get SON mean (get 1 sst per year (as son mean))
  if (son.only) {
    #if only provided with 3 months (son) per year
    nyears <- nt %/% 3
    A.temp <- array(A.new, dim = c(3, nyears, ny, nx))
    A.son <- apply(A.temp[1:3, , , ], c(2,3,4), mean, na.rm = TRUE) #already at correct subset
  }else {
    nyears <- nt %/% 12
    #reshape data array
    A.temp <- array(A.new, dim = c(12, nyears, ny, nx))
    A.son <- apply(A.temp[9:11, , , ], c(2,3,4), mean, na.rm = TRUE) #already at correct subset
  }
  
  rm(A.temp)
  
  #update time dim
  nt <- dim(A.son)[1]
  
  #remove mean
  var <- matrix(A.son, nrow = nt, ncol = ny * nx) #from earlier work on detrend
  
  #get full period mean
  var.mean <- colMeans(var) #TODO: visualize this spatially (transform to [lon, lat])
  var <- sweep(var, 2, colMeans(var), "-") #TODO: check how this might hold up with irregular spatial masks
  
  #de-trend
  #TODO: figure out how to work with irregular NAs in time/space (some years have different spatial NAs)
  test.na <- which(!is.na(var), arr.ind = TRUE) 
  true.index <- unique(test.na[,2])
  
  A.resid <- matrix(NA, nrow = nt, ncol = ny*nx)
  A.coef <- matrix(NA, nrow = 2, ncol = ny*nx)
  
  var.x <- seq_len(nt) #time "covariates"
  var.y <- var[ ,true.index] #response variable (sst anoms)
  
  
  if (quadratic) {
    var.fit <- lm(var.y ~ var.x + I(var.x^2))
    A.coef[,true.index] <- var.fit$coefficients[1:2, ] #only works for first two coeffs
  } else {
    var.fit <- lm(var.y ~ var.x)
    A.coef[,true.index] <- var.fit$coefficients
  }
  
  A.resid[,true.index] <- var.fit$residuals
  
  #TODO: update this handle quadratic fit
  #A.coef[,true.index] <- var.fit$coefficients
  
  return(list(mean = var.mean,
              anom = A.resid,
              coef = A.coef))
}
```


```{r}
#sst anomalies SON, for 
##OISST
sst.anom.oisst <- sst.anoms(sst.OISST.new, quadratic = FALSE)
#GODAS
sst.anom.godas <- sst.anoms(sst.GODAS.new, quadratic = FALSE)
#SODA
sst.anom.soda <- sst.anoms(sst.SODA.new, quadratic = FALSE)
#ORA-S5
sst.anom.oras <- sst.anoms(sst.ORAS.new, son.only = TRUE, quadratic = FALSE)

#get 'full' son avg for all 4 data product sst anoms
sst.full.avg <- (sst.anom.oisst$anom + sst.anom.godas$anom + 
                   sst.anom.soda$anom + sst.anom.oras$anom)/4

```


# Figures

## SST anomalies

```{r 1994_fig}
##SST anomalies (detrended)
nt <- 34
ny <- 41
nx <- 91
temp <- array(sst.full.avg, dim = c(nt, ny, nx))  # from [nt, ny*nx] to [nt, ny, nx]
spat.resid <- aperm(temp, c(3, 2, 1))  # from [nt, ny, nx] to [nx, ny, nt]


#1994 SON anom detrended
k <- 13
resid.absmax <- max(abs(spat.resid[,,k]), na.rm = TRUE)
resid.range <- c(-resid.absmax, resid.absmax) 
#default breaks
cols.ryb <- rev(colorRampPalette(brewer.pal(11, "RdYlBu"))(12))
cols_alpha <- adjustcolor(cols.ryb, alpha.f = 0.25)
breaks.dumb <- c(resid.range[1], seq(-1,1, 0.2), resid.range[2])
leg.brks2 <- seq(-1.2, 1.2, 0.2) 


png(filename = "sst1994anom_overlay.png", width = 2400, height = 1600, bg = "transparent", type = "cairo")
par(mar = c(7, 5, 2, 5), mgp = c(2.25, 1, 0))
image(list(x = lon.wide, y = lat.wide, z = spat.resid[,,k]), 
           col = cols_alpha, breaks = breaks.dumb, zlim = resid.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
rect(pIOD_minLon ,pIOD_minLat , pIOD_maxLon , pIOD_maxLat, lty = 2, lwd = 5 )
world(add=TRUE, lwd = 6)
contour(x = lon.wide, y = lat.wide, z = spat.resid[,,k], add = TRUE, 
        levels = breaks.dumb, drawlabels = FALSE, lwd = 4)
dev.off()

```

```{r 1997_fig}

#1997 SON anom detrended
k <- 16
resid.absmax <- max(abs(spat.resid[,,k]), na.rm = TRUE)
resid.range <- c(-resid.absmax, resid.absmax) 
#default breaks
cols.ryb <- rev(colorRampPalette(brewer.pal(11, "RdYlBu"))(12))
cols_alpha <- adjustcolor(cols.ryb, alpha.f = 0.15)

breaks.dumb <- c(resid.range[1], seq(-1,1, 0.2), resid.range[2])
leg.brks2 <- seq(-1.2, 1.2, 0.2) 

png(filename = "sst1997anom_overlay.png", width = 2400, height = 1600, bg = "transparent", type = "cairo")
par(mar = c(7, 5, 2, 5), mgp = c(2.25, 1, 0))
image(list(x = lon.wide, y = lat.wide, z = spat.resid[,,k]), 
           col = cols_alpha, breaks = breaks.dumb, zlim = resid.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
rect(pIOD_minLon ,pIOD_minLat , pIOD_maxLon , pIOD_maxLat, lty = 2, lwd = 5 )
world(add=TRUE, lwd = 6)
contour(x = lon.wide, y = lat.wide, z = spat.resid[,,k], add = TRUE, 
        levels = breaks.dumb, drawlabels = FALSE, lwd = 4)
dev.off()

png(filename = "sst1997anom_new.png", width = 2400, height = 1600, res = 250)
par(mar = c(7, 5, 2, 5), mgp = c(2.25, 1, 0))
image(list(x = lon.wide, y = lat.wide, z = spat.resid[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = resid.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
rect(pIOD_minLon ,pIOD_minLat , pIOD_maxLon , pIOD_maxLat, lty = 2, lwd = 2 )
world(add=TRUE, lwd = 2)
contour(x = lon.wide, y = lat.wide, z = spat.resid[,,k], add = TRUE, 
        levels = breaks.dumb, drawlabels = FALSE, lwd = 1)
dev.off()

```


### SST Anomalies (w/o Interpolation)

Working section

```{r test_section}
#sst.GODAS.new2
son.GODAS.sst <- son.avg(sst.GODAS.new2)

#sst.ORAS.new2
son.ORAS.sst <- son.avg(sst.ORAS.new2, son.only = TRUE)

#sst.OISST.new2
son.OISST.sst <-  son.avg(sst.OISST.new2)

#sst.SODA.new2
son.SODA.sst <- son.avg(sst.SODA.new2)


dim(son.GODAS.sst)
dim(son.ORAS.sst)
dim(son.OISST.sst)
dim(son.SODA.sst)

```

```{r sst_anoms}
#sst anoms
##OISST
sst.anom.oisst2 <- sst.anoms(sst.OISST.new2, quadratic = FALSE)
#GODAS
sst.anom.godas2 <- sst.anoms(sst.GODAS.new2, quadratic = FALSE)
#SODA
sst.anom.soda2 <- sst.anoms(sst.SODA.new2, quadratic = FALSE)
#ORA-S5
sst.anom.oras2 <- sst.anoms(sst.ORAS.new2, son.only = TRUE, quadratic = FALSE)

```

(interpolate SST anoms)

```{r interp_sst}

lon.wide <- seq(wide_minLon, wide_maxLon, by = 1)
lat.wide <- seq(wide_minLat, wide_maxLat, by = 1)

#grid list from 
grid.list <- list(x = lon.wide,
                  y = lat.wide)



dim.GODAS <- dim(sst.GODAS.new2)
dim.OISST <- dim(sst.OISST.new2)
dim.SODA <- dim(sst.SODA.new2)
dim.ORAS <- dim(sst.ORAS.new2)

#GODAS Interpolat
nx <- dim.GODAS[1]
ny <- dim.GODAS[2]

#GODAS lat: new.lat, lon: new.lon 
GODAS.new <- array(sst.anom.godas2$anom, dim = c(34, ny, nx)) 
GODAS.new <- aperm(GODAS.new, c(3, 2, 1)) #as [nx, ny, nt]

GODAS.anom <- NULL
for (j in seq_len(34)) {
  GODAS.obj <-  list(x = new.lon, y = new.lat, z = GODAS.new[,,j])

  temp.interp <- interp.surface.grid(GODAS.obj, grid.list)
  GODAS.anom <- abind(GODAS.anom, temp.interp$z, along = 3)
}


#ORAS Interpolat
nx <- dim.ORAS[1]
ny <- dim.ORAS[2]

#ORAS lat: oras.lat, lon: oras.lon 
ORAS.new <- array(sst.anom.oras2$anom, dim = c(34, ny, nx)) 
ORAS.new <- aperm(ORAS.new, c(3, 2, 1)) #as [nx, ny, nt]

ORAS.anom <- NULL
for (j in seq_len(34)) {
  ORAS.obj <-  list(x = oras.lon, y = oras.lat, z = ORAS.new[,,j])

  temp.interp <- interp.surface.grid(ORAS.obj, grid.list)
  ORAS.anom <- abind(ORAS.anom, temp.interp$z, along = 3)
}


#OISST Interpolation
nx <- dim.OISST[1]
ny <- dim.OISST[2]


#OISST lat: lat.values.base, lon: lon.values.base 
OISST.new <- array(sst.anom.oisst2$anom, dim = c(34, ny, nx)) 
OISST.new <- aperm(OISST.new, c(3, 2, 1)) #as [nx, ny, nt]

OISST.anom <- NULL
for (j in seq_len(34)) {
  OISST.obj <-  list(x = lon.values.base, y = lat.values.base, z = OISST.new[,,j])

  temp.interp <- interp.surface.grid(OISST.obj, grid.list)
  OISST.anom <- abind(OISST.anom, temp.interp$z, along = 3)
}


#SODA Interpolation
nx <- dim.SODA[1]
ny <- dim.SODA[2]


#SODA lat: lat.values.soda, lon: lon.values.soda 
SODA.new <- array(sst.anom.soda2$anom, dim = c(34, ny, nx)) 
SODA.new <- aperm(SODA.new, c(3, 2, 1)) #as [nx, ny, nt]

SODA.anom <- NULL
for (j in seq_len(34)) {
  SODA.obj <-  list(x = lon.values.soda, y = lat.values.soda, z = SODA.new[,,j])

  temp.interp <- interp.surface.grid(SODA.obj, grid.list)
  SODA.anom <- abind(SODA.anom, temp.interp$z, along = 3)
}

dim(GODAS.anom)
dim(OISST.anom)
dim(ORAS.anom)
dim(SODA.anom)

setwd("~/CO_AUS/Aus_CO-main/pIOD")
save(GODAS.anom, OISST.anom, ORAS.anom, SODA.anom, file = "sstinterp.rda")

```



```{r interp_sstavg}
setwd("~/CO_AUS/Aus_CO-main/pIOD")
load("sstinterp.rda")

mat_list <- list(GODAS.anom, ORAS.anom,
                OISST.anom, SODA.anom)

array_new <- abind(mat_list, along = 4)

mean_sst <- apply(array_new, c(1, 2, 3), mean, na.rm = TRUE)
dimnames(mean_sst) <- NULL

dim(mean_sst) 


#location range
lon.values.IOD <- lon.wide[lon.wide <= pIOD_maxLon & lon.wide >= pIOD_minLon]
lon.range.IOD <- range(which(lon.wide <= pIOD_maxLon & lon.wide >= pIOD_minLon))

lat.values.IOD <- lat.wide[lat.wide <= pIOD_maxLat & lat.wide >= pIOD_minLat]
lat.range.IOD <- range(which(lat.wide <= pIOD_maxLat & lat.wide >= pIOD_minLat))

sst.anom.mean <- mean_sst[lon.range.IOD[1]:lon.range.IOD[2], lat.range.IOD[1]:lat.range.IOD[2], ]

```

### Land-Sea Mask Adjustments

```{r lsm_adj}
westcoords <- matrix(c(1, 2,
                   2, 4,
                   3, 5, 
                   4, 6,
                   5, 7,
                   6, 8,
                   7, 8,
                   8, 9,
                   9, 10,
                   10,11), 
                 byrow = TRUE, ncol = 2)

#partial east coordiantes
eastcoords <- matrix(c( 61, 5,
                        60, 6,
                        59, 8,
                        58, 9,
                        57, 10,
                        59, 11,
                        60, 10,
                        61, 9,
                        ),
                      byrow = TRUE, ncol=2) 


for (k in 1:dim(sst.anom.mean)[3]) {
  for (i in 1:nrow(westcoords)) {
    row_i <- westcoords[i, 1]
    col_i <- westcoords[i, 2]
    sst.anom.mean[row_i, col_i, k] <- NaN
  }
  for (j in 1:nrow(eastcoords)) {
    row_j <- eastcoords[j, 1]
    col_j <- eastcoords[j, 2]
    sst.anom.mean[row_j, col_j, k] <- NaN
  }
}

sst.anom <- aperm(sst.anom.mean, c(3, 2, 1))
dim(sst.anom)
```


```{r save_sstanoms}
setwd("~/CO_AUS/Aus_CO-main/pIOD")
save(sst.anom.mean, file = "sst_anoms.rda")
```



### Test code

```{r lsm_adjustments}
#TODO: finalize this with respect to the eastern LSM, and make this all better

#shave some pixels off
IOD_maxLon <- 100
IOD_minLon <- 40
IOD_maxLat <- 5
IOD_minLat <- -5

#location range
lon.values.IOD <- lon.wide[lon.wide <= IOD_maxLon & lon.wide >= IOD_minLon]
lon.range.IOD <- range(which(lon.wide <= IOD_maxLon & lon.wide >= IOD_minLon))

lat.values.IOD <- lat.wide[lat.wide <= IOD_maxLat & lat.wide >= IOD_minLat]
lat.range.IOD <- range(which(lat.wide <= IOD_maxLat & lat.wide >= IOD_minLat))
 
sst.anom <- aperm(mean_sst, c(3, 2, 1))

sst.anom.pIOD <- sst.anom[,lat.range.IOD[1]:lat.range.IOD[2],lon.range.IOD[1]:lon.range.IOD[2]]
sst.anom.mean <- mean_sst[lon.range.IOD[1]:lon.range.IOD[2], lat.range.IOD[1]:lat.range.IOD[2], ]

sst.anom.mean[,,16]
lon.values.IOD
lat.values.IOD

sst.anom.mean[c(1,2), c(2,4),1]

#cut (1,3), (2,4), 

#kinda unhinged shit right here:

coords <- matrix(c(1, 2,
                   2, 4,
                   3, 5, 
                   4, 6,
                   5, 7,
                   6, 8,
                   7, 8,
                   8, 9,
                   9, 10,
                   10,11), 
                 byrow = TRUE, ncol = 2)

for (k in 1:dim(sst.anom.mean)[3]) {
  for (i in 1:nrow(coords)) {
    row_i <- coords[i, 1]
    col_i <- coords[i, 2]
    sst.anom.mean[row_i, col_i, k] <- NaN
  }
}


sst.anom.temp <- sst.anom.mean[,,1]
sst.anom <- aperm(sst.anom.mean, c(3, 2, 1))
dim(sst.anom)

sst.anom[1,,]
```

```{r final_lsm}
westcoords <- matrix(c(1, 2,
                   2, 4,
                   3, 5, 
                   4, 6,
                   5, 7,
                   6, 8,
                   7, 8,
                   8, 9,
                   9, 10,
                   10,11), 
                 byrow = TRUE, ncol = 2)

#partial east coordiantes
eastcoords <- matrix(c( 61, 5,
                        60, 6,
                        59, 8,
                        58, 9,
                        57, 10,
                        59, 11,
                        60, 10,
                        61, 9,
                        ),
                      byrow = TRUE, ncol=2) 
  
  
```


# Extension to 2019

Begin by reproducing the GODAS 2019 data from fig1

```{r prep_GODAS}
#load in just 2019

nc.temp <- nc.GODAS.2019
  
temp.nc.godas <- godas_prep(nc.temp)
temp.lon <- temp.nc.godas$lon
temp.lat <- temp.nc.godas$lat
temp.sst <- temp.nc.godas$sst

#get reduce range (indian ocean region)
new.lon <- temp.lon[temp.lon <= wide_maxLon & temp.lon >= wide_minLon]
lon.range <- range(which(temp.lon <= wide_maxLon & temp.lon >= wide_minLon))
new.lat <- temp.lat[temp.lat <= wide_maxLat & temp.lat >= wide_minLat]
lat.range <- range(which(temp.lat <= wide_maxLat & temp.lat >= wide_minLat))

#assign
sst.GODAS.2019 <- temp.sst[lon.range[1]:lon.range[2], lat.range[1]:lat.range[2], ]

GODAS.lon <- new.lon
GODAS.lat <- new.lat

#son.avg(sst.GODAS.2019)

dim(sst.GODAS.2019)
dim(sst.GODAS.new2)

sst.GODAS.new3 <- abind(sst.GODAS.new2, sst.GODAS.2019, along = 3)
dim(sst.GODAS.new3)
#GODAS
sst.anom.godas3 <- sst.anoms(sst.GODAS.new3, quadratic = FALSE)


#GODAS (from combined 1982-2015, 2019)
sst.anom.godas3 <- sst.anoms(sst.GODAS.new2, quadratic = FALSE)

```

```{r SON_anom}
A.new <- aperm(sst.GODAS.2019, perm = c(3, 2, 1))  # reorder data as [time, lat, lon]
  
#get dimensions from reordered array
nx <- dim(A.new)[3]
ny <- dim(A.new)[2] 
nt <- dim(A.new)[1]

#get SON mean (get 1 sst per year (as son mean))
nyears <- nt %/% 12
#reshape data array
A.temp <- array(A.new, dim = c(12, nyears, ny, nx))
A.son <- apply(A.temp[9:11, , , ], c(2,3), mean, na.rm = TRUE) #already at correct subset

#remove mean 
var <- as.vector(matrix(A.son, nrow = ny * nx, ncol = 1)) #super messy but whatever

#mean and trend from existing work
godas.mean <- sst.anom.godas2$mean

godas.anom1 <- var - godas.mean

godas.coef <- sst.anom.godas2$coef

t <- 38
godas.trend <- godas.coef[1,] + t*godas.coef[2,]
godas.amom.2019 <- godas.anom1 - godas.trend

```


```{r SONanom_alt}
#repeat the son.avg() but with added 2019 data
```


```{r 2019_interp}
#GODAS lat: new.lat, lon: new.lon 
GODAS.new2 <- array(godas.amom.2019, dim = c(1, ny, nx)) 
GODAS.new2 <- aperm(GODAS.new2, c(3, 2, 1)) #as [nx, ny, nt]


GODAS.obj <-  list(x = GODAS.lon, y = GODAS.lat, z = GODAS.new2[,,1])
GODAS.interp <- interp.surface.grid(GODAS.obj, grid.list)

sst.2019.godas <- GODAS.interp$z


#interpolate
##TODO: sst.anom.godas3 anomalies onto grid
#GODAS Interpolat
nx <- dim.GODAS[1]
ny <- dim.GODAS[2]

#GODAS lat: new.lat, lon: new.lon 
GODAS.new2 <- array(sst.anom.godas3$anom, dim = c(35, ny, nx)) 
GODAS.new2 <- aperm(GODAS.new2, c(3, 2, 1)) #as [nx, ny, nt]

GODAS.anom2 <- NULL
for (j in seq_len(34)) {
  GODAS.obj <-  list(x = new.lon, y = new.lat, z = GODAS.new2[,,j])

  temp.interp <- interp.surface.grid(GODAS.obj, grid.list)
  GODAS.anom2 <- abind(GODAS.anom, temp.interp$z, along = 3)
}


dim(GODAS.anom2)

```



## Figures-For 2019

```{r godas_only}
sst.temp <- matrix(godas.amom.2019, nrow = ny, ncol = nx)
sst.temp <- sst.temp[ny:1,]

abs.max <- max(abs(sst.temp), na.rm = TRUE)
abs.range <- c(-abs.max, abs.max)
cols.ryb <- rev(colorRampPalette(brewer.pal(11, "RdYlBu"))(14))
breaks.dumb <- c(abs.range[1], seq(-2.4,2.4, 0.4), abs.range[2])

imagePlot(list(x = GODAS.lon, y = rev(GODAS.lat), z = t(sst.temp)),
          col = cols.ryb, breaks = breaks.dumb, zlim =  range(abs.range),
          xlim = c(40, 120), ylim = c(-10,10))
world(add = TRUE)


imagePlot(list(x = grid.list$x, y = grid.list$y, z = GODAS.interp$z),
          col = cols.ryb, breaks = breaks.dumb, zlim =  range(abs.range),
          xlim = c(40, 120), ylim = c(-10,10))
world(add = TRUE)

```




(compare data products)

## Monthly Data Checks

```{r}
#TODO: update range and breaks with all data when done with above data prep
sst.range <- range(sst.GODAS.new, sst.ORAS.new, 
                   sst.OISST.new, sst.SODA.new, na.rm = TRUE)

cols.ryb <- rev(colorRampPalette(brewer.pal(11, "RdYlBu"))(24))
breaks.sst <- seq(sst.range[1], sst.range[2], length.out = length(cols.ryb) + 1)


#GODAS test
sst.godas.test <- sst.GODAS.new[,,10]

imagePlot(list(x = lon.wide, y = lat.wide, z = sst.godas.test), 
           col = cols.ryb, breaks = breaks.sst, zlim = sst.range,
           xlab = "Lon", ylab = "Lat")
title("GODAS", adj = 0)
world(add = TRUE)

#ORAS test
sst.oras.test <- sst.ORAS.new[,,2]

imagePlot(list(x = lon.wide, y = lat.wide, z = sst.oras.test), 
           col = cols.ryb, breaks = breaks.sst, zlim = sst.range,
           xlab = "Lon", ylab = "Lat")
title("ORA-S5", adj = 0)
world(add = TRUE)

#OISST test
sst.oisst.test <- sst.OISST.new[,,10]

imagePlot(list(x = lon.wide, y = lat.wide, z = sst.oisst.test), 
           col = cols.ryb, breaks = breaks.sst, zlim = sst.range,
           xlab = "Lon", ylab = "Lat")
title("OISST", adj = 0)
world(add = TRUE)

#SODA test
sst.soda.test <- sst.SODA.new[,,10]

imagePlot(list(x = lon.wide, y = lat.wide, z = sst.soda.test), 
           col = cols.ryb, breaks = breaks.sst, zlim = sst.range,
           xlab = "Lon", ylab = "Lat")
title("SODA3.3.1", adj = 0)
world(add = TRUE)



```

## SON Mean Checks

```{r}

```

## SON Anomalies

### Interpolation after ANOMS

```{r 1x1grid}

#get range for all sst.anom objects
anom.range <- range(GODAS.anom, OISST.anom,
                    ORAS.anom, SODA.anom, na.rm = TRUE)
anom.absmax <- max(abs(anom.range))
anom.range <- c(-anom.absmax, anom.absmax)
#color/breaks
cols.ryb <- rev(colorRampPalette(brewer.pal(11, "RdYlBu"))(12))
breaks.dumb <- c(anom.range[1], seq(-1,1, 0.2), anom.range[2])
leg.brks2 <- seq(-1.2, 1.2, 0.2) 

#1997 SON anom detrended (as a test case)
k <- 16

#GODAS
image(list(x = lon.wide, y = lat.wide, z = GODAS.anom[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = anom.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("GODAS SST Anoms 1997", adj = 0)

#OISST
image(list(x = lon.wide, y = lat.wide, z = OISST.anom[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = anom.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("OISST SST Anoms 1997", adj = 0)

#ORAS
image(list(x = lon.wide, y = lat.wide, z = ORAS.anom[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = anom.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("ORA-S5 SST Anoms 1997", adj = 0)

#SODA
image(list(x = lon.wide, y = lat.wide, z = SODA.anom[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = anom.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("SODA3.3.1 SST Anoms 1997", adj = 0)

```

### Interpolation before ANOMS

```{r pre_interp}
##SST anomalies (detrended)
nt <- 34
ny <- 41
nx <- 91

#GODAS
temp1 <- array(sst.anom.godas$anom, dim = c(nt, ny, nx))  # from [nt, ny*nx] to [nt, ny, nx]
godas.anom.base <- aperm(temp1, c(3, 2, 1))  # from [nt, ny, nx] to [nx, ny, nt]

#ORAS
temp2 <- array(sst.anom.oras$anom, dim = c(nt, ny, nx))  # from [nt, ny*nx] to [nt, ny, nx]
oras.anom.base <- aperm(temp2, c(3, 2, 1))  # from [nt, ny, nx] to [nx, ny, nt]

#OISST
temp3 <- array(sst.anom.oisst$anom, dim = c(nt, ny, nx))  # from [nt, ny*nx] to [nt, ny, nx]
oisst.anom.base <- aperm(temp3, c(3, 2, 1))  # from [nt, ny, nx] to [nx, ny, nt]

#SODA
temp4 <- array(sst.anom.soda$anom, dim = c(nt, ny, nx))  # from [nt, ny*nx] to [nt, ny, nx]
soda.anom.base <- aperm(temp4, c(3, 2, 1))  # from [nt, ny, nx] to [nx, ny, nt]

rm(temp1, temp2, temp3, temp4)

#get range for all sst.anom objects
anom.range <- range(godas.anom.base, oras.anom.base,
                    oisst.anom.base, soda.anom.base, na.rm = TRUE)
anom.absmax <- max(abs(anom.range))
anom.range <- c(-anom.absmax, anom.absmax)
#color/breaks
cols.ryb <- rev(colorRampPalette(brewer.pal(11, "RdYlBu"))(12))
breaks.dumb <- c(anom.range[1], seq(-1,1, 0.2), anom.range[2])
leg.brks2 <- seq(-1.2, 1.2, 0.2) 

#1997 SON anom detrended (as a test case)
k <- 16

#GODAS
image(list(x = lon.wide, y = lat.wide, z = godas.anom.base[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = anom.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("GODAS SST Anoms 1997", adj = 0)

#OISST
image(list(x = lon.wide, y = lat.wide, z = oisst.anom.base[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = anom.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("OISST SST Anoms 1997", adj = 0)

#ORAS
image(list(x = lon.wide, y = lat.wide, z = oras.anom.base[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = anom.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("ORA-S5 SST Anoms 1997", adj = 0)

#SODA
image(list(x = lon.wide, y = lat.wide, z = soda.anom.base[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = anom.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("SODA3.3.1 SST Anoms 1997", adj = 0)
```

### Differences

```{r}
#1997 differences
k <- 16
godas.diff <- GODAS.anom[,,k] - godas.anom.base[,,k]
oras.diff <- ORAS.anom[,,k] - oras.anom.base[,,k]
oisst.diff <- OISST.anom[,,k] - oisst.anom.base[,,k]
soda.diff <- SODA.anom[,,k] - soda.anom.base[,,k]

length(which(godas.diff != 0))
length(which(oras.diff != 0 ))
length(which(oisst.diff != 0))
length(which(soda.diff != 0 ))

range.diff <- range(godas.diff, oras.diff, oisst.diff, soda.diff, na.rm = TRUE)
diff.absmax <- max(abs(range.diff))
range.diff <- c(-diff.absmax, diff.absmax)

cols.rb <- rev(colorRampPalette(brewer.pal(11, "RdBu"))(12))
breaks.rb <- seq(range.diff[1], range.diff[2], length.out = length(cols.rb)+1)

#GODAS
imagePlot(list(x = lon.wide, y = lat.wide, z = godas.diff), 
           col = cols.rb, #breaks = breaks.rb, zlim = range.diff, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("GODAS SST Anoms 1997", adj = 0)

#OISST
imagePlot(list(x = lon.wide, y = lat.wide, z = oisst.diff), 
           col = cols.rb, #breaks = breaks.rb, zlim = range.diff, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("OISST SST Anoms 1997", adj = 0)

#ORAS
imagePlot(list(x = lon.wide, y = lat.wide, z = oras.diff), 
           col = cols.rb, #breaks = breaks.rb, zlim = range.diff, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("ORA-S5 SST Anoms 1997", adj = 0)

#SODA
imagePlot(list(x = lon.wide, y = lat.wide, z = soda.diff), 
           col = cols.rb, #breaks = breaks.rb, zlim = range.diff, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("SODA3.3.1 SST Anoms 1997", adj = 0)

```

### Multi-Prod SST Anomalies

```{r}
##1997 test case

#post sst anom interpolation
anom.absmax <- max(abs(mean_sst), na.rm = TRUE)
anom.range <- c(-anom.absmax, anom.absmax)
#color/breaks
cols.ryb <- rev(colorRampPalette(brewer.pal(11, "RdYlBu"))(12))
breaks.dumb <- c(anom.range[1], seq(-1,1, 0.2), anom.range[2])
leg.brks2 <- seq(-1.2, 1.2, 0.2) 

#1997 SON anom detrended (as a test case)
k <- 16

#
setwd("~/CO_AUS/Aus_CO-main/pIOD/Figures")

png(filename = "sst1997anom_test.png", width = 2400, height = 1600, res = 250)
par(mar = c(7, 5, 2, 5), mgp = c(2.25, 1, 0))
image(list(x = lon.wide, y = lat.wide, z = mean_sst[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = anom.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
rect(40, -5, 100, 5, border = "black", lwd = 2)
title("SST Anoms 1997", adj = 0)
dev.off()


#pre sst anom interpolation
nt <- 34
ny <- 41
nx <- 91

#GODAS
temp1 <- array(sst.full.avg, dim = c(nt, ny, nx))  # from [nt, ny*nx] to [nt, ny, nx]
sst.anom.base <- aperm(temp1, c(3, 2, 1))  # from [nt, ny, nx] to [nx, ny, nt]

anom.absmax <- max(abs(sst.anom.base), na.rm = TRUE)
anom.range <- c(-anom.absmax, anom.absmax)
#color/breaks
cols.ryb <- rev(colorRampPalette(brewer.pal(11, "RdYlBu"))(12))
breaks.dumb <- c(anom.range[1], seq(-1,1, 0.2), anom.range[2])
leg.brks2 <- seq(-1.2, 1.2, 0.2) 

#1997 SON anom detrended (as a test case)
k <- 16

#
image(list(x = lon.wide, y = lat.wide, z = sst.anom.base[,,k]), 
           col = cols.ryb, breaks = breaks.dumb, zlim = anom.range, 
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("SST Anoms 1997", adj = 0)

#diff
sst.diff <- sst.anom.base[,,k] - mean_sst[,,k]

imagePlot(list(x = lon.wide, y = lat.wide, z = sst.diff), 
           col = cols.ryb,
           xlab = "Lon", ylab = "Lat",
           axes = FALSE)
axis(1, at = c(60, 90, 120))  
axis(2)                      
box()
world(add=TRUE, lwd = 1)
title("SST Anoms 1997", adj = 0)

```



## SON Detrending



