---
title: "IOD_sst_prep"
author: "Ryan Peterson"
date: "2025-08-22"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r library}
#.nc files
suppressMessages(library(ncdf4))
suppressMessages(library(terra))

# date/data mgmt
suppressMessages(library(lubridate))
suppressMessages(library(abind))

#visualization and interpolation
suppressMessages(library(fields))
suppressMessages(library(colorspace))
suppressMessages(library(RColorBrewer))
suppressMessages(library(scales)) #for adjusting opacity
```

Data Prep file for the following reanalysis products:

1. GODAS (NCEP Global Ocean Data Assimilation System from 1980 to 2019)
  a. Resolution:
2. ORA-S5 (ECMWF Ocean Reanalysis System 5 from 1979 to 2018)
  a. Resolution
3. OISST v2 (NOAA Optimum Interpolation SST version 2 from 1982 to 2019)
  a. Resolution
4. SODA3.3.1 (Simple Ocean Data Assimilation version 3.3.1 from 1980 to 2015)
  a. Resolution


Goal: be able to produce flexible (wrt spatial grid and time) sst arrays for each data product

Note: we are moving all the associated EOF prep files to here then moving them elsewhere.

# Set-up

```{r ranges}
#indian ocean region
wide_maxLon <- 120
wide_minLon <- 30
wide_maxLat <- 20
wide_minLat <- -20

#DMI west/WTIO (50, -10) X (70, 10) 
wDMI_maxLon <- 70
wDMI_minLon <- 50
wDMI_maxLat <- 10
wDMI_minLat <- -10

#DMI east/SETIO (90, -10) X (110, 0)
eDMI_maxLon <- 110
eDMI_minLon <- 90
eDMI_maxLat <- 0
eDMI_minLat <- -10

#pIOD (40, -5) X (100, 5)
pIOD_maxLon <- 100
pIOD_minLon <- 40 
pIOD_maxLat <- 5
pIOD_minLat <- -5

```

```{r grid_points}
#setup grid points for 1x1 degree resolution.
#lon.wide <- seq(wide_minLon+0.5, wide_maxLon-0.5, by = 1)
#lat.wide <- seq(wide_minLat+0.5, wide_maxLat-0.5, by = 1)

lon.wide <- seq(wide_minLon, wide_maxLon, by = 1)
lat.wide <- seq(wide_minLat, wide_maxLat, by = 1)

#grid list from 
grid.list <- list(x = lon.wide,
                  y = lat.wide)


#TODO: rm() region boundaries after all the points and ranges are setup
```


# GODAS

```{r GODAS_import}
setwd("~/CO_AUS/Aus_CO-main")

#GODAS data only (yearly .nc 1982-2015)
#1982
nc.GODAS.1982 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1982.nc")

#1983
nc.GODAS.1983 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1983.nc")

#1984
nc.GODAS.1984 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1984.nc")

#1985
nc.GODAS.1985 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1985.nc")

#1986
nc.GODAS.1986 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1986.nc")

#1987
nc.GODAS.1987 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1987.nc")

#1988
nc.GODAS.1988 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1988.nc")

#1989
nc.GODAS.1989 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1989.nc")

#1990
nc.GODAS.1990 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1990.nc")

#1991
nc.GODAS.1991 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1991.nc")

#1992
nc.GODAS.1992 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1992.nc")

#1993
nc.GODAS.1993 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1993.nc")

#1994
nc.GODAS.1994 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1994.nc")

#1995
nc.GODAS.1995 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1995.nc")

#1996
nc.GODAS.1996 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1996.nc")

#1997
nc.GODAS.1997 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1997.nc")

#1998
nc.GODAS.1998 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1998.nc")

#1999
nc.GODAS.1999 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1999.nc")

#2000
nc.GODAS.2000 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2000.nc")

#2001
nc.GODAS.2001 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2001.nc")

#2002
nc.GODAS.2002 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2002.nc")

#2003
nc.GODAS.2003 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2003.nc")

#2004
nc.GODAS.2004 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2004.nc")

#2005
nc.GODAS.2005 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2005.nc")

#2006
nc.GODAS.2006 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2006.nc")

#2007
nc.GODAS.2007 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2007.nc")

#2008
nc.GODAS.2008 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2008.nc")

#2009
nc.GODAS.2009 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2009.nc")

#2010
nc.GODAS.2010 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2010.nc")

#2011
nc.GODAS.2011 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2011.nc")

#2012
nc.GODAS.2012 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2012.nc")

#2013
nc.GODAS.2013 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2013.nc")

#2014
nc.GODAS.2014 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2014.nc")

#2015
nc.GODAS.2015 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2015.nc")

```

```{r additional_GODAS_import}
#include back to 1980
#1980
nc.GODAS.1980 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1980.nc")

#1981
nc.GODAS.1981 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.1981.nc")

#include up to 2019
#2016
nc.GODAS.2016 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2016.nc")

#2017
nc.GODAS.2017 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2017.nc")

#2018
nc.GODAS.2018 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2018.nc")

#2019
nc.GODAS.2019 <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/pottmp.2019.nc")
```


## GODAS Functions

```{r prep_functions}
#sorting/extraction of godas .nc data
godas_prep <- function(nc.data){
  
  #extract lon.lat
  lon.grid.temp <- nc.data[["dim"]][["lon"]][["vals"]]
  lat.grid.temp <- nc.data[["dim"]][["lat"]][["vals"]]
  
  #reorder lon for 
  lon.grid.temp[lon.grid.temp >= 180] <- lon.grid.temp[lon.grid.temp >= 180] - 360
  lon.order.temp <- order(lon.grid.temp)
  
  lon.grid.temp <- lon.grid.temp[lon.order.temp]
  
  #reorder lat
  lat.order.temp <- order(lat.grid.temp, decreasing = TRUE)
  lat.grid.temp <- lat.grid.temp[lat.order.temp]
  
  #times for months
  times.temp <- ncvar_get(nc.data, "time") # days since 1800-01-01 00:00:0.0
  times.temp <- as_datetime("1800-01-01T00:00:00") + days(times.temp)
  
  #temps, as array (lon, lat, level, time)
  #TODO adjust from K to c (K - 273.15)
  sst.temp <- ncvar_get(nc.data, "pottmp")
  sst.temp <- sst.temp[lon.order.temp, lat.order.temp, 1, ] #level: depth 5m
  
  #adjust to C from K (c = K - 273.15)
  sst.temp <- sst.temp - 273.15
  
  #return lon, lat, time, sst
  return(list(
    lon = lon.grid.temp,
    lat = lat.grid.temp,
    time = times.temp,
    sst = sst.temp
  ))
}


```

## GODAS Data Setup

```{r data_cleaning}
#data cleaning 
godas_list <- list(nc.GODAS.1982, nc.GODAS.1983, nc.GODAS.1984, nc.GODAS.1985, nc.GODAS.1986, 
                   nc.GODAS.1987, nc.GODAS.1988, nc.GODAS.1989, nc.GODAS.1990, nc.GODAS.1991,
                   nc.GODAS.1992, nc.GODAS.1993, nc.GODAS.1994, nc.GODAS.1995, nc.GODAS.1996,
                   nc.GODAS.1997, nc.GODAS.1998, nc.GODAS.1999, nc.GODAS.2000, nc.GODAS.2001,
                   nc.GODAS.2002, nc.GODAS.2003, nc.GODAS.2004, nc.GODAS.2005, nc.GODAS.2006,
                   nc.GODAS.2007, nc.GODAS.2008, nc.GODAS.2009, nc.GODAS.2010, nc.GODAS.2011,
                   nc.GODAS.2012, nc.GODAS.2013, nc.GODAS.2014, nc.GODAS.2015)

#get lon, lat, sst, and times
sst.GODAS.new <- NULL
for (i in 1:length(godas_list)) {
  nc.temp <- godas_list[[i]] 
  
  temp.nc.godas <- godas_prep(nc.temp)
  temp.lon <- temp.nc.godas$lon
  temp.lat <- temp.nc.godas$lat
  temp.sst <- temp.nc.godas$sst
  
  #get reduce range (indian ocean region)
  new.lon <- temp.lon[temp.lon <= wide_maxLon & temp.lon >= wide_minLon]
  lon.range <- range(which(temp.lon <= wide_maxLon & temp.lon >= wide_minLon))
  new.lat <- temp.lat[temp.lat <= wide_maxLat & temp.lat >= wide_minLat]
  lat.range <- range(which(temp.lat <= wide_maxLat & temp.lat >= wide_minLat))
  
  new.sst <- temp.sst[lon.range[1]:lon.range[2], lat.range[1]:lat.range[2], ]
  
  #interpolate to 1x1 grid
  sst.godas.interp <- NULL
  for (j in 1:dim(new.sst)[3]) {
    obj.godas <- list(x = new.lon, y = rev(new.lat), z = new.sst[,,j])
  
    interp.out <-  interp.surface.grid(obj.godas, grid.list)
    
    sst.godas.interp <- abind(sst.godas.interp, interp.out$z[ ,ncol(interp.out$z):1 ], along = 3)
  }
  sst.GODAS.new <- abind(sst.GODAS.new, sst.godas.interp, along = 3)
}

rm(nc.GODAS.1982, nc.GODAS.1983, nc.GODAS.1984, nc.GODAS.1985, nc.GODAS.1986, 
                   nc.GODAS.1987, nc.GODAS.1988, nc.GODAS.1989, nc.GODAS.1990, nc.GODAS.1991,
                   nc.GODAS.1992, nc.GODAS.1993, nc.GODAS.1994, nc.GODAS.1995, nc.GODAS.1996,
                   nc.GODAS.1997, nc.GODAS.1998, nc.GODAS.1999, nc.GODAS.2000, nc.GODAS.2001,
                   nc.GODAS.2002, nc.GODAS.2003, nc.GODAS.2004, nc.GODAS.2005, nc.GODAS.2006,
                   nc.GODAS.2007, nc.GODAS.2008, nc.GODAS.2009, nc.GODAS.2010, nc.GODAS.2011,
                   nc.GODAS.2012, nc.GODAS.2013, nc.GODAS.2014, nc.GODAS.2015)


dim(sst.GODAS.new)

setwd("~/CO_AUS/Aus_CO-main/pIOD")
save(sst.GODAS.new, file = "sstGODAS.rda")

```


# ORA-S5

```{r oras_import}
#import some of the associated data
setwd("~/CO_AUS/Aus_CO-main")

#ORAS5
##1982
#sept 1982
nc.ORAS.1982s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198209_CONS_v0.1.nc")
#oct 1982
nc.ORAS.1982o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198210_CONS_v0.1.nc")
#nov 1982
nc.ORAS.1982n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198211_CONS_v0.1.nc")

##1983
#sept 1983
nc.ORAS.1983s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198309_CONS_v0.1.nc")
#oct 1983
nc.ORAS.1983o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198310_CONS_v0.1.nc")
#nov 1983
nc.ORAS.1983n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198311_CONS_v0.1.nc")

##1984
#sept 1984
nc.ORAS.1984s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198409_CONS_v0.1.nc")
#oct 1984
nc.ORAS.1984o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198410_CONS_v0.1.nc")
#nov 1984
nc.ORAS.1984n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198411_CONS_v0.1.nc")

##1985
#sept 1985
nc.ORAS.1985s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198509_CONS_v0.1.nc")
#oct 1985
nc.ORAS.1985o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198510_CONS_v0.1.nc")
#nov 1985
nc.ORAS.1985n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198511_CONS_v0.1.nc")

##1986
#sept 1986
nc.ORAS.1986s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198609_CONS_v0.1.nc")
#oct 1986
nc.ORAS.1986o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198610_CONS_v0.1.nc")
#nov 1986
nc.ORAS.1986n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198611_CONS_v0.1.nc")

##1987
#sept 1987
nc.ORAS.1987s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198709_CONS_v0.1.nc")
#oct 1987
nc.ORAS.1987o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198710_CONS_v0.1.nc")
#nov 1987
nc.ORAS.1987n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198711_CONS_v0.1.nc")

##1988
#sept 1988
nc.ORAS.1988s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198809_CONS_v0.1.nc")
#oct 1988
nc.ORAS.1988o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198810_CONS_v0.1.nc")
#nov 1988
nc.ORAS.1988n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198811_CONS_v0.1.nc")

##1989
#sept 1989
nc.ORAS.1989s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198909_CONS_v0.1.nc")
#oct 1989
nc.ORAS.1989o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198910_CONS_v0.1.nc")
#nov 1989
nc.ORAS.1989n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_198911_CONS_v0.1.nc")

##1990
#sept 1990
nc.ORAS.1990s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199009_CONS_v0.1.nc")
#oct 1990
nc.ORAS.1990o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199010_CONS_v0.1.nc")
#nov 1990
nc.ORAS.1990n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199011_CONS_v0.1.nc")

##1991
#sept 1991
nc.ORAS.1991s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199109_CONS_v0.1.nc")
#oct 1991
nc.ORAS.1991o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199110_CONS_v0.1.nc")
#nov 1991
nc.ORAS.1991n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199111_CONS_v0.1.nc")

##1992
#sept 1992
nc.ORAS.1992s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199209_CONS_v0.1.nc")
#oct 1992
nc.ORAS.1992o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199210_CONS_v0.1.nc")
#nov 1992
nc.ORAS.1992n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199211_CONS_v0.1.nc")

##1993
#sept 1993
nc.ORAS.1993s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199309_CONS_v0.1.nc")
#oct 1993
nc.ORAS.1993o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199310_CONS_v0.1.nc")
#nov 1993
nc.ORAS.1993n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199311_CONS_v0.1.nc")

##1994
#sept 1994
nc.ORAS.1994s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199409_CONS_v0.1.nc")
#oct 1994
nc.ORAS.1994o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199410_CONS_v0.1.nc")
#nov 1994
nc.ORAS.1994n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199411_CONS_v0.1.nc")

##1995
#sept 1995
nc.ORAS.1995s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199509_CONS_v0.1.nc")
#oct 1995
nc.ORAS.1995o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199510_CONS_v0.1.nc")
#nov 1995
nc.ORAS.1995n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199511_CONS_v0.1.nc")

##1996
#sept 1996
nc.ORAS.1996s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199609_CONS_v0.1.nc")
#oct 1996
nc.ORAS.1996o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199610_CONS_v0.1.nc")
#nov 1996
nc.ORAS.1996n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199611_CONS_v0.1.nc")

##1997
#sept 1997
nc.ORAS.1997s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199709_CONS_v0.1.nc")
#oct 1997
nc.ORAS.1997o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199710_CONS_v0.1.nc")
#nov 1997
nc.ORAS.1997n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199711_CONS_v0.1.nc")

##1998
#sept 1998
nc.ORAS.1998s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199809_CONS_v0.1.nc")
#oct 1998
nc.ORAS.1998o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199810_CONS_v0.1.nc")
#nov 1998
nc.ORAS.1998n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199811_CONS_v0.1.nc")

##1999
#sept 1999
nc.ORAS.1999s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199909_CONS_v0.1.nc")
#oct 1999
nc.ORAS.1999o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199910_CONS_v0.1.nc")
#nov 1999
nc.ORAS.1999n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_199911_CONS_v0.1.nc")

##2000
#sept 2000
nc.ORAS.2000s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200009_CONS_v0.1.nc")
#oct 2000
nc.ORAS.2000o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200010_CONS_v0.1.nc")
#nov 2000
nc.ORAS.2000n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200011_CONS_v0.1.nc")

##2001
#sept 2001
nc.ORAS.2001s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200109_CONS_v0.1.nc")
#oct 2001
nc.ORAS.2001o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200110_CONS_v0.1.nc")
#nov 2001
nc.ORAS.2001n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200111_CONS_v0.1.nc")

##2002
#sept 2002
nc.ORAS.2002s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200209_CONS_v0.1.nc")
#oct 2002
nc.ORAS.2002o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200210_CONS_v0.1.nc")
#nov 2002
nc.ORAS.2002n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200211_CONS_v0.1.nc")

##2003
#sept 2003
nc.ORAS.2003s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200309_CONS_v0.1.nc")
#oct 2003
nc.ORAS.2003o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200310_CONS_v0.1.nc")
#nov 2003
nc.ORAS.2003n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200311_CONS_v0.1.nc")

##2004
#sept 2004
nc.ORAS.2004s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200409_CONS_v0.1.nc")
#oct 2004
nc.ORAS.2004o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200410_CONS_v0.1.nc")
#nov 2004
nc.ORAS.2004n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200411_CONS_v0.1.nc")

##2005
#sept 2005
nc.ORAS.2005s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200509_CONS_v0.1.nc")
#oct 2005
nc.ORAS.2005o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200510_CONS_v0.1.nc")
#nov 2005
nc.ORAS.2005n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200511_CONS_v0.1.nc")

##2006
#sept 2006
nc.ORAS.2006s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200609_CONS_v0.1.nc")
#oct 2006
nc.ORAS.2006o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200610_CONS_v0.1.nc")
#nov 2006
nc.ORAS.2006n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200611_CONS_v0.1.nc")

##2007
#sept 2007
nc.ORAS.2007s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200709_CONS_v0.1.nc")
#oct 2007
nc.ORAS.2007o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200710_CONS_v0.1.nc")
#nov 2007
nc.ORAS.2007n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200711_CONS_v0.1.nc")

##2008
#sept 2008
nc.ORAS.2008s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200809_CONS_v0.1.nc")
#oct 2008
nc.ORAS.2008o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200810_CONS_v0.1.nc")
#nov 2008
nc.ORAS.2008n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200811_CONS_v0.1.nc")

##2009
#sept 2009
nc.ORAS.2009s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200909_CONS_v0.1.nc")
#oct 2009
nc.ORAS.2009o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200910_CONS_v0.1.nc")
#nov 2009
nc.ORAS.2009n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_200911_CONS_v0.1.nc")

##2010
#sept 2010
nc.ORAS.2010s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201009_CONS_v0.1.nc")
#oct 2010
nc.ORAS.2010o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201010_CONS_v0.1.nc")
#nov 2010
nc.ORAS.2010n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201011_CONS_v0.1.nc")

##2011
#sept 2011
nc.ORAS.2011s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201109_CONS_v0.1.nc")
#oct 2011
nc.ORAS.2011o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201110_CONS_v0.1.nc")
#nov 2011
nc.ORAS.2011n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201111_CONS_v0.1.nc")

##2012
#sept 2012
nc.ORAS.2012s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201209_CONS_v0.1.nc")
#oct 2012
nc.ORAS.2012o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201210_CONS_v0.1.nc")
#nov 2012
nc.ORAS.2012n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201211_CONS_v0.1.nc")

##2013
#sept 2013
nc.ORAS.2013s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201309_CONS_v0.1.nc")
#oct 2013
nc.ORAS.2013o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201310_CONS_v0.1.nc")
#nov 2013
nc.ORAS.2013n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201311_CONS_v0.1.nc")

##2014
#sept 2014
nc.ORAS.2014s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201409_CONS_v0.1.nc")
#oct 2014
nc.ORAS.2014o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201410_CONS_v0.1.nc")
#nov 2014
nc.ORAS.2014n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201411_CONS_v0.1.nc")

##2015
#sept 2015
nc.ORAS.2015s <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201509_OPER_v0.1.nc")
#oct 2015
nc.ORAS.2015o <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201510_OPER_v0.1.nc")
#nov 2015
nc.ORAS.2015n <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/ORAS5/sosstsst_control_monthly_highres_2D_201511_OPER_v0.1.nc")

#TODO: add in years 2016-2019

```






# OISST v2

('default' data product: use as a template for other products )

```{r load_data}
setwd("~/CO_AUS/Aus_CO-main")

#begin easy with monthly OISST
nc.OISST.month <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/sst.mnmean.nc")

#OISST land sea mask
nc.OISST.lsm <- nc_open("~/CO_AUS/Aus_CO-main/pIOD/Data/lsmask.nc")
```

## Test Section - (Move and) Delete when done


```{r}
#extract lon, lat
lat.grid <- nc.OISST.month[["dim"]][["lat"]][["vals"]]
lon.grid <- nc.OISST.month[["dim"]][["lon"]][["vals"]]

#reorder lon
lon.grid[lon.grid >= 180] <- lon.grid[lon.grid >= 180] - 360
this.order <- order(lon.grid)

lon.grid <- lon.grid[this.order]

#time data
times <- ncvar_get(nc.OISST.month, "time") # days since 1800-01-01 00:00:0.0
times <- as_datetime("1800-01-01T00:00:00") + days(times)

#sst data, as array (lon, lat, time)
sst.oisst <- ncvar_get(nc.OISST.month, "sst")
sst.oisst <- sst.oisst[this.order, , ]

#get reduced indian ocean region
lat.values <- lat.grid[lat.grid <= wide_maxLat & lat.grid >= wide_minLat]
lat.range <- range(which(lat.grid <= wide_maxLat & lat.grid >= wide_minLat))

lon.values <- lon.grid[lon.grid <= wide_maxLon & lon.grid >= wide_minLon]
lon.range <- range(which(lon.grid <= wide_maxLon & lon.grid >= wide_minLon))

#get OISST SST reduced matrix
sst.OISST.new <- sst.oisst[lon.range[1]:lon.range[2], lat.range[1]:lat.range[2], ]


```


# SODA3.3.1



# Figures

(compare data products)


```{r}
#GODAS test
sst.godas.test <- sst.GODAS.new[,,9]

#absmax <- max(abs(sst.godas.test), na.rm = TRUE)
sst.range <- range(sst.GODAS.new, na.rm = TRUE)

cols.ryb <- rev(colorRampPalette(brewer.pal(11, "RdYlBu"))(24))
breaks.sst <- seq(sst.range[1], sst.range[2], length.out = length(cols.ryb) + 1)

imagePlot(list(x = lon.wide, y = lat.wide, z = sst.godas.test), 
           col = cols.ryb, breaks = breaks.sst, zlim = sst.range,
           xlab = "Lon", ylab = "Lat")
world(add = TRUE)

#ORAS test

```

