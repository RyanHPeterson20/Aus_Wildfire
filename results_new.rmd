---
title: "results_new"
author: "Ryan Peterson"
date: "2025-06-24"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r library}
suppressMessages( library( lubridate))

suppressMessages( library(smacof)) #MDS

suppressMessages( library(fields))
```

```{r data_functions}
setwd("~/CO_AUS/Aus_CO-main/Interactions")

load( "Data/ne_data.rda")
load( "Data/se_data.rda")
load( "Data/bounded_data.rda")
load( "Data/data_matrix.rda")
load( "Data/lag_list.rda")

source("group_functionsNew.R") #New grouping/clustering
```

```{r data_setup}
#season years/weeks
season_weeks <- c(35:52, 1:14)
season_years <- unique(bounded_resp_df$year)

seasons <- c()
for (i in 1:(length(season_years)-1)) {
  temp_season <- paste0(season_years[i], "-", season_years[i+1])
  #print(temp_season)  
  seasons <- c(seasons, temp_season)
}
rm(i, temp_season)

#center response data
NEbase_matrix <- scale(resp_matrix[ ,1:32], center = TRUE, scale = FALSE)
SEbase_matrix <- scale(resp_matrix[ ,33:64], center = TRUE, scale = FALSE)

#Below includes removal of weeks 35-37 (adjust grouping functions if we need to change this.)
#NEAus
NEAus_1 <- NEbase_matrix[ ,4:12] 
NEAus_2 <- NEbase_matrix[ ,13:17]
NEAus_3 <- NEbase_matrix[ ,18:32]

#NEAus
SEAus_1 <- SEbase_matrix[ ,4:16] 
SEAus_2 <- SEbase_matrix[ ,17:20] 
SEAus_3 <- SEbase_matrix[ ,21:32]

NEAus_mat <- list(NEAus_1, NEAus_2, NEAus_3)
SEAus_mat <- list(SEAus_1, SEAus_2, SEAus_3)

rm(NEAus_1, NEAus_2, NEAus_3, SEAus_1, SEAus_2, SEAus_3)

#full model
NEpreds <- NElag_3group(NE_laglist = NE_laglist_std, j = 1:19)
NEresp <- NEresp_3group(NEAus_mat = NEAus_mat, j = 1:19)

SEpreds <- SElag_3group(SE_laglist = SE_laglist_std, j = 1:19)
SEresp <- SEresp_3group(SEAus_mat = SEAus_mat, j = 1:19)

#partial model
NEpreds_part <- NElag_3group(NE_laglist = NE_laglist_std, j = -c(19))
NEresp_part <- NEresp_3group(NEAus_mat = NEAus_mat, j = -c(19))

SEpreds_part <- SElag_3group(SE_laglist = SE_laglist_std, j = -c(19))
SEresp_part <- SEresp_3group(SEAus_mat = SEAus_mat, j = -c(19))
```


Updated Figures

1. Data Figures
2. Clustering Figures
3. Correlation Figures
...
n. Model Results


# 1. Data Figures

```{r proposed}

y_lim <- c(-25, max(NEbase_matrix, SEbase_matrix))

setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "boxdata_cuts.png", width = 2600, height = 1800, res = 200)
set.panel(2,1)
boxplot(NEbase_matrix, ylim = y_lim, ylab = "Atmospheric CO", xlab = "Week",
        axes = FALSE, pch = 20, 
        cex.main = 1.5, cex.lab = 1.25, cex.axis = 1.5)
box()
axis(2)
axis(1, at = 1:32, labels = c(season_weeks),
     las = 3, cex.axis = 1.6)
abline(h = 0, lty = 2)
title("NE Aus", adj = 0, cex.main = 1.5)
abline(v = c(3.5, 29.5), lty =2, col = "red")
#text(1.5, -22, "Group 1", col = "red", cex =1)
#text(8.5, -22, "Group 2", col = "red", cex = 1)
#text(22.5, -22, "Group 1", col = "red", cex = 1)


boxplot(SEbase_matrix, ylim = y_lim, ylab = "Atmospheric CO", xlab = "Week",
        axes = FALSE, pch = 20, 
        cex.main = 1.5, cex.lab = 1.25, cex.axis = 1.5)
box()
axis(2)
axis(1, at = 1:32, labels = c(season_weeks),
     las = 3, cex.axis = 1.6)
abline(h = 0, lty = 2)
abline(v = c(3.5, 29.5), lty =2, col = "red")
title("SE Aus", adj = 0, cex.main = 1.5)
#text(1.5, -22, "Group 1", col = "red", cex =1)
#text(10.5, -22, "Group 2", col = "red", cex = 1)
#text(22.5, -22, "Group 1", col = "red", cex = 1)

dev.off()
```


# 2. Clustering Figures

Some goals here:
1. Show that our boundary changes are supported against a baseline full wildfire season.

## Hierarchical Clustering

Baseline (full season)
Cut Early (remove weeks 35-37)
Cut Late (remove weeks 12-14)
Cut Both (remove weeks 35-37 and 12-14)

```{r base_clustering}
#baseline (full wildfire season)
#distance
NEd2_base <- dist(t(NEbase_matrix), method = "euclidean")
SEd2_base <- dist(t(SEbase_matrix), method = "euclidean")

#clustering
NEhc_base <- constr.hclust(NEd2_base, method = "ward.D2", chron = TRUE)
SEhc_base <- constr.hclust(SEd2_base, method = "ward.D2", chron = TRUE)

#groups
NEcut3_base <- cutree(NEhc_base, k = 3)
SEcut3_base <- cutree(SEhc_base, k = 3)

#dendrogram 
#re-order cluster
NEhc_base$order <- c(1:32)
SEhc_base$order <- c(1:32)

setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")
png(filename = "NEdend_base.png", width = 3600, height = 1200, res = 300)
stats:::plot.hclust(NEhc_base,  hang = -1, labels = FALSE, bty = "n", sub = "", ylab = "",
                    xlab = "Week", main = "NE Aus : Response Clustering", axes = FALSE, cex.main = 1.1,
                    cex.lab = 1.1)
axis(2)
axis(1, at = 1:32, labels = c(season_weeks[c(1:32)]), 
     las = 3, gap.axis = 0, tck = 0.5, lty = 0, cex.axis = 1.1)
rect(xleft = 0.5, xright = 12.5, ybottom = 0, ytop = 70, col = rgb(1, 0, 0, 0.2), border = NA)
rect(xleft = 12.5, xright = 17.5, ybottom = 0, ytop = 70, col = rgb(0, 1, 0, 0.2), border = NA)
rect(xleft = 17.5, xright = 32.5, ybottom = 0, ytop = 70, col = rgb(0, 0, 1, 0.2), border = NA)
text(6.7, -5.6, "Group 1", col = "black", cex = 1.1, xpd = TRUE)
text(15.5, -5.6, "Group 2", col = "black", cex = 1.1, xpd = TRUE)
text(24.5, -5.6, "Group 3", col = "black", cex = 1.1, xpd = TRUE)
#rect.hclust(NEhc_agg2, k = 2, border = 2:3)
dev.off()


png(filename = "SEdend_base.png", width = 3600, height = 1200, res = 300)
stats:::plot.hclust(SEhc_base, hang = -1, labels = FALSE, bty = "n", sub = "", ylab = "",
                    xlab = "Week", main = "SE Aus : Response Clustering", axes = FALSE, cex.main = 1.1,
                    cex.lab = 1.1)
axis(2)
axis(1, at = 1:32, labels = c(season_weeks[c(1:32)]), 
     las = 3, gap.axis = 0, tck = 0.5, lty = 0, cex.axis = 1.1)
rect(xleft = 0.5, xright = 16.5, ybottom = 0, ytop = 70, col = rgb(1, 0, 0, 0.2), border = NA)
rect(xleft = 16.5, xright = 20.5, ybottom = 0, ytop = 70, col = rgb(0, 1, 0, 0.2), border = NA)
rect(xleft = 20.5, xright = 32.5, ybottom = 0, ytop = 70, col = rgb(0, 0, 1, 0.2), border = NA)
text(8.5, -5.6, "Group 1", col = "black", cex = 1.1, xpd = TRUE)
text(18.5, -5.6, "Group 2", col = "black", cex = 1.1, xpd = TRUE)
text(25.5, -5.6, "Group 3", col = "black", cex = 1.1, xpd = TRUE)
#rect.hclust(SEhc_agg2, k = 2, border = 2:5)
dev.off()

```


```{r early_cuts}
#removal of weeks 35-37 from the wildfire season.
#Removing 35-37
NEbase_matrix1 <- NEbase_matrix[ ,-c(1:3)]
SEbase_matrix1 <- SEbase_matrix[ ,-c(1:3)]
season_weeks1 <- c(38:52, 1:14)

NEd2.1 <- dist(t(NEbase_matrix1), method = "euclidean")
SEd2.1 <- dist(t(SEbase_matrix1), method = "euclidean")

#clustering
NEhc.1 <- constr.hclust(NEd2.1, method = "ward.D2", chron = TRUE)
SEhc.1 <- constr.hclust(SEd2.1, method = "ward.D2", chron = TRUE)

#groups
NEcut3.1 <- cutree(NEhc.1, k = 3)
SEcut3.1 <- cutree(SEhc.1, k = 3)

#TODO: add in dendrogram
NEhc.1$order <- c(1:29)
SEhc.1$order <- c(1:29)

setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")
png(filename = "NEdend_early.png", width = 3600, height = 1200, res = 300)
stats:::plot.hclust(NEhc.1,  hang = -1, labels = FALSE, bty = "n", sub = "", ylab = "",
                    xlab = "Week", main = "NE Aus : Response Clustering", axes = FALSE, cex.main = 1.1,
                    cex.lab = 1.1)
axis(2)
axis(1, at = 1:29, labels = c(season_weeks1[c(1:29)]), 
     las = 3, gap.axis = 0, tck = 0.5, lty = 0, cex.axis = 1.1)
rect(xleft = 0.5, xright = 9.5, ybottom = 0, ytop = 68, col = rgb(1, 0, 0, 0.2), border = NA)
rect(xleft = 9.5, xright = 14.5, ybottom = 0, ytop = 68, col = rgb(0, 1, 0, 0.2), border = NA)
rect(xleft = 14.5, xright = 32.5, ybottom = 0, ytop = 68, col = rgb(0, 0, 1, 0.2), border = NA)
text(4.7, -5.6, "Group 1", col = "black", cex = 1.1, xpd = TRUE)
text(12, -5.6, "Group 2", col = "black", cex = 1.1, xpd = TRUE)
text(22, -5.6, "Group 3", col = "black", cex = 1.1, xpd = TRUE)
dev.off()


png(filename = "SEdend_early.png", width = 3600, height = 1200, res = 300)
stats:::plot.hclust(SEhc.1, hang = -1, labels = FALSE, bty = "n", sub = "", ylab = "",
                    xlab = "Week", main = "SE Aus : Response Clustering", axes = FALSE, cex.main = 1.1,
                    cex.lab = 1.1)
axis(2)
axis(1, at = 1:29, labels = c(season_weeks1[c(1:29)]), 
     las = 3, gap.axis = 0, tck = 0.5, lty = 0, cex.axis = 1.1)
rect(xleft = 0.5, xright = 13.5, ybottom = 0, ytop = 70, col = rgb(1, 0, 0, 0.2), border = NA)
rect(xleft = 13.5, xright = 17.5, ybottom = 0, ytop = 70, col = rgb(0, 1, 0, 0.2), border = NA)
rect(xleft = 17.5, xright = 29.5, ybottom = 0, ytop = 70, col = rgb(0, 0, 1, 0.2), border = NA)
text(6.5, -5.6, "Group 1", col = "black", cex = 1.1, xpd = TRUE)
text(15.5, -5.6, "Group 2", col = "black", cex = 1.1, xpd = TRUE)
text(23.5, -5.6, "Group 3", col = "black", cex = 1.1, xpd = TRUE)
dev.off()
```


```{r late_cuts}
#Removing 12-14
NEbase_matrix2 <- NEbase_matrix[ ,-c(30:32)]
SEbase_matrix2 <- SEbase_matrix[ ,-c(30:32)]
season_weeks2 <- c(35:52, 1:11)

NEd2.2 <- dist(t(NEbase_matrix2), method = "euclidean")
SEd2.2 <- dist(t(SEbase_matrix2), method = "euclidean")

#clustering
NEhc.2 <- constr.hclust(NEd2.2, method = "ward.D2", chron = TRUE)
SEhc.2 <- constr.hclust(SEd2.2, method = "ward.D2", chron = TRUE)

#groups
NEcut3.2 <- cutree(NEhc.2, k = 3)
SEcut3.2 <- cutree(SEhc.2, k = 3)

#TODO: add in dendrogram
NEhc.2$order <- c(1:29)
SEhc.2$order <- c(1:29)

setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")
png(filename = "NEdend_late.png", width = 3600, height = 1200, res = 300)
stats:::plot.hclust(NEhc.2,  hang = -1, labels = FALSE, bty = "n", sub = "", ylab = "",
                    xlab = "Week", main = "NE Aus : Response Clustering", axes = FALSE, cex.main = 1.1,
                    cex.lab = 1.1)
axis(2)
axis(1, at = 1:29, labels = c(season_weeks2[c(1:29)]), 
     las = 3, gap.axis = 0, tck = 0.5, lty = 0, cex.axis = 1.1)
rect(xleft = 0.5, xright = 12.5, ybottom = 0, ytop = 70, col = rgb(1, 0, 0, 0.2), border = NA)
rect(xleft = 12.5, xright = 17.5, ybottom = 0, ytop = 70, col = rgb(0, 1, 0, 0.2), border = NA)
rect(xleft = 17.5, xright = 29.5, ybottom = 0, ytop = 70, col = rgb(0, 0, 1, 0.2), border = NA)
text(6.7, -5.6, "Group 1", col = "black", cex = 1.1, xpd = TRUE)
text(15, -5.6, "Group 2", col = "black", cex = 1.1, xpd = TRUE)
text(23.5, -5.6, "Group 3", col = "black", cex = 1.1, xpd = TRUE)
dev.off()

png(filename = "SEdend_late.png", width = 3600, height = 1200, res = 300)
stats:::plot.hclust(SEhc.2, hang = -1, labels = FALSE, bty = "n", sub = "", ylab = "",
                    xlab = "Week", main = "SE Aus : Response Clustering", axes = FALSE, cex.main = 1.1,
                    cex.lab = 1.1)
axis(2)
axis(1, at = 1:29, labels = c(season_weeks2[c(1:29)]), 
     las = 3, gap.axis = 0, tck = 0.5, lty = 0, cex.axis = 1.1)
rect(xleft = 0.5, xright = 16.5, ybottom = 0, ytop = 65, col = rgb(1, 0, 0, 0.2), border = NA)
rect(xleft = 16.5, xright = 20.5, ybottom = 0, ytop = 65, col = rgb(0, 1, 0, 0.2), border = NA)
rect(xleft = 20.5, xright = 29.5, ybottom = 0, ytop = 65, col = rgb(0, 0, 1, 0.2), border = NA)
text(8.5, -5.6, "Group 1", col = "black", cex = 1.1, xpd = TRUE)
text(18.5, -5.6, "Group 2", col = "black", cex = 1.1, xpd = TRUE)
text(25.5, -5.6, "Group 3", col = "black", cex = 1.1, xpd = TRUE)
dev.off()
```


```{r both_cuts}
#removing both (35-37, 12-14)
NEbase_matrix3 <- NEbase_matrix[ ,-c(1:3, 30:32)]
SEbase_matrix3 <- SEbase_matrix[ ,-c(1:3, 30:32)]
season_weeks3 <- c(38:52, 1:11)

NEd2.3 <- dist(t(NEbase_matrix3), method = "euclidean")
SEd2.3 <- dist(t(SEbase_matrix3), method = "euclidean")

#clustering
NEhc.3 <- constr.hclust(NEd2.3, method = "ward.D2", chron = TRUE)
SEhc.3 <- constr.hclust(SEd2.3, method = "ward.D2", chron = TRUE)

#groups
NEcut3.3 <- cutree(NEhc.3, k = 3)
SEcut3.3 <- cutree(SEhc.3, k = 3)

#TODO: add in dendrogram
NEhc.3$order <- c(1:26)
SEhc.3$order <- c(1:26)

setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")
png(filename = "NEdend_both.png", width = 3600, height = 1200, res = 300)
stats:::plot.hclust(NEhc.3,  hang = -1, labels = FALSE, bty = "n", sub = "", ylab = "",
                    xlab = "Week", main = "NE Aus : Response Clustering", axes = FALSE, cex.main = 1.1,
                    cex.lab = 1.1)
axis(2)
axis(1, at = 1:26, labels = c(season_weeks3[c(1:26)]), 
     las = 3, gap.axis = 0, tck = 0.5, lty = 0, cex.axis = 1.1)
rect(xleft = 0.5, xright = 9.5, ybottom = 0, ytop = 68, col = rgb(1, 0, 0, 0.2), border = NA)
rect(xleft = 9.5, xright = 14.5, ybottom = 0, ytop = 68, col = rgb(0, 1, 0, 0.2), border = NA)
rect(xleft = 14.5, xright = 26.5, ybottom = 0, ytop = 68, col = rgb(0, 0, 1, 0.2), border = NA)
text(4.7, -5.6, "Group 1", col = "black", cex = 1.1, xpd = TRUE)
text(12, -5.6, "Group 2", col = "black", cex = 1.1, xpd = TRUE)
text(20, -5.6, "Group 3", col = "black", cex = 1.1, xpd = TRUE)
dev.off()

png(filename = "SEdend_both.png", width = 3600, height = 1200, res = 300)
stats:::plot.hclust(SEhc.3, hang = -1, labels = FALSE, bty = "n", sub = "", ylab = "",
                    xlab = "Week", main = "SE Aus : Response Clustering", axes = FALSE, cex.main = 1.1,
                    cex.lab = 1.1)
axis(2)
axis(1, at = 1:26, labels = c(season_weeks1[c(1:26)]), 
     las = 3, gap.axis = 0, tck = 0.5, lty = 0, cex.axis = 1.1)
rect(xleft = 0.5, xright = 13.5, ybottom = 0, ytop = 70, col = rgb(1, 0, 0, 0.2), border = NA)
rect(xleft = 13.5, xright = 17.5, ybottom = 0, ytop = 70, col = rgb(0, 1, 0, 0.2), border = NA)
rect(xleft = 17.5, xright = 26.5, ybottom = 0, ytop = 70, col = rgb(0, 0, 1, 0.2), border = NA)
text(6.5, -5.6, "Group 1", col = "black", cex = 1.1, xpd = TRUE)
text(15.5, -5.6, "Group 2", col = "black", cex = 1.1, xpd = TRUE)
text(21.5, -5.6, "Group 3", col = "black", cex = 1.1, xpd = TRUE)
dev.off()

```


## Silhouette

A lot needs to be added in here:
-Base silhouette plots
-New boundary silhouette plots
-Iterate through boundary cuts:
--Create plot of group avg
--Create plot of diffs


```{r sil_function}

#fixed for specific hierarchy parameters
avg_sil <- function(resp_matrix) {
  
  #fixed euclidean distance
  euc_dist <- dist(t(resp_matrix), method = "euclidean")

  #clustering
  #fixed ward's and temp constraints
  hc_new <- constr.hclust(euc_dist, method = "ward.D2", chron = TRUE)
  #fixed 3 groups
  cut_agg3 <- cutree(hc_new, k = 3)
  
  sil_summary <- summary(silhouette(cut_agg3, euc_dist))
  
  #return df with group avg width and overall avg. width
  return(data.frame(t(sil_summary$clus.avg.widths), avg = sil_summary$avg.width))
}

```


```{r base_sil}
#NE AUS
NEagg_sil <- silhouette(NEcut3_base, NEd2_base)
plot(NEagg_sil, main = "")

pNE <- fviz_silhouette(NEagg_sil, label = TRUE, print.summary = FALSE)

pNE$labels$title <- "NE Aus Group silhouette"

#output plot
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEsil_base.png", width = 3200, height = 1600, res = 300)
pNE + scale_x_discrete(
      breaks = pNE$data$name,
      labels = season_weeks[as.integer(as.character(pNE$data$name))]
  ) +
  theme(axis.text.x = element_text(angle = 90, size = 10)) +
  xlab("Weeks")
dev.off()

#SE Aus
SEagg_sil <- silhouette(SEcut3_base, SEd2_base)
plot(SEagg_sil)
pSE <- fviz_silhouette(SEagg_sil, label = TRUE, print.summary = FALSE)

pSE$labels$title <- "SE Aus Group silhouette"

png(filename = "SEsil_base.png", width = 3200, height = 1600, res = 300)
pSE + scale_x_discrete(
      breaks = pSE$data$name,
      labels = season_weeks[as.integer(as.character(pSE$data$name))]
  ) +
  theme(axis.text.x = element_text(angle = 90, size = 10)) +
  xlab("Weeks")
dev.off()

```

```{r updated_sil}
#updated sil coefs for boundary removals

#cut weeks 35-37
#NE AUS
NEagg.1 <- silhouette(NEcut3.1, NEd2.1)
plot(NEagg.1, main = "")

pNE <- fviz_silhouette(NEagg.1, label = TRUE, print.summary = FALSE)
pNE$labels$title <- "NE Aus Group silhouette"
#output plot
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEsil_early.png", width = 3200, height = 1600, res = 300)
pNE + scale_x_discrete(
      breaks = pNE$data$name,
      labels = season_weeks1[as.integer(as.character(pNE$data$name))]
  ) +
  theme(axis.text.x = element_text(angle = 90, size = 10)) +
  xlab("Weeks")
dev.off()

#SE Aus
SEagg.1 <- silhouette(SEcut3.1, SEd2.1)
plot(SEagg.1, main = "")
pSE <- fviz_silhouette(SEagg.1, label = TRUE, print.summary = FALSE)
pSE$labels$title <- "SE Aus Group silhouette"
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "SEsil_early.png", width = 3200, height = 1600, res = 300)
pSE + scale_x_discrete(
      breaks = pSE$data$name,
      labels = season_weeks1[as.integer(as.character(pSE$data$name))]
  ) +
  theme(axis.text.x = element_text(angle = 90, size = 10)) +
  xlab("Weeks")
dev.off()

#cut late
#NE AUS
NEagg.2 <- silhouette(NEcut3.2, NEd2.2)
plot(NEagg.2, main = "")

pNE <- fviz_silhouette(NEagg.2, label = TRUE, print.summary = FALSE)
pNE$labels$title <- "NE Aus Group silhouette"

png(filename = "NEsil_late.png", width = 3200, height = 1600, res = 300)
pNE + scale_x_discrete(
      breaks = pNE$data$name,
      labels = season_weeks2[as.integer(as.character(pNE$data$name))]
  ) +
  theme(axis.text.x = element_text(angle = 90, size = 10)) +
  xlab("Weeks")
dev.off()

# SE Aus
SEagg.2 <- silhouette(SEcut3.2, SEd2.2)
plot(SEagg.2, main = "")

pSE <- fviz_silhouette(SEagg.2, label = TRUE, print.summary = FALSE)
pSE$labels$title <- "SE Aus Group silhouette"

png(filename = "SEsil_late.png", width = 3200, height = 1600, res = 300)
pSE + scale_x_discrete(
      breaks = pNE$data$name,
      labels = season_weeks2[as.integer(as.character(pSE$data$name))]
  ) +
  theme(axis.text.x = element_text(angle = 90, size = 10)) +
  xlab("Weeks")
dev.off()


#cut both
#NE AUS
NEagg.3 <- silhouette(NEcut3.3, NEd2.3)
plot(NEagg.3, main = "")

pNE <- fviz_silhouette(NEagg.3, label = TRUE, print.summary = FALSE)
pNE$labels$title <- "NE Aus Group silhouette"

png(filename = "NEsil_both.png", width = 3200, height = 1600, res = 300)
pNE + scale_x_discrete(
      breaks = pNE$data$name,
      labels = season_weeks3[as.integer(as.character(pNE$data$name))]
  ) +
  theme(axis.text.x = element_text(angle = 90, size = 10)) +
  xlab("Weeks")
dev.off()


#SE Aus
SEagg.3 <- silhouette(SEcut3.3, SEd2.3)
plot(SEagg.3, main = "")

pSE <- fviz_silhouette(SEagg.3, label = TRUE, print.summary = FALSE)
pSE$labels$title <- "SE Aus Group silhouette"

png(filename = "SEsil_both.png", width = 3200, height = 1600, res = 300)
pSE + scale_x_discrete(
      breaks = pSE$data$name,
      labels = season_weeks3[as.integer(as.character(pSE$data$name))]
  ) +
  theme(axis.text.x = element_text(angle = 90, size = 10)) +
  xlab("Weeks")
dev.off()
```



```{r iteration}
#get avg_sil for full resp matrix, then iterate through boundary cuts (ref: cluster_new.rmd, line 589)

NEsil_summary <- avg_sil(NEbase_matrix)
SEsil_summary <- avg_sil(SEbase_matrix)

#check remove weeks 35-37 (remove weeks 35 - 40)
NEsil_matrix <- as.matrix(NEsil_summary)
for (k in 1:6) {
  NEsil_matrix <- rbind(NEsil_matrix, avg_sil( NEbase_matrix[ ,-c(1:k)]))
}

SEsil_matrix <- as.matrix(SEsil_summary)
for (j in 1:6) {
  SEsil_matrix <- rbind(SEsil_matrix, avg_sil( SEbase_matrix[ ,-c(1:j)]))
}

#check remove weeks 12-14 (remove weeks 9 - 14)
NEsil_matrix2 <- as.matrix(NEsil_summary)
for (i in 1:6) {
  mat_end <- length(NEbase_matrix[1,])
  mat_beg <- mat_end - i
  NEsil_matrix2 <- rbind(NEsil_matrix2, avg_sil(NEbase_matrix[ ,-c(mat_beg:mat_end)]))
}

SEsil_matrix2 <- as.matrix(SEsil_summary)
for (i in 1:6) {
  mat_end <- length(SEbase_matrix[1,])
  mat_beg <- mat_end - i
  SEsil_matrix2 <- rbind(SEsil_matrix2, avg_sil(SEbase_matrix[ ,-c(mat_beg:mat_end)]))
}

#remove weeks 35-37 then check end weeks ( 14 - 9)

NEsil_summary2 <- avg_sil(NEbase_matrix1)
SEsil_summary2 <- avg_sil(SEbase_matrix1)

NEsil_matrix3 <- as.matrix(NEsil_summary2)
for (i in 1:6) {
  mat_end <- length(NEbase_matrix1[1,])
  mat_beg <- mat_end - i
  NEsil_matrix3 <- rbind(NEsil_matrix3, avg_sil(NEbase_matrix1[ ,-c(mat_beg:mat_end)]))
}

SEsil_matrix3 <- as.matrix(SEsil_summary2)
for (i in 1:6) {
  mat_end <- length(SEbase_matrix1[1,])
  mat_beg <- mat_end - i
  SEsil_matrix3 <- rbind(SEsil_matrix3, avg_sil(SEbase_matrix1[ ,-c(mat_beg:mat_end)]))
}


#test plots
#plot(1:7, NEsil_matrix2[,1], type = "b")
#plot(1:7, SEsil_matrix[,1], type = "b")

#plot(1:6, diff(NEsil_matrix2[,1]), type = "b")
#plot(1:6, diff(SEsil_matrix[,1]), type = "b")
```

```{r }
#TODO: finalize these plots

#formalize plots
sil_range <- range(NEsil_matrix, SEsil_matrix)

setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEbound_early.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(1:7, NEsil_matrix[,4], type = "b", pch = 18, ylim = sil_range, axes = FALSE,
     ylab = "Coefficient", xlab = "Start Week", main = "")
box()
axis(2)
axis(1, at = 1:7, labels = c(season_weeks[1:7]))
lines(1:7, NEsil_matrix[,1], type = "b", pch = 16, col = "firebrick2")
lines(1:7, NEsil_matrix[,2], type = "b", pch = 17, col = "forestgreen")
lines(1:7, NEsil_matrix[,3], type = "b", pch = 15, col = "royalblue3")
title("NE Aus Silhouette Coefficients", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("All", "Group 1", "Group 2",  "Group 3"),
       pch = c(18, 16, 17, 15),
       col = c( "black", 
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.2, 1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()
#TODO: add in legend

png(filename = "SEbound_early.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(1:7, SEsil_matrix[,4], type = "b", pch = 18, ylim = sil_range, axes = FALSE,
     ylab = "Coefficient", xlab = "Start Week", main = "")
box()
axis(2)
axis(1, at = 1:7, labels = c(season_weeks[1:7]))
lines(1:7, SEsil_matrix[,1], type = "b", pch = 16, col = "firebrick2")
lines(1:7, SEsil_matrix[,2], type = "b", pch = 17, col = "forestgreen")
lines(1:7, SEsil_matrix[,3], type = "b", pch = 15, col = "royalblue3")
title("SE Aus Silhouette Coefficients", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("All", "Group 1", "Group 2",  "Group 3"),
       pch = c(18, 16, 17, 15),
       col = c( "black", 
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.2, 1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()

#differencing plots
##diff_range <- range(diff(NEsil_matrix[,1]))

png(filename = "NEdelta_early.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(1:6, diff(NEsil_matrix[,4]), type = "b", pch = 18, ylim = c(-0.01, 0.05),
     ylab = expression(paste(Delta, " Coefficient")), xlab = "Week Removed", axes = FALSE)
box()
axis(2)
axis(1, at = 1:6, labels = c(season_weeks[1:6]))
lines(1:6, diff(NEsil_matrix[,1]), type = "b", pch = 16, col = "firebrick2")
lines(1:6, diff(NEsil_matrix[,2]), type = "b", pch = 17, col = "forestgreen")
lines(1:6, diff(NEsil_matrix[,3]), type = "b", pch = 15, col = "royalblue3")
abline(h = 0, lty = 2)
title("NE Aus Changes to Silhouette Coefficient", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("All", "Group 1", "Group 2",  "Group 3"),
       pch = c(18, 16, 17, 15),
       col = c( "black", 
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.2, 1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()


png(filename = "SEdelta_early.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(1:6, diff(SEsil_matrix[,4]), type = "b", pch = 18, ylim = c(-0.01, 0.05),
     ylab = expression(paste(Delta, " Coefficient")),xlab = "Week Removed", axes = FALSE)
box()
axis(2)
axis(1, at = 1:6, labels = c(season_weeks[1:6]))
lines(1:6, diff(SEsil_matrix[,1]), type = "b", pch = 16, col = "firebrick2")
lines(1:6, diff(SEsil_matrix[,2]), type = "b", pch = 17, col = "forestgreen")
lines(1:6, diff(SEsil_matrix[,3]), type = "b", pch = 15, col = "royalblue3")
abline(h = 0, lty = 2)
title("SE Aus Changes to Silhouette Coefficient", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("All", "Group 1", "Group 2",  "Group 3"),
       pch = c(18, 16, 17, 15),
       col = c( "black", 
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.2, 1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()


```


```{r sil_plots}
sil_range <- range(NEsil_matrix2, SEsil_matrix2)
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEbound_late.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(1:7, NEsil_matrix2[,4], type = "b", pch = 18, ylim = sil_range, axes = FALSE,
     ylab = "Coefficient", xlab = "End Week", main = "")
box()
axis(2)
axis(1, at = 1:7, labels = c(season_weeks[32:26]))
lines(1:7, NEsil_matrix2[,1], type = "b", pch = 16, col = "firebrick2")
lines(1:7, NEsil_matrix2[,2], type = "b", pch = 17, col = "forestgreen")
lines(1:7, NEsil_matrix2[,3], type = "b", pch = 15, col = "royalblue3")
title("NE Aus Silhouette Coefficients", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("All", "Group 1", "Group 2",  "Group 3"),
       pch = c(18, 16, 17, 15),
       col = c( "black", 
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.2, 1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()

#TODO: add in legend
png(filename = "SEbound_late.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(1:7, SEsil_matrix2[,4], type = "b", pch = 18, ylim = sil_range, axes = FALSE,
     ylab = "Coefficient", xlab = "End Week", main = "")
box()
axis(2)
axis(1, at = 1:7, labels = c(season_weeks[32:26]))
lines(1:7, SEsil_matrix2[,1], type = "b", pch = 16, col = "firebrick2")
lines(1:7, SEsil_matrix2[,2], type = "b", pch = 17, col = "forestgreen")
lines(1:7, SEsil_matrix2[,3], type = "b", pch = 15, col = "royalblue3")
title("SE Aus Silhouette Coefficients", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("All", "Group 1", "Group 2",  "Group 3"),
       pch = c(18, 16, 17, 15),
       col = c( "black", 
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.2, 1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()


#sil coef (from end season cuts)
sil_range <- range(NEsil_matrix3, SEsil_matrix3)


png(filename = "NEbound_both.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(1:7, NEsil_matrix3[,4], type = "b", pch = 18, ylim = sil_range, axes = FALSE,
     ylab = "Coefficient", xlab = "End Week", main = "")
box()
axis(2)
axis(1, at = 1:7, labels = c(season_weeks1[29:23]))
lines(1:7, NEsil_matrix3[,1], type = "b", pch = 16, col = "firebrick2")
lines(1:7, NEsil_matrix3[,2], type = "b", pch = 17, col = "forestgreen")
lines(1:7, NEsil_matrix3[,3], type = "b", pch = 15, col = "royalblue3")
title("NE Aus Silhouette Coefficients", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("All", "Group 1", "Group 2",  "Group 3"),
       pch = c(18, 16, 17, 15),
       col = c( "black", 
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.2, 1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()


png(filename = "SEbound_both.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(1:7, SEsil_matrix3[,4], type = "b", pch = 18, ylim = sil_range, axes = FALSE,
     ylab = "Coefficient", xlab = "End Week", main = "")
box()
axis(2)
axis(1, at = 1:7, labels = c(season_weeks1[29:23]))
lines(1:7, SEsil_matrix3[,1], type = "b", pch = 16, col = "firebrick2")
lines(1:7, SEsil_matrix3[,2], type = "b", pch = 17, col = "forestgreen")
lines(1:7, SEsil_matrix3[,3], type = "b", pch = 15, col = "royalblue3")
title("SE Aus Silhouette Coefficients", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("All", "Group 1", "Group 2",  "Group 3"),
       pch = c(18, 16, 17, 15),
       col = c( "black", 
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.2, 1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()
```


```{r diff_plots}
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEdelta_late.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(1:6, diff(NEsil_matrix2[,4]), type = "b", pch = 18, ylim = c(-0.08, 0.04),
     ylab = expression(paste(Delta, " Coefficient")), xlab = "Week Removed", axes = FALSE)
box()
axis(2)
axis(1, at = 1:6, labels = c(season_weeks[32:27]))
lines(1:6, diff(NEsil_matrix2[,1]), type = "b", pch = 16, col = "firebrick2")
lines(1:6, diff(NEsil_matrix2[,2]), type = "b", pch = 17, col = "forestgreen")
lines(1:6, diff(NEsil_matrix2[,3]), type = "b", pch = 15, col = "royalblue3")
abline(h = 0, lty = 2)
title("NE Aus Changes to Silhouette Coefficient", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("All", "Group 1", "Group 2",  "Group 3"),
       pch = c(18, 16, 17, 15),
       col = c( "black", 
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.2, 1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()


png(filename = "SEdelta_late.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(1:6, diff(SEsil_matrix2[,4]), type = "b", pch = 18, ylim = c(-0.08, 0.04),
     ylab = expression(paste(Delta, " Coefficient")), xlab = "Week Removed", axes = FALSE)
box()
axis(2)
axis(1, at = 1:6, labels = c(season_weeks[32:27]))
lines(1:6, diff(SEsil_matrix2[,1]), type = "b", pch = 16, col = "firebrick2")
lines(1:6, diff(SEsil_matrix2[,2]), type = "b", pch = 17, col = "forestgreen")
lines(1:6, diff(SEsil_matrix2[,3]), type = "b", pch = 15, col = "royalblue3")
abline(h = 0, lty = 2)
title("SE Aus Changes to Silhouette Coefficient", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("All", "Group 1", "Group 2",  "Group 3"),
       pch = c(18, 16, 17, 15),
       col = c( "black", 
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.2, 1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()


plot(1:6, diff(NEsil_matrix3[,4]), type = "b", pch = 18, ylim = c(-0.05, 0.05),
     ylab = expression(paste(Delta, " Coefficient")), xlab = "")
lines(1:6, diff(NEsil_matrix3[,1]), type = "b", pch = 16, col = "firebrick2")
lines(1:6, diff(NEsil_matrix3[,2]), type = "b", pch = 17, col = "forestgreen")
lines(1:6, diff(NEsil_matrix3[,3]), type = "b", pch = 15, col = "royalblue3")
abline(h=0, lty =2)


plot(1:6, diff(SEsil_matrix3[,4]), type = "b", pch = 18, ylim = c(-0.03, 0.05),
     ylab = expression(paste(Delta, " Coefficient")), xlab = "")
lines(1:6, diff(SEsil_matrix3[,1]), type = "b", pch = 16, col = "firebrick2")
lines(1:6, diff(SEsil_matrix3[,2]), type = "b", pch = 17, col = "forestgreen")
lines(1:6, diff(SEsil_matrix3[,3]), type = "b", pch = 15, col = "royalblue3")
abline(h=0, lty =2)

```




## MDS

Use a metric MDS here and start with euclidean distance.
TODO: add in explained variance per dimension (scree plot of eigenvalues)

```{r base_mds}
#TODO: finalize these plots with week labels for 35-37

#currently testing new mds method
NEmds_base <- mds(NEd2_base, type = "interval")
SEmds_base <- mds(SEd2_base, type = "interval")

group_col <- c("firebrick2",
               "forestgreen",
               "royalblue3")

NEmds_base$conf
summary(NEmds_base)

plot(NEmds_base, plot.type = "resplot")
plot(NEmds_base, plot.type = "bubbleplot") #bigger the bubble the worse the fit

plot(NEmds_base, pch = 16, col = group_col[NEcut3_base], label.conf = list(label = FALSE, pos = 5), cex= 1)
abline(h=0, lty =3)
abline(v= 0, lty =3)

plot(SEmds_base, plot.type = "bubbleplot", label.conf = list(label = TRUE, pos = 5)) 
plot(SEmds_base, pch = 16, col = group_col[SEcut3_base], label.conf = list(label = FALSE, pos = 5), cex = 1)
abline(h=0, lty =3)
abline(v= 0, lty =3)
```

```{r mds}

NEmds <- mds(NEd2.1, type = "interval")
SEmds <- mds(SE_d22.1, type = "interval")

#buble plots (for labels)
plot(SEmds, plot.type = "bubbleplot", label.conf = list(label = TRUE, pos = 5)) 

plot(NEmds, pch = 16, col = group_col[NEcut3], label.conf = list(label = FALSE, pos = 5), cex= 1)
abline(h=0, lty =3)
abline(v= 0, lty =3)


plot(SEmds, pch = 16, col = group_col[SEcut3], label.conf = list(label = FALSE, pos = 5), cex = 1)
abline(h=0, lty =3)
abline(v= 0, lty =3)
```


Repeat with cmdscale(), I kinda prefer this version

(probably good enough with this)

```{r cmds_test}
NE_mds <- cmdscale(NEd2_base, k =2, eig = TRUE)
SE_mds <- cmdscale(SEd2_base, k =2, eig = TRUE)

NEmds_pts <- NE_mds$points
SEmds_pts <- SE_mds$points

setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEmds.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(NE_mds$points, pch = 16, col = group_col[NEcut3_base], 
     xlab = "Dim 1", ylab = "Dim 2")
points(NEmds_pts[c(1:3), ], cex = 1.25)
text(NEmds_pts[c(1:3), ], labels = c("35", "36", "37"), pos = c(2,3,2))
points(NEmds_pts[c(30:32),], cex = 1.25)
text(NEmds_pts[c(30:32), ], labels = c("12", "13", "14"), pos = c(1,1,3))
title("NE Aus", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("Group 1", "Group 2",  "Group 3"),
       pch = 16,
       col = c(  
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()

png(filename = "SEmds.png", width = 2200, height = 1500, res = 300)
par(mar = c(5, 5, 3, 8))
plot(SE_mds$points, pch = 16, col = group_col[SEcut3_base], 
     xlab = "Dim 1", ylab = "Dim 2")
points(SEmds_pts[c(1:3), ], cex = 1.25)
text(SEmds_pts[c(1:3), ], labels = c("35", "36", "37"), pos = c(3,1,2))
points(SEmds_pts[c(30:32),], cex = 1.25)
text(SEmds_pts[c(30:32), ], labels = c("12", "13", "14"), pos = c(4,3,2))
title("SE Aus", adj = 0)
par(xpd = NA)
legend("topright", inset = c(-0.28, 0),
       legend = c("Group 1", "Group 2",  "Group 3"),
       pch = 16,
       col = c(
         "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.23, 1.23, 1.23),
       #title = "Avg. Silhouette",
       cex = 1)
dev.off()
```

Get scree plot of from mmds/pca (probably don't need this at all.)

```{r scree-test-library}
library(bios2mds)
# replace with something else later
```

```{r scree-test}
mmds1 <- mmds(as.matrix(NEd2_base), pc = 6)
scree.plot(mmds1$eigen.perc, lab = TRUE)

plot(1:32, NE_mds$eig, type = "b", pch = 16 )
```


# 3. Correlation 

```{r correlation_function}
#specific to our problem (we can generalize later)
pred_cor <- function(resp, preds){
   
  cor_list <- list()
  for (j in 1:3) {
    temp_df <- as.data.frame(cbind(resp[[j]], preds[[j]]))
  
    nino_cor <- cor(temp_df, method = "pearson")[2:53]
    dmi_cor <- cor(temp_df, method = "pearson")[54:105]
    tsa_cor <- cor(temp_df, method = "pearson")[106:157]
    aao_cor <- cor(temp_df, method = "pearson")[158:209]
    olr_cor <- cor(temp_df, method = "pearson")[210:261]
    
    cor_df <- data.frame(nino_cor, dmi_cor, tsa_cor, aao_cor, olr_cor)
    
    cor_list[[paste0("Group_", j)]] <- cor_df
  }
  
  return(cor_list)
  
}


```


```{r get_cor}
#full response correlation
NEcor_list <- pred_cor(NEresp, NEpreds)
SEcor_list <- pred_cor(SEresp, SEpreds)

#partial response correlation
NEcor_list_part <- pred_cor(NEresp_part, NEpreds_part)
SEcor_list_part <- pred_cor(SEresp_part, SEpreds_part)
```


```{r get_maxs}
#TODO: update as a function

##Nino
#nino - NE Aus
NEnino_max1 <- which.max(abs( NEcor_list[[1]]$nino_cor))
NEnino_max2 <- which.max(abs( NEcor_list[[2]]$nino_cor))
NEnino_max3 <- which.max(abs( NEcor_list[[3]]$nino_cor))
#nino - NE Aus (partial)
NEnino_max1_part <- which.max(abs( NEcor_list_part[[1]]$nino_cor))
NEnino_max2_part <- which.max(abs( NEcor_list_part[[2]]$nino_cor))
NEnino_max3_part <- which.max(abs( NEcor_list_part[[3]]$nino_cor))

#nino - SE Aus
SEnino_max1 <- which.max(abs( SEcor_list[[1]]$nino_cor))
SEnino_max2 <- which.max(abs( SEcor_list[[2]]$nino_cor))
SEnino_max3 <- which.max(abs( SEcor_list[[3]]$nino_cor))
#nino - SE Aus (partial)
SEnino_max1_part <- which.max(abs( SEcor_list_part[[1]]$nino_cor))
SEnino_max2_part <- which.max(abs( SEcor_list_part[[2]]$nino_cor))
SEnino_max3_part <- which.max(abs( SEcor_list_part[[3]]$nino_cor))


##DMI
#dmi - NE Aus
NEdmi_max1 <- which.max(abs( NEcor_list[[1]]$dmi_cor))
NEdmi_max2 <- which.max(abs( NEcor_list[[2]]$dmi_cor))
NEdmi_max3 <- which.max(abs( NEcor_list[[3]]$dmi_cor))
#dmi - NE Aus (partial)
NEdmi_max1_part <- which.max(abs( NEcor_list_part[[1]]$dmi_cor))
NEdmi_max2_part <- which.max(abs( NEcor_list_part[[2]]$dmi_cor))
NEdmi_max3_part <- which.max(abs( NEcor_list_part[[3]]$dmi_cor))

#dmi - SE Aus
SEdmi_max1 <- which.max(abs( SEcor_list[[1]]$dmi_cor))
SEdmi_max2 <- which.max(abs( SEcor_list[[2]]$dmi_cor))
SEdmi_max3 <- which.max(abs( SEcor_list[[3]]$dmi_cor))
#dmi - SE Aus (partial)
SEdmi_max1_part <- which.max(abs( SEcor_list_part[[1]]$dmi_cor))
SEdmi_max2_part <- which.max(abs( SEcor_list_part[[2]]$dmi_cor))
SEdmi_max3_part <- which.max(abs( SEcor_list_part[[3]]$dmi_cor))


##TSA
#tsa - NE Aus
NEtsa_max1 <- which.max(abs( NEcor_list[[1]]$tsa_cor))
NEtsa_max2 <- which.max(abs( NEcor_list[[2]]$tsa_cor))
NEtsa_max3 <- which.max(abs( NEcor_list[[3]]$tsa_cor))
#tsa - NE Aus (partial)
NEtsa_max1_part <- which.max(abs( NEcor_list_part[[1]]$tsa_cor))
NEtsa_max2_part <- which.max(abs( NEcor_list_part[[2]]$tsa_cor))
NEtsa_max3_part <- which.max(abs( NEcor_list_part[[3]]$tsa_cor))

#tsa - SE Aus
SEtsa_max1 <- which.max(abs( SEcor_list[[1]]$tsa_cor))
SEtsa_max2 <- which.max(abs( SEcor_list[[2]]$tsa_cor))
SEtsa_max3 <- which.max(abs( SEcor_list[[3]]$tsa_cor))
#tsa - SE Aus (partial)
SEtsa_max1_part <- which.max(abs( SEcor_list_part[[1]]$tsa_cor))
SEtsa_max2_part <- which.max(abs( SEcor_list_part[[2]]$tsa_cor))
SEtsa_max3_part <- which.max(abs( SEcor_list_part[[3]]$tsa_cor))


##SAM (AAO)
#aao - NE Aus
NEaao_max1 <- which.max(abs( NEcor_list[[1]]$aao_cor))
NEaao_max2 <- which.max(abs( NEcor_list[[2]]$aao_cor))
NEaao_max3 <- which.max(abs( NEcor_list[[3]]$aao_cor))
#aao - NE Aus (partial)
NEaao_max1_part <- which.max(abs( NEcor_list_part[[1]]$aao_cor))
NEaao_max2_part <- which.max(abs( NEcor_list_part[[2]]$aao_cor))
NEaao_max3_part <- which.max(abs( NEcor_list_part[[3]]$aao_cor))

#aao - SE Aus
SEaao_max1 <- which.max(abs( SEcor_list[[1]]$aao_cor))
SEaao_max2 <- which.max(abs( SEcor_list[[2]]$aao_cor))
SEaao_max3 <- which.max(abs( SEcor_list[[3]]$aao_cor))
#aao - SE Aus (partial)
SEaao_max1_part <- which.max(abs( SEcor_list_part[[1]]$aao_cor))
SEaao_max2_part <- which.max(abs( SEcor_list_part[[2]]$aao_cor))
SEaao_max3_part <- which.max(abs( SEcor_list_part[[3]]$aao_cor))


##OLR
#olr - NE Aus
NEolr_max1 <- which.max(abs( NEcor_list[[1]]$olr_cor))
NEolr_max2 <- which.max(abs( NEcor_list[[2]]$olr_cor))
NEolr_max3 <- which.max(abs( NEcor_list[[3]]$olr_cor))
#olr - NE Aus (partial)
NEolr_max1_part <- which.max(abs( NEcor_list_part[[1]]$olr_cor))
NEolr_max2_part <- which.max(abs( NEcor_list_part[[2]]$olr_cor))
NEolr_max3_part <- which.max(abs( NEcor_list_part[[3]]$olr_cor))

#olr - SE Aus
SEolr_max1 <- which.max(abs( SEcor_list[[1]]$olr_cor))
SEolr_max2 <- which.max(abs( SEcor_list[[2]]$olr_cor))
SEolr_max3 <- which.max(abs( SEcor_list[[3]]$olr_cor))
#olr - SE Aus (partial)
SEolr_max1_part <- which.max(abs( SEcor_list_part[[1]]$olr_cor))
SEolr_max2_part <- which.max(abs( SEcor_list_part[[2]]$olr_cor))
SEolr_max3_part <- which.max(abs( SEcor_list_part[[3]]$olr_cor))


```


## Correlation Figures

```{r NE-nino}
#NE Aus Group 1 - Nino
plot(1:52, NEcor_list[[1]]$nino_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[1]]$nino_cor, col = "firebrick2", lty = 2, lwd = 1.5)
points(NEnino_max1, NEcor_list[[1]]$nino_cor[NEnino_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(NEnino_max1_part, NEcor_list_part[[1]]$nino_cor[NEnino_max1_part], 
       pch = 21, col = "darkred", bg="darksalmon", cex = 1.23)

#NE Aus Group 2 - Nino
plot(1:52, NEcor_list[[2]]$nino_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "forestgreen", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[2]]$nino_cor, col = "forestgreen", lty = 2, lwd = 1.5)
points(NEnino_max2, NEcor_list[[2]]$nino_cor[NEnino_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(NEnino_max2_part, NEcor_list_part[[2]]$nino_cor[NEnino_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.2)

#NE Aus Group 3 - Nino
plot(1:52, NEcor_list[[3]]$nino_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "royalblue3", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[3]]$nino_cor, col = "royalblue3", lty = 2, lwd = 1.5)
points(NEnino_max3, NEcor_list[[3]]$nino_cor[NEnino_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(NEnino_max3_part, NEcor_list_part[[3]]$nino_cor[NEnino_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)

#combine into a single figure (with maximums) and output (as .pdf)
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEnino_cor.png", width = 2000, height = 1800, res = 300)
#pdf("NEnino_cor.pdf", width=6, height=4)
par(mar = c(5, 5, 3, 4))
plot(1:52, NEcor_list[[1]]$nino_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.25)
abline(h = 0, lty = 3)
lines(1:52, NEcor_list_part[[1]]$nino_cor, col = "firebrick2", lty = 2, lwd = 1.25)
points(NEnino_max1, NEcor_list[[1]]$nino_cor[NEnino_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(NEnino_max1_part, NEcor_list_part[[1]]$nino_cor[NEnino_max1_part], 
       pch = 21, col = "darkred", bg = alpha("darksalmon", 0.45) , cex = 1.23)
lines(1:52, NEcor_list[[2]]$nino_cor, col = "forestgreen", lwd = 1.25)
lines(1:52, NEcor_list_part[[2]]$nino_cor, col = "forestgreen", lty = 2, lwd = 1.25)
points(NEnino_max2, NEcor_list[[2]]$nino_cor[NEnino_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(NEnino_max2_part, NEcor_list_part[[2]]$nino_cor[NEnino_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.15)
lines(1:52, NEcor_list[[3]]$nino_cor, col = "royalblue3", lwd = 1.25)
lines(1:52, NEcor_list_part[[3]]$nino_cor, col = "royalblue3", lty = 2, lwd = 1.25)
points(NEnino_max3, NEcor_list[[3]]$nino_cor[NEnino_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(NEnino_max3_part, NEcor_list_part[[3]]$nino_cor[NEnino_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)
title("Nino", adj = 0)
dev.off()
```


```{r SE-nino}

#SE Aus Group 1 - Nino
plot(1:52, SEcor_list[[1]]$nino_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[1]]$nino_cor, col = "firebrick2", lty = 2, lwd = 1.5)
points(SEnino_max1, SEcor_list[[1]]$nino_cor[SEnino_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(SEnino_max1_part, SEcor_list_part[[1]]$nino_cor[SEnino_max1_part], 
       pch = 21, col = "darkred", bg="darksalmon", cex = 1.23)

#SE Aus Group 2 - Nino
plot(1:52, SEcor_list[[2]]$nino_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "forestgreen", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[2]]$nino_cor, col = "forestgreen", lty = 2, lwd = 1.5)
points(SEnino_max2, SEcor_list[[2]]$nino_cor[SEnino_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(SEnino_max2_part, SEcor_list_part[[2]]$nino_cor[SEnino_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.2)

#SE Aus Group 3 - Nino
plot(1:52, SEcor_list[[3]]$nino_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "royalblue3", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[3]]$nino_cor, col = "royalblue3", lty = 2, lwd = 1.5)
points(SEnino_max3, SEcor_list[[3]]$nino_cor[SEnino_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(SEnino_max3_part, SEcor_list_part[[3]]$nino_cor[SEnino_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)

#combined together and output
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "SEnino_cor.png", width = 2000, height = 1800, res = 300)
par(mar = c(5, 5, 3, 4))
plot(1:52, SEcor_list[[1]]$nino_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.25)
abline(h = 0, lty = 3)
lines(1:52, SEcor_list_part[[1]]$nino_cor, col = "firebrick2", lty = 2, lwd = 1.25)
points(SEnino_max1, SEcor_list[[1]]$nino_cor[SEnino_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(SEnino_max1_part, SEcor_list_part[[1]]$nino_cor[SEnino_max1_part], 
       pch = 21, col = "darkred", bg= alpha("darksalmon", 0.45), cex = 1.23)
lines(1:52, SEcor_list[[2]]$nino_cor, col = "forestgreen", lwd = 1.25)
lines(1:52, SEcor_list_part[[2]]$nino_cor, col = "forestgreen", lty = 2, lwd = 1.25)
points(SEnino_max2, SEcor_list[[2]]$nino_cor[SEnino_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(SEnino_max2_part, SEcor_list_part[[2]]$nino_cor[SEnino_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.15)
lines(1:52, SEcor_list[[3]]$nino_cor, col = "royalblue3", lwd = 1.25)
lines(1:52, SEcor_list_part[[3]]$nino_cor, col = "royalblue3", lty = 2, lwd = 1.25)
points(SEnino_max3, SEcor_list[[3]]$nino_cor[SEnino_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(SEnino_max3_part, SEcor_list_part[[3]]$nino_cor[SEnino_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)
title("Nino", adj = 0)
dev.off()

```


```{r NE-dmi}
#NE Aus Group 1 - DMI
plot(1:52, NEcor_list[[1]]$dmi_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[1]]$dmi_cor, col = "firebrick2", lty = 2, lwd = 1.5)
points(NEdmi_max1, NEcor_list[[1]]$dmi_cor[NEdmi_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(NEdmi_max1_part, NEcor_list_part[[1]]$dmi_cor[NEdmi_max1_part], 
       pch = 21, col = "darkred", bg = alpha("darksalmon", 0.45), cex = 1.23)

#NE Aus Group 2 - DMI
plot(1:52, NEcor_list[[2]]$dmi_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "forestgreen", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[2]]$dmi_cor, col = "forestgreen", lty = 2, lwd = 1.5)
points(NEdmi_max2, NEcor_list[[2]]$dmi_cor[NEdmi_max2], pch = 16, col = "forestgreen", cex = 1.23)
points(NEdmi_max2_part, NEcor_list_part[[2]]$dmi_cor[NEdmi_max2_part], 
       pch = 21, col = "darkgreen", bg= alpha("palegreen2",0.35), cex = 1.23)

#NE Aus Group 3 - DMI
plot(1:52, NEcor_list[[3]]$dmi_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "royalblue3", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[3]]$dmi_cor, col = "royalblue3", lty = 2, lwd = 1.5)
points(NEdmi_max3, NEcor_list[[3]]$dmi_cor[NEdmi_max3], pch = 16, col = "royalblue3", cex = 1.23)
points(NEdmi_max3_part, NEcor_list_part[[3]]$dmi_cor[NEdmi_max3_part], 
       pch = 21, col = "darkblue", bg= alpha("lightskyblue",0.35), cex = 1.23)

#combine plots and output
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEdmi_cor.png", width = 2000, height = 1800, res = 300)
par(mar = c(5, 5, 3, 4))
plot(1:52, NEcor_list[[1]]$dmi_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.25)
abline(h = 0, lty = 3)
lines(1:52, NEcor_list_part[[1]]$dmi_cor, col = "firebrick2", lty = 2, lwd = 1.25)
points(NEdmi_max1, NEcor_list[[1]]$dmi_cor[NEdmi_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(NEdmi_max1_part, NEcor_list_part[[1]]$dmi_cor[NEdmi_max1_part], 
       pch = 21, col = "darkred", bg= alpha("darksalmon", 0.45), cex = 1.23)
lines(1:52, NEcor_list[[2]]$dmi_cor, col = "forestgreen", lwd = 1.25)
lines(1:52, NEcor_list_part[[2]]$dmi_cor, col = "forestgreen", lty = 2, lwd = 1.25)
points(NEdmi_max2, NEcor_list[[2]]$dmi_cor[NEdmi_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(NEdmi_max2_part, NEcor_list_part[[2]]$dmi_cor[NEdmi_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.15)
lines(1:52, NEcor_list[[3]]$dmi_cor, col = "royalblue3", lwd = 1.25)
lines(1:52, NEcor_list_part[[3]]$dmi_cor, col = "royalblue3", lty = 2, lwd = 1.25)
points(NEdmi_max3, NEcor_list[[3]]$dmi_cor[NEdmi_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(NEdmi_max3_part, NEcor_list_part[[3]]$dmi_cor[NEdmi_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)
title("DMI", adj = 0)
dev.off()
```


```{r SE-dmi}
#SE Aus Group 1 - DMI
plot(1:52, SEcor_list[[1]]$dmi_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[1]]$dmi_cor, col = "firebrick2", lty = 2, lwd = 1.5)
points(SEdmi_max1, SEcor_list[[1]]$dmi_cor[SEdmi_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(SEdmi_max1_part, SEcor_list_part[[1]]$dmi_cor[SEdmi_max1_part], 
       pch = 21, col = "darkred", bg = alpha("darksalmon", 0.45), cex = 1.23)

#SE Aus Group 2 - DMI
plot(1:52, SEcor_list[[2]]$dmi_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "forestgreen", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[2]]$dmi_cor, col = "forestgreen", lty = 2, lwd = 1.5)
points(SEdmi_max2, SEcor_list[[2]]$dmi_cor[SEdmi_max2], pch = 16, col = "forestgreen", cex = 1.23)
points(SEdmi_max2_part, SEcor_list_part[[2]]$dmi_cor[SEdmi_max2_part], 
       pch = 21, col = "darkgreen", bg= alpha("palegreen2",0.35), cex = 1.23)

#SE Aus Group 3 - DMI
plot(1:52, SEcor_list[[3]]$dmi_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "royalblue3", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[3]]$dmi_cor, col = "royalblue3", lty = 2, lwd = 1.5)
points(SEdmi_max3, SEcor_list[[3]]$dmi_cor[SEdmi_max3], pch = 16, col = "royalblue3", cex = 1.23)
points(SEdmi_max3_part, SEcor_list_part[[3]]$dmi_cor[SEdmi_max3_part], 
       pch = 21, col = "darkblue", bg= alpha("lightskyblue",0.35), cex = 1.23)


#combine and output
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "SEdmi_cor.png", width = 2000, height = 1800, res = 300)
par(mar = c(5, 5, 3, 4))
plot(1:52, SEcor_list[[1]]$dmi_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.25)
abline(h = 0, lty = 3)
lines(1:52, SEcor_list_part[[1]]$dmi_cor, col = "firebrick2", lty = 2, lwd = 1.25)
points(SEdmi_max1, SEcor_list[[1]]$dmi_cor[SEdmi_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(SEdmi_max1_part, SEcor_list_part[[1]]$dmi_cor[SEdmi_max1_part], 
       pch = 21, col = "darkred", bg= alpha("darksalmon", 0.45), cex = 1.23)
lines(1:52, SEcor_list[[2]]$dmi_cor, col = "forestgreen", lwd = 1.25)
lines(1:52, SEcor_list_part[[2]]$dmi_cor, col = "forestgreen", lty = 2, lwd = 1.25)
points(SEdmi_max2, SEcor_list[[2]]$dmi_cor[SEdmi_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(SEdmi_max2_part, SEcor_list_part[[2]]$dmi_cor[SEdmi_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.15)
lines(1:52, SEcor_list[[3]]$dmi_cor, col = "royalblue3", lwd = 1.25)
lines(1:52, SEcor_list_part[[3]]$dmi_cor, col = "royalblue3", lty = 2, lwd = 1.25)
points(SEdmi_max3, SEcor_list[[3]]$dmi_cor[SEdmi_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(SEdmi_max3_part, SEcor_list_part[[3]]$dmi_cor[SEdmi_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)
title("DMI", adj = 0)
dev.off()

```


```{r NE-tsa}
#NE Aus Group 1 - TSA
plot(1:52, NEcor_list[[1]]$tsa_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[1]]$tsa_cor, col = "firebrick2", lty = 2, lwd = 1.5)
points(NEtsa_max1, NEcor_list[[1]]$tsa_cor[NEtsa_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(NEtsa_max1_part, NEcor_list_part[[1]]$tsa_cor[NEtsa_max1_part], 
       pch = 21, col = "darkred", bg = alpha("darksalmon", 0.45), cex = 1.23)

#NE Aus Group 2 - TSA
plot(1:52, NEcor_list[[2]]$tsa_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "forestgreen", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[2]]$tsa_cor, col = "forestgreen", lty = 2, lwd = 1.5)
points(NEtsa_max2, NEcor_list[[2]]$tsa_cor[NEtsa_max2], pch = 16, col = "forestgreen", cex = 1.23)
points(NEtsa_max2_part, NEcor_list_part[[2]]$tsa_cor[NEtsa_max2_part], 
       pch = 21, col = "darkgreen", bg = alpha("palegreen2", 0.45), cex = 1.23)

#NE Aus Group 3 - TSA
plot(1:52, NEcor_list[[3]]$tsa_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "royalblue3", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[3]]$tsa_cor, col = "royalblue3", lty = 2, lwd = 1.5)
points(NEtsa_max3, NEcor_list[[3]]$tsa_cor[NEtsa_max3], pch = 16, col = "royalblue3", cex = 1.23)
points(NEtsa_max3_part, NEcor_list_part[[3]]$tsa_cor[NEtsa_max3_part], 
       pch = 21, col = "darkblue", bg = alpha("lightskyblue", 0.45), cex = 1.23)


#combine and output
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEtsa_cor.png", width = 2000, height = 1800, res = 300)
par(mar = c(5, 5, 3, 4))
plot(1:52, NEcor_list[[1]]$tsa_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.25)
abline(h = 0, lty = 3)
lines(1:52, NEcor_list_part[[1]]$tsa_cor, col = "firebrick2", lty = 2, lwd = 1.25)
points(NEtsa_max1, NEcor_list[[1]]$tsa_cor[NEtsa_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(NEtsa_max1_part, NEcor_list_part[[1]]$tsa_cor[NEtsa_max1_part], 
       pch = 21, col = "darkred", bg= alpha("darksalmon", 0.45), cex = 1.23)
lines(1:52, NEcor_list[[2]]$tsa_cor, col = "forestgreen", lwd = 1.25)
lines(1:52, NEcor_list_part[[2]]$tsa_cor, col = "forestgreen", lty = 2, lwd = 1.25)
points(NEtsa_max2, NEcor_list[[2]]$tsa_cor[NEtsa_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(NEtsa_max2_part, NEcor_list_part[[2]]$tsa_cor[NEtsa_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.15)
lines(1:52, NEcor_list[[3]]$tsa_cor, col = "royalblue3", lwd = 1.25)
lines(1:52, NEcor_list_part[[3]]$tsa_cor, col = "royalblue3", lty = 2, lwd = 1.25)
points(NEtsa_max3, NEcor_list[[3]]$tsa_cor[NEtsa_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(NEtsa_max3_part, NEcor_list_part[[3]]$tsa_cor[NEtsa_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)
title("TSA", adj = 0)
dev.off()
```


```{r SE-tsa}
#SE Aus Group 1 - TSA
plot(1:52, SEcor_list[[1]]$tsa_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[1]]$tsa_cor, col = "firebrick2", lty = 2, lwd = 1.5)
points(SEtsa_max1, SEcor_list[[1]]$tsa_cor[SEtsa_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(SEtsa_max1_part, SEcor_list_part[[1]]$tsa_cor[SEtsa_max1_part], 
       pch = 21, col = "darkred", bg = alpha("darksalmon", 0.45), cex = 1.23)

#SE Aus Group 2 - TSA
plot(1:52, SEcor_list[[2]]$tsa_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "forestgreen", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[2]]$tsa_cor, col = "forestgreen", lty = 2, lwd = 1.5)
points(SEtsa_max2, SEcor_list[[2]]$tsa_cor[SEtsa_max2], pch = 16, col = "forestgreen", cex = 1.23)
points(SEtsa_max2_part, SEcor_list_part[[2]]$tsa_cor[SEtsa_max2_part], 
       pch = 21, col = "darkgreen", bg = alpha("palegreen2", 0.45), cex = 1.23)

#SE Aus Group 3 - TSA
plot(1:52, SEcor_list[[3]]$tsa_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "royalblue3", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[3]]$tsa_cor, col = "royalblue3", lty = 2, lwd = 1.5)
points(SEtsa_max3, SEcor_list[[3]]$tsa_cor[SEtsa_max3], pch = 16, col = "royalblue3", cex = 1.23)
points(SEtsa_max3_part, SEcor_list_part[[3]]$tsa_cor[SEtsa_max3_part], 
       pch = 21, col = "darkblue", bg = alpha("lightskyblue", 0.45), cex = 1.23)


#combine and output
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "SEtsa_cor.png", width = 2000, height = 1800, res = 300)
par(mar = c(5, 5, 3, 4))
plot(1:52, SEcor_list[[1]]$tsa_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.25)
abline(h = 0, lty = 3)
lines(1:52, SEcor_list_part[[1]]$tsa_cor, col = "firebrick2", lty = 2, lwd = 1.25)
points(SEtsa_max1, SEcor_list[[1]]$tsa_cor[SEtsa_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(SEtsa_max1_part, SEcor_list_part[[1]]$tsa_cor[SEtsa_max1_part], 
       pch = 21, col = "darkred", bg= alpha("darksalmon", 0.45), cex = 1.23)
lines(1:52, SEcor_list[[2]]$tsa_cor, col = "forestgreen", lwd = 1.25)
lines(1:52, SEcor_list_part[[2]]$tsa_cor, col = "forestgreen", lty = 2, lwd = 1.25)
points(SEtsa_max2, SEcor_list[[2]]$tsa_cor[SEtsa_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(SEtsa_max2_part, SEcor_list_part[[2]]$tsa_cor[SEtsa_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.15)
lines(1:52, SEcor_list[[3]]$tsa_cor, col = "royalblue3", lwd = 1.25)
lines(1:52, SEcor_list_part[[3]]$tsa_cor, col = "royalblue3", lty = 2, lwd = 1.25)
points(SEtsa_max3, SEcor_list[[3]]$tsa_cor[SEtsa_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(SEtsa_max3_part, SEcor_list_part[[3]]$tsa_cor[SEtsa_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)
title("TSA", adj = 0)
dev.off()

```


```{r NE-aao}
#NE Aus Group 1 - AAO
plot(1:52, NEcor_list[[1]]$aao_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[1]]$aao_cor, col = "firebrick2", lty = 2, lwd = 1.5)
points(NEaao_max1, NEcor_list[[1]]$aao_cor[NEaao_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(NEaao_max1_part, NEcor_list_part[[1]]$aao_cor[NEaao_max1_part], 
       pch = 21, col = "darkred", bg = alpha("darksalmon", 0.45), cex = 1.23)

#NE Aus Group 2 - AAO
plot(1:52, NEcor_list[[2]]$aao_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "forestgreen", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[2]]$aao_cor, col = "forestgreen", lty = 2, lwd = 1.5)
points(NEaao_max2, NEcor_list[[2]]$aao_cor[NEaao_max2], pch = 16, col = "forestgreen", cex = 1.23)
points(NEaao_max2_part, NEcor_list_part[[2]]$aao_cor[NEaao_max2_part], 
       pch = 21, col = "darkgreen", bg = alpha("palegreen2", 0.45), cex = 1.23)

#NE Aus Group 3 - AAO
plot(1:52, NEcor_list[[3]]$aao_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "royalblue3", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[3]]$aao_cor, col = "royalblue3", lty = 2, lwd = 1.5)
points(NEaao_max3, NEcor_list[[3]]$aao_cor[NEaao_max3], pch = 16, col = "royalblue3", cex = 1.23)
points(NEaao_max3_part, NEcor_list_part[[3]]$aao_cor[NEaao_max3_part], 
       pch = 21, col = "darkblue", bg = alpha("lightskyblue", 0.45), cex = 1.23)

#combine and output
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEaao_cor.png", width = 2000, height = 1800, res = 300)
par(mar = c(5, 5, 3, 4))
plot(1:52, NEcor_list[[1]]$aao_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.25)
abline(h = 0, lty = 3)
lines(1:52, NEcor_list_part[[1]]$aao_cor, col = "firebrick2", lty = 2, lwd = 1.25)
points(NEaao_max1, NEcor_list[[1]]$aao_cor[NEaao_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(NEaao_max1_part, NEcor_list_part[[1]]$aao_cor[NEaao_max1_part], 
       pch = 21, col = "darkred", bg= alpha("darksalmon", 0.45), cex = 1.23)
lines(1:52, NEcor_list[[2]]$aao_cor, col = "forestgreen", lwd = 1.25)
lines(1:52, NEcor_list_part[[2]]$aao_cor, col = "forestgreen", lty = 2, lwd = 1.25)
points(NEaao_max2, NEcor_list[[2]]$aao_cor[NEaao_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(NEaao_max2_part, NEcor_list_part[[2]]$aao_cor[NEaao_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.15)
lines(1:52, NEcor_list[[3]]$aao_cor, col = "royalblue3", lwd = 1.25)
lines(1:52, NEcor_list_part[[3]]$aao_cor, col = "royalblue3", lty = 2, lwd = 1.25)
points(NEaao_max3, NEcor_list[[3]]$aao_cor[NEaao_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(NEaao_max3_part, NEcor_list_part[[3]]$aao_cor[NEaao_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)
title("SAM (AAO)", adj = 0)
dev.off()


```


```{r SE-aao}
#SE Aus Group 1 - AAO
plot(1:52, SEcor_list[[1]]$aao_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[1]]$aao_cor, col = "firebrick2", lty = 2, lwd = 1.5)
points(SEaao_max1, SEcor_list[[1]]$aao_cor[SEaao_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(SEaao_max1_part, SEcor_list_part[[1]]$aao_cor[SEaao_max1_part], 
       pch = 21, col = "darkred", bg = alpha("darksalmon", 0.45), cex = 1.23)

#SE Aus Group 2 - AAO
plot(1:52, SEcor_list[[2]]$aao_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "forestgreen", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[2]]$aao_cor, col = "forestgreen", lty = 2, lwd = 1.5)
points(SEaao_max2, SEcor_list[[2]]$aao_cor[SEaao_max2], pch = 16, col = "forestgreen", cex = 1.23)
points(SEaao_max2_part, SEcor_list_part[[2]]$aao_cor[SEaao_max2_part], 
       pch = 21, col = "darkgreen", bg = alpha("palegreen2", 0.45), cex = 1.23)

#SE Aus Group 3 - AAO
plot(1:52, SEcor_list[[3]]$aao_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "royalblue3", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[3]]$aao_cor, col = "royalblue3", lty = 2, lwd = 1.5)
points(SEaao_max3, SEcor_list[[3]]$aao_cor[SEaao_max3], pch = 16, col = "royalblue3", cex = 1.23)
points(SEaao_max3_part, SEcor_list_part[[3]]$aao_cor[SEaao_max3_part], 
       pch = 21, col = "darkblue", bg = alpha("lightskyblue", 0.45), cex = 1.23)

#combine and output
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "SEaao_cor.png", width = 2000, height = 1800, res = 300)
par(mar = c(5, 5, 3, 4))
plot(1:52, SEcor_list[[1]]$aao_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.25)
abline(h = 0, lty = 3)
lines(1:52, SEcor_list_part[[1]]$aao_cor, col = "firebrick2", lty = 2, lwd = 1.25)
points(SEaao_max1, SEcor_list[[1]]$aao_cor[SEaao_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(SEaao_max1_part, SEcor_list_part[[1]]$aao_cor[SEaao_max1_part], 
       pch = 21, col = "darkred", bg= alpha("darksalmon", 0.45), cex = 1.23)
lines(1:52, SEcor_list[[2]]$aao_cor, col = "forestgreen", lwd = 1.25)
lines(1:52, SEcor_list_part[[2]]$aao_cor, col = "forestgreen", lty = 2, lwd = 1.25)
points(SEaao_max2, SEcor_list[[2]]$aao_cor[SEaao_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(SEaao_max2_part, SEcor_list_part[[2]]$aao_cor[SEaao_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.15)
lines(1:52, SEcor_list[[3]]$aao_cor, col = "royalblue3", lwd = 1.25)
lines(1:52, SEcor_list_part[[3]]$aao_cor, col = "royalblue3", lty = 2, lwd = 1.25)
points(SEaao_max3, SEcor_list[[3]]$aao_cor[SEaao_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(SEaao_max3_part, SEcor_list_part[[3]]$aao_cor[SEaao_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)
title("SAM (AAO)", adj = 0)
dev.off()


```


```{r NE-olr}

#NE Aus Group 1 - OLR
plot(1:52, NEcor_list[[1]]$olr_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[1]]$olr_cor, col = "firebrick2", lty = 2, lwd = 1.5)
points(NEolr_max1, NEcor_list[[1]]$olr_cor[NEolr_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(NEolr_max1_part, NEcor_list_part[[1]]$olr_cor[NEolr_max1_part], 
       pch = 21, col = "darkred", bg = alpha("darksalmon", 0.45), cex = 1.23)

#NE Aus Group 2 - OLR
plot(1:52, NEcor_list[[2]]$olr_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "forestgreen", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[2]]$olr_cor, col = "forestgreen", lty = 2, lwd = 1.5)
points(NEolr_max2, NEcor_list[[2]]$olr_cor[NEolr_max2], pch = 16, col = "forestgreen", cex = 1.23)
points(NEolr_max2_part, NEcor_list_part[[2]]$olr_cor[NEolr_max2_part], 
       pch = 21, col = "darkgreen", bg = alpha("palegreen2", 0.45), cex = 1.23)

#NE Aus Group 3 - OLR
plot(1:52, NEcor_list[[3]]$olr_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "royalblue3", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, NEcor_list_part[[3]]$olr_cor, col = "royalblue3", lty = 2, lwd = 1.5)
points(NEolr_max3, NEcor_list[[3]]$olr_cor[NEolr_max3], pch = 16, col = "royalblue3", cex = 1.23)
points(NEolr_max3_part, NEcor_list_part[[3]]$olr_cor[NEolr_max3_part], 
       pch = 21, col = "darkblue", bg = alpha("lightskyblue", 0.45), cex = 1.23)

#combine and output
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "NEolr_cor.png", width = 2000, height = 1800, res = 300)
par(mar = c(5, 5, 3, 4))
plot(1:52, NEcor_list[[1]]$olr_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.25)
abline(h = 0, lty = 3)
lines(1:52, NEcor_list_part[[1]]$olr_cor, col = "firebrick2", lty = 2, lwd = 1.25)
points(NEolr_max1, NEcor_list[[1]]$olr_cor[NEolr_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(NEolr_max1_part, NEcor_list_part[[1]]$olr_cor[NEolr_max1_part], 
       pch = 21, col = "darkred", bg= alpha("darksalmon", 0.45), cex = 1.23)
lines(1:52, NEcor_list[[2]]$olr_cor, col = "forestgreen", lwd = 1.25)
lines(1:52, NEcor_list_part[[2]]$olr_cor, col = "forestgreen", lty = 2, lwd = 1.25)
points(NEolr_max2, NEcor_list[[2]]$olr_cor[NEolr_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(NEolr_max2_part, NEcor_list_part[[2]]$olr_cor[NEolr_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.15)
lines(1:52, NEcor_list[[3]]$olr_cor, col = "royalblue3", lwd = 1.25)
lines(1:52, NEcor_list_part[[3]]$olr_cor, col = "royalblue3", lty = 2, lwd = 1.25)
points(NEolr_max3, NEcor_list[[3]]$olr_cor[NEolr_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(NEolr_max3_part, NEcor_list_part[[3]]$olr_cor[NEolr_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)
title("OLR", adj = 0)
dev.off()

```


```{r SE-olr}

#SE Aus Group 1 - OLR
plot(1:52, SEcor_list[[1]]$olr_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[1]]$olr_cor, col = "firebrick2", lty = 2, lwd = 1.5)
points(SEolr_max1, SEcor_list[[1]]$olr_cor[SEolr_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(SEolr_max1_part, SEcor_list_part[[1]]$olr_cor[SEolr_max1_part], 
       pch = 21, col = "darkred", bg = alpha("darksalmon", 0.45), cex = 1.23)

#SE Aus Group 2 - OLR
plot(1:52, SEcor_list[[2]]$olr_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "forestgreen", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[2]]$olr_cor, col = "forestgreen", lty = 2, lwd = 1.5)
points(SEolr_max2, SEcor_list[[2]]$olr_cor[SEolr_max2], pch = 16, col = "forestgreen", cex = 1.23)
points(SEolr_max2_part, SEcor_list_part[[2]]$olr_cor[SEolr_max2_part], 
       pch = 21, col = "darkgreen", bg = alpha("palegreen2", 0.45), cex = 1.23)

#SE Aus Group 3 - OLR
plot(1:52, SEcor_list[[3]]$olr_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "royalblue3", lwd = 1.5)
abline(h = 0, lty = 2)
lines(1:52, SEcor_list_part[[3]]$olr_cor, col = "royalblue3", lty = 2, lwd = 1.5)
points(SEolr_max3, SEcor_list[[3]]$olr_cor[SEolr_max3], pch = 16, col = "royalblue3", cex = 1.23)
points(SEolr_max3_part, SEcor_list_part[[3]]$olr_cor[SEolr_max3_part], 
       pch = 21, col = "darkblue", bg = alpha("lightskyblue", 0.45), cex = 1.23)

#combine and output
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "SEolr_cor.png", width = 2000, height = 1800, res = 300)
par(mar = c(5, 5, 3, 4))
plot(1:52, SEcor_list[[1]]$olr_cor, type = "l", ylim = c(-1,1),
     ylab = "Correlation", xlab = "Lag", col = "firebrick2", lwd = 1.25)
abline(h = 0, lty = 3)
lines(1:52, SEcor_list_part[[1]]$olr_cor, col = "firebrick2", lty = 2, lwd = 1.25)
points(SEolr_max1, SEcor_list[[1]]$olr_cor[SEolr_max1], pch = 16, col = "firebrick2", cex = 1.23)
points(SEolr_max1_part, SEcor_list_part[[1]]$olr_cor[SEolr_max1_part], 
       pch = 21, col = "darkred", bg= alpha("darksalmon", 0.45), cex = 1.23)
lines(1:52, SEcor_list[[2]]$olr_cor, col = "forestgreen", lwd = 1.25)
lines(1:52, SEcor_list_part[[2]]$olr_cor, col = "forestgreen", lty = 2, lwd = 1.25)
points(SEolr_max2, SEcor_list[[2]]$olr_cor[SEolr_max2], pch = 17, col = "forestgreen", cex = 1.23)
points(SEolr_max2_part, SEcor_list_part[[2]]$olr_cor[SEolr_max2_part], 
       pch = 24, col = "darkgreen", bg = alpha("palegreen2",0.35), cex = 1.15)
lines(1:52, SEcor_list[[3]]$olr_cor, col = "royalblue3", lwd = 1.25)
lines(1:52, SEcor_list_part[[3]]$olr_cor, col = "royalblue3", lty = 2, lwd = 1.25)
points(SEolr_max3, SEcor_list[[3]]$olr_cor[SEolr_max3], pch = 15, col = "royalblue3", cex = 1.23)
points(SEolr_max3_part, SEcor_list_part[[3]]$olr_cor[SEolr_max3_part], 
       pch = 22, col = "darkblue", bg = alpha("lightskyblue", 0.35), cex = 1.2)
title("OLR", adj = 0)
dev.off()

```


```{r legend}
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "legend_cor.png", width = 2000, height = 1800, res = 300)
par(mar = c(5, 5, 3, 4))
plot(-1:1, -1:1, type = "n",  axes = FALSE,
     xlab = "", ylab = "")
par(xpd = NA)
legend("topleft", inset = c(0.0, 0.10),
       legend = c("Group 1", "Group 2",  "Group 3"),
       lty = c(1,1,1),
              col = c( "firebrick2", 
                "forestgreen",
                "royalblue3"),
       lwd = c(1.25, 1.25, 1.25),
       seg.len = 5.5,
       title = "Correlation with 2019/2020")
legend("topleft", inset = c(0.50, 0.10),
       legend = c("Group 1", "Group 2",  "Group 3"),
       pch = c(16, 17, 15),
       col = c( "firebrick2", 
                "forestgreen",
                "royalblue3"),
       pt.cex = c(1.23, 1.23, 1.23),
       title = "Max Correlation",
       cex = 1)
legend("topleft", inset = c(0.0, 0.5),
       legend = c("Group 1", "Group 2",  "Group 3"),
       lty = c(2,2,2),
              col = c( "firebrick2", 
                "forestgreen",
                "royalblue3"),
       lwd = c(1.25, 1.25, 1.25),
       seg.len = 5,
       title = "Correlation without 2019/2020")
legend("topleft", inset = c(0.50, 0.50),
       legend = c("Group 1", "Group 2",  "Group 3"),
       pch = c(21, 24, 22),
       col = c( "darkred", 
                "darkgreen",
                "darkblue"),
       pt.bg = c(alpha("darksalmon", 0.45),
         alpha("palegreen2",0.45),
         alpha("lightskyblue", 0.45)),
       pt.cex = c(1.23, 1.15, 1.23),
       title = "Max Correlation",
       cex = 1)
dev.off()

```


# 4. Lambda Plots

```{r}

```



