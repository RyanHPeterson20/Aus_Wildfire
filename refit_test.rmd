---
title: "refit_test"
author: "Ryan Peterson"
date: "2025-04-17"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r library}
#libraries
suppressMessages( library(hierNet)) 
suppressMessages(library(glmnet)) 
suppressMessages( library( lubridate))
suppressMessages(library(grid))

suppressMessages( library(scales)) #for adjusting opacity
```

```{r dat_functions}
# data and functions
setwd("~/CO_AUS/Aus_CO-main/Interactions")

load( "Data/ne_data.rda")
load( "Data/se_data.rda")
load( "Data/bounded_data.rda")
load( "Data/data_matrix.rda")
load( "Data/lag_list.rda")
load( "Data/data_quantile.rda")

#functions:
source("group_functions.R") #grouping/clustering
source("refit_functions.R") #coef/refit functions

```

File for exploring the different model fits and how they compare wrt 2019/2020 wildfire season.

(Add more notes here as we progress)

## Model Fits

1. Previous strong hierNet with indicator functions in main effects.
2. Strong hierNet without indicator functions (main/primary fit)
3. Strong hierNet without indicator function and 2019/2020 wildfire season.
4. Strong hierNet for main conditions but only 2 groups per region.

5. Elastic net fit from model 2 (main fit) with alpha (delta) at 0.10
6. Elastic net fit from model 2 (main fit) with alpha (delta) at 0.25


```{r model_fits}
setwd("~/CO_AUS/Aus_CO-main/Interactions")

#lasso fits
load( "full_strong.rda") #include indicator functions
output_ind <- output

load( "main_strong.rda") #full strong models #output models
output_main <- output

load( "base_strong.rda") #strong models without 2019/2020
output_base <- output

load( "group_strong.rda") #2 group strong models (only 2 groups per region)
output_group <- output

#elastic net fits
load("enet_strong.rda") #elastic net model with alpha = 0.10
output_enet <- output

load("enet25_strong.rda") #elastic net model with alpha = 0.25
output_enet25 <- output

rm(output)
```


```{r}
#season years/weeks
season_weeks <- c(35:52, 1:14)
season_years <- unique(bounded_resp_df$year)

seasons <- c()
for (i in 1:(length(season_years)-1)) {
  temp_season <- paste0(season_years[i], "-", season_years[i+1])
  #print(temp_season)  
  seasons <- c(seasons, temp_season)
}
rm(i, temp_season)

#center response data
NEbase_matrix <- scale(resp_matrix[ ,1:32], center = TRUE, scale = FALSE)
SEbase_matrix <- scale(resp_matrix[ ,33:64], center = TRUE, scale = FALSE)

#group response matrices
#NEAus
NEAus_1 <- NEbase_matrix[ ,1:12] #early season
NEAus_2 <- NEbase_matrix[ ,13:17] #primary NE fire season
NEAus_3 <- NEbase_matrix[ ,18:21] #feedback from SE
NEAus_4 <- NEbase_matrix[ ,22:32] #late season

#SEAus
SEAus_1 <- SEbase_matrix[ ,1:7] #early season
SEAus_2 <- SEbase_matrix[ ,8:16] #feedback from NE
SEAus_3 <- SEbase_matrix[ ,17:20] #primary SE fire season
SEAus_4 <- SEbase_matrix[ ,21:32] #late season

NEAus_mat <- list(NEAus_1, NEAus_2, NEAus_3, NEAus_4)
SEAus_mat <- list(SEAus_1, SEAus_2, SEAus_3, SEAus_4)

rm(NEAus_1, NEAus_2, NEAus_3, NEAus_4, SEAus_1, SEAus_2, SEAus_3, SEAus_4)
```

```{r}
#full model data set-up
NE_preds <- NElag_grouping(NE_laglist = NE_laglist_std, j = 1:19)
NE_resp <- NEresp_grouping(NEAus_mat = NEAus_mat, j = 1:19)

SE_preds <- SElag_grouping(SE_laglist = SE_laglist_std, j = 1:19)
SE_resp <- SEresp_grouping(SEAus_mat = SEAus_mat, j = 1:19)

#quantile 75 indicator (if needed)
NE_preds_q75 <- NElag_grouping(NE_laglist = NE_laglist_q75, j = 1:19)
SE_preds_q75 <- SElag_grouping(SE_laglist = SE_laglist_q75, j = 1:19)
```


# Fit Analysis

## (Older Fits)

Main effect indicator function fit


## Main/Primary Fit

Strong hierNet as `baseline' for other models 

### Model Fits including 2019/2020

```{r NEAus}
#full model data set-up
NE_preds <- NElag_grouping(NE_laglist = NE_laglist_std, j = 1:19)
NE_resp <- NEresp_grouping(NEAus_mat = NEAus_mat, j = 1:19)
NE_preds_q75 <- NElag_grouping(NE_laglist = NE_laglist_q75, j = 1:19)

NEAus1 <- output_main[[1]]

NEcoefs1 <- get_coefs(NEAus1$hierpath, max_index = 50, 
                      resp = NE_resp[[1]], preds = NE_preds[[1]], preds_quant = NE_preds_q75[[1]])

plot(NEAus1$hiercv)

NEcv1 <- NEAus1$hiercv
which(NEcv1$lamlist == NEcv1$lamhat.1se)
which(NEcv1$lamlist == NEcv1$lamhat)
NEcv1$lamhat.1se
1-NEcv1$cv.err/var( NE_resp[[1]])

#length(NEcoefs1[[3]][[1]]$Main_Effect)
#length(NEcoefs1[[3]][[2]]$Interact_Effect)

NErefit1 <- refit_bic(NEAus1$hierpath, max_index = 50, ebic.gamma = 0.25,
                      lambda.min = FALSE, AIC.c = FALSE,
                      resp = NE_resp[[1]], preds = NE_preds[[1]], 
                      preds_quant = NE_preds_q75[[1]])

NErefit1[[5]]

which.min(NErefit1[[5]][1:21, 2])
which.min(NErefit1[[5]][ , 6])

i <- 3
ridge_coef <- NErefit1[[4]][[i]][-1]
NEridge1_main <- ridge_coef
ridge_coef
length(ridge_coef)
```


```{r SEAus}
SE_preds <- SElag_grouping(SE_laglist = SE_laglist_std, j = 1:19)
SE_resp <- SEresp_grouping(SEAus_mat = SEAus_mat, j = 1:19)
SE_preds_q75 <- SElag_grouping(SE_laglist = SE_laglist_q75, j = 1:19)

#SE Aus Group 1
SEAus1 <- output_main[[5]]

SEcoefs1 <- get_coefs(SEAus1$hierpath, max_index = 50, 
                      resp = SE_resp[[1]], preds = SE_preds[[1]], preds_quant = SE_preds_q75[[1]])

plot(SEAus1$hiercv)

SEcv1 <- SEAus1$hiercv
which(SEcv1$lamlist == SEcv1$lamhat.1se)
which(SEcv1$lamlist == SEcv1$lamhat)
SEcv1$lamhat.1se
1-SEcv1$cv.err/var( SE_resp[[1]])


SErefit1 <- refit_bic(SEAus1$hierpath, max_index = 50, ebic.gamma = 0.25, lambda.min = FALSE, AIC.c = FALSE,
                      intercept = FALSE,
                      resp = SE_resp[[1]], preds = SE_preds[[1]], preds_quant = SE_preds_q75[[1]])

SErefit1[[5]]

which.min(SErefit1[[5]][,2])
which.min(SErefit1[[5]][,6])

i <- 7
#ridge_coef <- SErefit1[[4]][[i]][-1]
ridge_coef <- SErefit1[[4]][[i]]
SEridge1_main <- ridge_coef
ridge_coef
length(ridge_coef)

#glm coefs
summary(SErefit1[[1]][[i]]) #glm fit summary

SEcoefs1[[i]][[1]]$Main_Effect
SEcoefs1[[i]][[1]]$Coef

SEcoefs1[[i]][[2]]$Interact_Effect
SEcoefs1[[i]][[2]]$Coef


#SE Aus Group 2
SEAus2 <- output_main[[6]]

SEcoefs2 <- get_coefs(SEAus2$hierpath, max_index = 50, 
                      resp = SE_resp[[2]], preds = SE_preds[[2]], preds_quant = SE_preds_q75[[2]])

plot(SEAus2$hiercv)

SEcv2 <- SEAus2$hiercv
which(SEcv2$lamlist == SEcv2$lamhat.1se)
which(SEcv2$lamlist == SEcv2$lamhat)
SEcv2$lamhat.1se
1-SEcv2$cv.err/var( SE_resp[[2]])


SErefit2 <- refit_bic(SEAus2$hierpath, max_index = 50, ebic.gamma = 0.25, lambda.min = FALSE, AIC.c = FALSE,
                      intercept = FALSE,
                      resp = SE_resp[[2]], preds = SE_preds[[2]], preds_quant = SE_preds_q75[[2]])

SErefit2[[5]]

which.min(SErefit2[[5]][,2]) #AIC
which.min(SErefit2[[5]][,6]) #BIC

i <- 7
#ridge coefs
#ridge_coef <- SErefit2[[4]][[i]][-1]
ridge_coef <- SErefit2[[4]][[i]]
SEridge2_main <- ridge_coef
ridge_coef
length(ridge_coef)

#glm coefs
summary(SErefit2[[1]][[i]])

SEcoefs2[[i]][[1]]$Main_Effect
SEcoefs2[[i]][[1]]$Coef

SEcoefs2[[i]][[2]]$Interact_Effect
SEcoefs2[[i]][[2]]$Coef
```

### Model Fits excluding 2019/2020


```{r SEAus}

SE_preds <- SElag_grouping(SE_laglist = SE_laglist_std, j = -c(19))
SE_resp <- SEresp_grouping(SEAus_mat = SEAus_mat, j = -c(19))
SE_preds_q75 <- SElag_grouping(SE_laglist = SE_laglist_q75, j = -c(19))


#SE Aus Group 1
SEAus1 <- output_main[[5]]

SEcoefs1 <- get_coefs(SEAus1$hierpath, max_index = 50, 
                      resp = SE_resp[[1]], preds = SE_preds[[1]], preds_quant = SE_preds_q75[[1]])

plot(SEAus1$hiercv)

SEcv1 <- SEAus1$hiercv
which(SEcv1$lamlist == SEcv1$lamhat.1se)
which(SEcv1$lamlist == SEcv1$lamhat)
SEcv1$lamhat.1se
1-SEcv1$cv.err/var( SE_resp[[1]])


SErefit1 <- refit_bic(SEAus1$hierpath, max_index = 50, ebic.gamma = 0.25, lambda.min = FALSE, AIC.c = FALSE,
                      intercept = FALSE,
                      resp = SE_resp[[1]], preds = SE_preds[[1]], preds_quant = SE_preds_q75[[1]])

SErefit1[[5]]

which.min(SErefit1[[5]][,2])
which.min(SErefit1[[5]][,6])

i <- 7
#ridge_coef <- SErefit1[[4]][[i]][-1]
ridge_coef <- SErefit1[[4]][[i]]
SEridge1_main1 <- ridge_coef
ridge_coef
length(ridge_coef)

#glm coefs
summary(SErefit1[[1]][[i]]) #glm fit summary



#SE Aus Group 2
SEAus2 <- output_main[[6]]

SEcoefs2 <- get_coefs(SEAus2$hierpath, max_index = 50, 
                      resp = SE_resp[[2]], preds = SE_preds[[2]], preds_quant = SE_preds_q75[[2]])

plot(SEAus2$hiercv)

SEcv2 <- SEAus2$hiercv
which(SEcv2$lamlist == SEcv2$lamhat.1se)
which(SEcv2$lamlist == SEcv2$lamhat)
SEcv2$lamhat.1se
1-SEcv2$cv.err/var( SE_resp[[2]])


SErefit2 <- refit_bic(SEAus2$hierpath, max_index = 50, ebic.gamma = 0.25, lambda.min = FALSE, AIC.c = FALSE,
                      intercept = FALSE,
                      resp = SE_resp[[2]], preds = SE_preds[[2]], preds_quant = SE_preds_q75[[2]])

SErefit2[[5]]

which.min(SErefit2[[5]][,2]) #AIC
which.min(SErefit2[[5]][,6]) #BIC

i <- 7
#ridge coefs
#ridge_coef <- SErefit2[[4]][[i]][-1]
ridge_coef <- SErefit2[[4]][[i]]
SEridge2_main1 <- ridge_coef
ridge_coef
length(ridge_coef)

#glm coefs
summary(SErefit2[[1]][[i]])

```



## Baseline Wildfire (w/o 2019/2020 Season)

```{r SEAus}
SE_preds <- SElag_grouping(SE_laglist = SE_laglist_std, j = -c(19))
SE_resp <- SEresp_grouping(SEAus_mat = SEAus_mat, j = -c(19))
SE_preds_q75 <- SElag_grouping(SE_laglist = SE_laglist_q75, j = -c(19))


#SE Aus Group 1
SEAus1 <- output_base[[5]]

SEcoefs1 <- get_coefs(SEAus1$hierpath, max_index = 50, 
                      resp = SE_resp[[1]], preds = SE_preds[[1]], preds_quant = SE_preds_q75[[1]])

plot(SEAus1$hiercv)

SEcv1 <- SEAus1$hiercv
which(SEcv1$lamlist == SEcv1$lamhat.1se)
which(SEcv1$lamlist == SEcv1$lamhat)
SEcv1$lamhat.1se
1-SEcv1$cv.err/var( SE_resp[[1]])


SErefit1 <- refit_bic(SEAus1$hierpath, max_index = 50, ebic.gamma = 0.25, lambda.min = FALSE, AIC.c = FALSE,
                      intercept = FALSE,
                      resp = SE_resp[[1]], preds = SE_preds[[1]], preds_quant = SE_preds_q75[[1]])

SErefit1[[5]]

which.min(SErefit1[[5]][,2])
which.min(SErefit1[[5]][,6])

i <- 7
#ridge_coef <- SErefit1[[4]][[i]][-1]
ridge_coef <- SErefit1[[4]][[i]]
SEridge1_base <- ridge_coef
ridge_coef
length(ridge_coef)

#glm coefs
summary(SErefit1[[1]][[i]]) #glm fit summary



#SE Aus Group 2
SEAus2 <- output_base[[6]]

SEcoefs2 <- get_coefs(SEAus2$hierpath, max_index = 50, 
                      resp = SE_resp[[2]], preds = SE_preds[[2]], preds_quant = SE_preds_q75[[2]])

plot(SEAus2$hiercv)

SEcv2 <- SEAus2$hiercv
which(SEcv2$lamlist == SEcv2$lamhat.1se)
which(SEcv2$lamlist == SEcv2$lamhat)
SEcv2$lamhat.1se
1-SEcv2$cv.err/var( SE_resp[[2]])


SErefit2 <- refit_bic(SEAus2$hierpath, max_index = 50, ebic.gamma = 0.25, lambda.min = FALSE, AIC.c = FALSE,
                      intercept = FALSE,
                      resp = SE_resp[[2]], preds = SE_preds[[2]], preds_quant = SE_preds_q75[[2]])

SErefit2[[5]]

which.min(SErefit2[[5]][,2]) #AIC
which.min(SErefit2[[5]][,6]) #BIC

i <- 8
#ridge coefs
#ridge_coef <- SErefit2[[4]][[i]][-1]
ridge_coef <- SErefit2[[4]][[i]]
SEridge2_base <- ridge_coef
ridge_coef
length(ridge_coef)

#glm coefs
summary(SErefit2[[1]][[i]])

```


## Reduced Groups

Looking at only 2 groups per region:
(Add info on new groups.)

```{r new_setup}
#full model data set-up
NE_preds <- NElag_grouping(NE_laglist = NE_laglist_std, j = 1:19)
NE_resp <- NEresp_grouping(NEAus_mat = NEAus_mat, j = 1:19)
NE_preds_q75 <- NElag_grouping(NE_laglist = NE_laglist_q75, j = 1:19)

##predictors
NE_group1 <- NE_preds[[1]]
NE_group2 <- rbind(NE_preds[[2]], NE_preds[[3]], NE_preds[[4]])
NE_preds1 <- list(NE_group1, NE_group2)

SE_group1 <- rbind(SE_preds[[1]], SE_preds[[2]])
SE_group2 <- rbind(SE_preds[[3]], SE_preds[[4]])
SE_preds1 <- list(SE_group1, SE_group2)

##response
NEresp1 <- NE_resp[[1]]
NEresp2 <- c(NE_resp[[2]], NE_resp[[3]], NE_resp[[4]])
NE_resp1 <- list(NEresp1, NEresp2)

SEresp1 <- c(SE_resp[[1]], SE_resp[[2]])
SEresp2 <- c(SE_resp[[3]], SE_resp[[4]])
SE_resp1 <- list(SEresp1, SEresp2)

##indicator preds (q75)

NEq75_pred1 <- NE_preds_q75[[1]]
NEq75_pred2 <- rbind(NE_preds_q75[[2]], NE_preds_q75[[3]], NE_preds_q75[[4]])
NE_preds1_q75 <- list(NEq75_pred1, NEq75_pred2)

SEq75_pred1 <- rbind(SE_preds_q75[[1]], SE_preds_q75[[2]])
SEq75_pred2 <- rbind(SE_preds_q75[[3]], SE_preds_q75[[4]])
SE_preds1_q75 <- list(SEq75_pred1, SEq75_pred2)
```


```{r NEAus}

```


```{r SEAus}
#SE Aus Group 1 
SEAus1 <- output_group[[3]]

SEcoefs1 <- get_coefs(SEAus1$hierpath, max_index = 50, 
                      resp = SE_resp1[[1]], preds = SE_preds1[[1]], preds_quant = SE_preds1_q75[[1]])

plot(SEAus1$hiercv)

SEcv1 <- SEAus1$hiercv
which(SEcv1$lamlist == SEcv1$lamhat.1se)
which(SEcv1$lamlist == SEcv1$lamhat)
SEcv1$lamhat.1se
1-SEcv1$cv.err/var( SE_resp[[1]])


SErefit1 <- refit_bic(SEAus1$hierpath, max_index = 50, ebic.gamma = 0.25, lambda.min = FALSE, AIC.c = FALSE,
                      intercept = FALSE,
                      resp = SE_resp1[[1]], preds = SE_preds1[[1]], preds_quant = SE_preds1_q75[[1]])

SErefit1[[5]]

which.min(SErefit1[[5]][,2])
which.min(SErefit1[[5]][,6])

i <- 7
#ridge_coef <- SErefit1[[4]][[i]][-1]
ridge_coef <- SErefit1[[4]][[i]]
SEridge1_main <- ridge_coef
ridge_coef
length(ridge_coef)

#SE Aug Group 2



```


## Elastic Nets

### Alpha 0.10

```{r NEAus}
NE_preds <- NElag_grouping(NE_laglist = NE_laglist_std, j = 1:19)
NE_resp <- NEresp_grouping(NEAus_mat = NEAus_mat, j = 1:19)
NE_preds_q75 <- NElag_grouping(NE_laglist = NE_laglist_q75, j = 1:19)

NEAus1 <- output_enet[[1]]

NEcoefs1 <- get_coefs(NEAus1$hierpath, max_index = 50, 
                      resp = NE_resp[[1]], preds = NE_preds[[1]], 
                      preds_quant = NE_preds_q75[[1]])

plot(NEAus1$hiercv)

NEcv1 <- NEAus1$hiercv
which(NEcv1$lamlist == NEcv1$lamhat.1se)
which(NEcv1$lamlist == NEcv1$lamhat)

NErefit1 <- refit_bic(NEAus1$hierpath, max_index = 50, ebic.gamma = 0.25,
                      lambda.min = FALSE, AIC.c = FALSE,
                      resp = NE_resp[[1]], preds = NE_preds[[1]], 
                      preds_quant = NE_preds_q75[[1]])

#NErefit1[[5]]

which.min(NErefit1[[5]][ , 2])
which.min(NErefit1[[5]][ , 6])

i <- 1
ridge_coef <- NErefit1[[4]][[i]][-1]
NEridge1_ent <- ridge_coef
ridge_coef
length(ridge_coef)

NEcoefs1[[i]][[1]]$Main_Effect
NEcoefs1[[i]][[1]]$Coef
```

### Alpha 0.25

```{r NEAus}
NE_preds <- NElag_grouping(NE_laglist = NE_laglist_std, j = 1:19)
NE_resp <- NEresp_grouping(NEAus_mat = NEAus_mat, j = 1:19)
NE_preds_q75 <- NElag_grouping(NE_laglist = NE_laglist_q75, j = 1:19)

NEAus1 <- output_enet25[[1]]

NEcoefs1 <- get_coefs(NEAus1$hierpath, max_index = 50, 
                      resp = NE_resp[[1]], preds = NE_preds[[1]], 
                      preds_quant = NE_preds_q75[[1]])

plot(NEAus1$hiercv)

NEcv1 <- NEAus1$hiercv
which(NEcv1$lamlist == NEcv1$lamhat.1se)
which(NEcv1$lamlist == NEcv1$lamhat)

NErefit1 <- refit_bic(NEAus1$hierpath, max_index = 50, ebic.gamma = 0.25,
                      lambda.min = FALSE, AIC.c = FALSE,
                      resp = NE_resp[[1]], preds = NE_preds[[1]], 
                      preds_quant = NE_preds_q75[[1]])

#NErefit1[[5]]

which.min(NErefit1[[5]][ , 2])
which.min(NErefit1[[5]][ , 6])

i <- 1
ridge_coef <- NErefit1[[4]][[i]][-1]
NEridge1_ent25 <- ridge_coef
ridge_coef
length(ridge_coef)

NEcoefs1[[i]][[1]]$Main_Effect
NEcoefs1[[i]][[1]]$Coef

NEcoefs1[[i]][[2]]$Interact_Effect
NEcoefs1[[i]][[2]]$Coef
```


# Coefficient Visualizations

## Comparisons (by Region/Group)

```{r SEAus_group2}
setwd("~/CO_AUS/Aus_CO-main/Interactions/Figures")

png(filename = "SE2_coeff.png", width = 3000, height = 3000, res = 300)
# Set layout
layout(matrix(c(1, 6,
                2, 6,
                3, 6,
                4, 6,
                5, 6), ncol = 2, byrow = TRUE),
       widths = c(1.5, 1), heights = c(1, 1, 1, 1, 1))

par(oma = c(1, 1, 3, 9))

# Store info for linking
links <- list()

# --- Data Set-up --- 
## Nino
SE2_ninolag <- c(11,17)
SE2_ninocoef <- SEridge2_main[1:2]
SE21_ninolag <- c(11,17)
SE21_ninocoef <- SEridge2_main1[1:2]
SE22_ninolag <- c(11:13,17)
SE22_ninocoef <- SEridge2_base[1:4]
##DMI
SE2_dmilag <- c(6)
SE2_dmicoef <- SEridge2_main[3]
SE21_dmilag <- c(6)
SE21_dmicoef <- SEridge2_main1[3]
SE22_dmilag <- c(5)
SE22_dmicoef <- SEridge2_base[5]
##TSA
SE22_tsalag <- c(8,16,19)
SE22_tsacoef <- SEridge2_base[6:8]
##AAO
SE2_aaolag <- c(24)
SE2_aaocoef <- SEridge2_main[4]
SE21_aaolag <- c(24)
SE21_aaocoef <- SEridge2_main1[4]
SE22_aaolag <- c(24)
SE22_aaocoef <- SEridge2_base[9]

# --- Range ---
SEAus2_range <- range(SE2_ninocoef, SE21_ninocoef, SE22_ninocoef, 
                      SE2_dmicoef, SE21_dmicoef, SE22_dmicoef,
                      SE22_tsacoef,
                      SE2_aaocoef, SE21_aaocoef, SE22_aaocoef)

# --- Plot 1: Nino ---
par(mar = c(4, 4, 2, 1))

plot(SE2_ninolag, SE2_ninocoef, pch = 22, 
     col = "grey4", bg =  alpha("green4",.95), cex = 1.5,
     xlim = c(1,52), 
     ylim = SEAus2_range,
     xlab = "", ylab = "Coefficients")
points(SE21_ninolag, SE21_ninocoef, pch = 22, col = "black",
       bg =  alpha("chartreuse3",.65) , cex = 1.5)
points(SE22_ninolag, SE22_ninocoef, pch = 24, col = "black",
       bg =  alpha("chartreuse3",.95), cex = 1.4)
abline(h = 0, lty = 2)
title("Nino", adj = 0)

# --- Plot 2: DMI ---
par(mar = c(4, 4, 2, 1))
plot(SE2_dmilag, SE2_dmicoef, pch = 22,
     col = "grey4",
     bg =  alpha("magenta4",.95), cex = 1.5,
     xlim = c(1,52), 
     ylim = SEAus2_range,
     xlab = "", ylab = "Coefficients")
points(SE21_dmilag, SE21_dmicoef, pch = 22, col = "black",
       bg =  alpha("darkorchid2",.65) , cex = 1.5)
points(SE22_dmilag, SE22_dmicoef, pch = 24, col = "black",
       bg =  alpha("darkorchid2",.95), cex = 1.4)
abline(h = 0, lty = 2)
title("DMI", adj = 0)

# --- Plot 3: TSA ---
par(mar = c(4, 4, 2, 1))
plot(SE22_tsalag, SE22_tsacoef, pch = 24, col = "black",
       bg =  alpha("darkgoldenrod4", 0.95), xlim = c(1,52), cex = 1.4,
     ylim = SEAus2_range,
     xlab = "", ylab = "Coefficients")
abline(h = 0, lty = 2)
title("TSA", adj = 0)

# --- Plot 4: SAM/AAO ---
par(mar = c(4, 4, 2, 1))
plot(SE2_aaolag, SE2_aaocoef, pch = 22,
     col = "grey4",
     bg =  alpha("red3",.95), cex = 1.5,
     xlim = c(1,52), 
     ylim = SEAus2_range,
     xlab = "", ylab = "Coefficients")
points(SE21_aaolag, SE21_aaocoef, pch = 22, col = "black",
       bg =  alpha("coral2",.65) , cex = 1.5)
points(SE22_aaolag, SE22_aaocoef, pch = 24, col = "black",
       bg =  alpha("coral2",.95), cex = 1.4)
abline(h = 0, lty = 2)
title("SAM (AAO)", adj = 0)

# --- Plot 5: OLR ---
par(mar = c(4, 4, 2, 1))
plot(SE2_aaolag, SE2_aaocoef, type = "n", xlim = c(1,52), 
     ylim = SEAus2_range,
     xlab = "Lag", ylab = "Coefficients")
abline(h = 0, lty = 2)
title("OLR", adj = 0)

# --- Plot 6: Interaction Effects ---
#TODO: get the line method working 
par(mar = c(4, 4, 2, 2))
y_range <- c(0,1)
nino_loc <- c(0.98)
int_range <- range(SEridge2_main[5:6])

plot(SEridge2_main[5], nino_loc, pch = 22, 
     col = "grey4", bg =  alpha("green4",.95), cex = 1.5, main = "Interactions", 
     ylim = y_range, xlim = int_range,
     xlab = "Coefficients",
     yaxt = "n",  ylab = "")
#for correct points set-up empty plot then assign points after (maybe? test this out)


#outer text and legends
par(xpd = NA)
legend("topright", inset = c(-0.52, 0.00),
       title = "Nino",
       legend = c("Coef w/ 2019/2020", "Coef w/o 2019/2020", "Variable w/o 2019/2020"),
       pch = c(22, 22, 24),
       col = c("grey4", "black", "grey4"),
       pt.bg = c("green4", "chartreuse3", "chartreuse3"),
       pt.cex = c(1.5, 1.5, 1.4))

mtext("SE Aus Group 2 ()", outer = TRUE, cex = 1.5, font = 1)

dev.off()
```

